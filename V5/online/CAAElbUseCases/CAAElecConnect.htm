<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<script type="text/javascript" src="../CAADocJavaScript/submit.js">
</script>
<title>Connecting Electrical Devices with Connect API</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>Equipment &amp; Systems Engineering</h1>
    </td>
    <td valign="top">
      <h2>Electrical Library</h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>Connecting Electrical Devices with Connect API</h3>
      <em>How to connect Electrical Devices with Connect API</em></td>
  </tr>
  <tr>
    <td class="use" colspan="2">Use Case</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p>This article discusses the <i>CAAElecConnect </i> use case. This use
      case explains how to connect Electrical Devices with Connect API.
      <ul>
        <li><strong><a href="#Learn">What You Will Learn With This Use Case</a></strong></li>
        <li><a href="#UseCase"><strong>The CAAElecConnect Use Case</strong></a>
          <ul>
            <li><a href="#What">What Does CAAElecConnect Do</a></li>
            <li><a href="#How">How to Launch CAAElecConnect </a></li>
            <li><a href="#Where">Where to Find the 
            CAAElecConnect  Code</a></li>
          </ul>
        </li>
        <li><strong><a href="#Step">Step-by-Step</a></strong></li>
        <li><strong><a href="#InShort">In Short</a></strong></li>
        <li><strong><a href="#History">History</a></strong></li>
      </ul>
    </td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
<p>This use case is intended to help you make your first steps in programming with CATIA ELB Interfaces.
This usecase explains how to connect Electrical Devices with Connect API
 </p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="UseCase"></a>The CAAElecConnect Use Case</h3>
<p>CAAElecConnect is a use case of the CAAElecDeviceItf.edu framework that illustrates the CATIA ELB Interfaces framework capabilities. .</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="What"></a>What Does CAAElecConnect  Do</h4>
<p> The goal of CAAElecConnect use case is to see how to Connect Electrical Devices with Connect API</p>
<table width="614">
  <tr>
    <td width="609">
    <img border="0" src="images/CAAElecConnect_top.jpg" width="1000" height="800"></td>
  </tr>
</table>
<p>Above is a CATIA V5 image of the data used in this sample.
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="How"></a>How to Launch CAAElecConnect </h4>
<p>To launch CAAElecConnect , you will need to set up the build time
environment, then compile CAAElecConnect.cpp along with its
prerequisites, set up the run time environment, and then execute the sample.
This is fully described in the referenced article [<a href="#References">1</a>].</p>
<p>To launch the use case, execute the following command:</p>
<pre>mkrun -c &quot;CAAElecConnect  Input.CATProduct Output.CATProduct &quot;</pre>
<ul>
  <li><b>Input.CATProduct</b> - the path where the file is stored and
    the name of the CATProduct document to be opened.<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border-width: 0" bordercolor="#111111" width="100%" id="AutoNumber1">
    <tr>
      <td width="5%" style="border-style: none; border-width: medium">Unix</td>
      <td width="95%" style="border-style: none; border-width: medium"><code>InstallRootDirectory/CAAElecDeviceItf.edu/CNext/resources/graphic/CAAElecConnect/Top.CATProduct</code></td>
    </tr>
    <tr>
      <td width="5%" style="border-style: none; border-width: medium">Windows</td>
      <td width="95%" style="border-style: none; border-width: medium"><code>InstallRootDirectory\CAAElecDeviceItf.edu\CNext\resources\graphic\CAAElecConnect\Top.CATProduct</code></td>
    </tr>
  </table>
<b>Output.CATProduct</b>-the path where you want to save the output
  <p>This sample deals with the following classes:</p>
<table>
	<tr>
		<td><i>IUnknown</i></td>
		<td>Base Class for the References and Instances</td>
	</tr>
	<tr>
		<td><i>CATSessionServices</i></td>
		<td>Class for managing the session</td>
	</tr>
	<tr>
		<td><i>CATDocument</i></td>
		<td>Class for the document base class</td>
	</tr>
	<tr>
		<td><i>CATDocumentServices</i></td>
		<td>Class for managing document in the session</td>
	</tr>
	<tr>
		<td><i>CATIDocRoots</i></td>
		<td>Class for browsing root object in document</td>
	</tr>
	<tr>
		<td><i>CATIEleDocServices</i></td>
		<td>Interface dedicated electrical environment initialization</td>
	</tr>
	<tr>
		<td><i>CATIElecAttrAccess</i></td>
		<td>Interface dedicated to manage electrical attribute</td>
	</tr>
	<tr>
		<td><i>CATIElbEquipment</i></td>
		<td>Interface for defining electrical equipment behavior</td>
	</tr>
	<tr>
		<td><i>CATIElbSingleConnector</i></td>
		<td>Interface for defining single connector behavior</td>
	</tr>
	<tr>
		<td><i>CATIElbBackShell</i></td>
		<td>Interface to manage Back Shells.</td>
	</tr>
	<tr>
		<td><i>CATIElbMountingEquipment</i></td>
		<td>Interface to manage Mounting Equipments.</td>
	</tr>
	<tr>
		<td><i>CATIElbCavity</i></td>
		<td>Interface to manage Cavities.</td>
	</tr>
	<tr>
		<td><i>CATIElbConnectorShell</i></td>
		<td>Interface to manage Connector Shell.</td>
	</tr>
	<tr>
		<td><i>CATIElbDeviceInstance</i></td>
		<td>interface  to the devices instance management.</td>
	</tr>
</table>

  </li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Where"></a>Where to Find the <i>CAAElecConnect </i> Code</h4>
<p>CAAElecConnect  code is located in the 
CAAElecConnect.m use case
module of the CAAElecDeviceItf.edu framework:</p>
<table>
  <tr>
    <td>Unix</td>
    <td><code>InstallRootDirectory/CAAElecDeviceItf.edu/CAAElecConnect.m/src/CAAElecConnect.cpp</code></td>
  </tr>
  <tr>
    <td>Windows</td>
    <td><code>InstallRootDirectory\CAAElecDeviceItf.edu\CAAElecConnect.m\src\CAAElecConnect.cpp</code></td>
  </tr>
</table>
<p>where <code>InstallRootDirectory</code> is the root directory of your CAA V5
installation. It is made of a unique source file named <b>
CAAElecConnect .cpp</b>.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="Step"></a>Step-by-Step</h3>
<p>We will now first comment the Electrical environment and it&#8217;s components creation 
by looking at the code of the CAAElecconnect. There are 22 logical steps in CAAElecConnect:</p>
<table width="100%">
	<tr>
		<td><b>#</b></td>
		<td><b>Step</b></td>
	</tr>
	<tr>

		<td valign="top"><a href="#Step1">1</a></td>
		<td valign="top">Creating the session and opening an existing CATProduct</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step2">2</a></td>
		<td valign="top">Retrieving the root product of the CATProduct document</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step3">3</a></td>
		<td valign="top">Initializing Electrical Environment</td>
	</tr>
	
	<tr>
		<td valign="top"><a href="#Step4">4</a></td>
		<td valign="top">Retrieving Single Insert Connector under the Root Product</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step5">5</a></td>
		<td valign="top">Retrieving  Back Shell under the Root Product </td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step6">6</a></td>
		<td valign="top">Retrieving Shell under the Root Product </td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step7">7</a></td>
		<td valign="top">Retrieving Mounting Equipment under the Root Product </td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step8">8</a></td>
		<td valign="top">Connect MountingEquipment1 to MountingEquipment2</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step9">9</a></td>
		<td valign="top">Test GetConnectedDevice on CATIElbDeviceInstance</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step10">10</a></td>
		<td valign="top">Connect Single Insert Connector to Mounting Equipment</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step11">11</a></td>
		<td valign="top">Disconnect Single Insert Connector from Mounting Equipment</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step12">12</a></td>
		<td valign="top">Connect Mounting Equipment to Shell</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step13">13</a></td>
		<td valign="top">Disconnect Shell from Mounting Equipment</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step14">14</a></td>
		<td valign="top">Connect Equipment to Mounting Equipment</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step15">15</a></td>
		<td valign="top">Connect Single Insert Connector to Equipment</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step16">16</a></td>
		<td valign="top">Disconnect Single Insert Connector from Equipment</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step17">17</a></td>
		<td valign="top">Connect Shell 1 to Equipment</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step18">18</a></td>
		<td valign="top">Connect Shell 1 to Shell 2</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step19">19</a></td>
		<td valign="top">Connect Backshell to Shell </td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step20">20</a></td>
		<td valign="top">Disconnect Backshell from Shell </td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step21">21</a></td>
		<td valign="top">Connect Single Insert Connector to Shell2 </td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step22">22</a></td>
		<td valign="top">Epilog</td>
	</tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step1"></a>Creating the session and opening an existing CATProduct</h4>
<p>We need a <i>CATSession</i> pointer to create the Session.</p>
<table class="code">
  <tr>
    <td>
      <pre>
	  CATSession *pSession = NULL;
	  char *sessionName = &quot;CAA_ElbConnectDevice_Session&quot;;
      HRESULT rc = ::Create_Session(sessionName,pSession);
...</pre>
</td>
</tr>
</table>
<p>We need a CATDocument pointer to opening the document.</p>

<table class="code">
	<tr>
		<td>
		<pre>...
CATDocument *pDoc = NULL;
rc = CATDocumentServices::OpenDocument(argv[1], pDoc);
...</pre>
		</td>
	</tr>
</table>
...</pre>
      <pre>...</pre>
 <p>Once the current session has been created, the CATProduct document can be loaded 
into the session. pDoc is a pointer to this document.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step2"></a>Retrieving the root product of the CATProduct document</h4>
<p>We need a <i>CATProduct</i> pointer to retrieve the root product.</p>
<table class="code">
	<tr>
		<td>
		<pre>....
  CATIProduct* piRootProduct = NULL;  
  CATIDocRoots * pDocRoots = NULL;
  rc = pDoc-&gt;QueryInterface(IID_CATIDocRoots,(void**) &amp;pDocRoots);
  ...
  CATListValCATBaseUnknown_var* pListRootProduct = pDocRoots-&gt;GiveDocRoots();
  ...
  
  if ( pListRootProduct &amp;&amp; pListRootProduct-&gt;Size() )
  {  
    rc = (*pListRootProduct)[1]-&gt;QueryInterface(IID_CATIProduct,(void**) &amp;piRootProduct );
  }
...</pre>
		</td>
	</tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step3"></a>Initializing Electrical Environment</h4>
<p>We initialize the Document by using CATIEleDocServices interface pointer and 
the method Initialize() on it.</p>
<table class="code">
	<tr>
		<td>
		<pre>....
  CATIEleDocServices * piElecDocServices = NULL;  
  rc = pDoc-&gt;QueryInterface(IID_CATIEleDocServices,(void**) &amp;piElecDocServices );
  if ( SUCCEEDED(rc) &amp;&amp; piElecDocServices )
  {
    rc = piElecDocServices-&gt;Initialize();
  }
...</pre>
		</td>
	</tr>
</table>
<p>Initializing the electrical environment is mandatory to enable access to electrical 
object or electrical attributes.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step4"></a>Retrieving Single Insert Connector under the Root Product</h4>
<p>Retrieve Single Insert Connector</p>
<table class="code">
  <tr>
    <td>
      <pre>...
	  CATListValCATBaseUnknown_var* pListElbSingleConnector = NULL;
	  CATIElbSingleConnector * pSingleConnector = NULL;
  pListElbSingleConnector = piRootProduct-&gt;GetAllChildren(CATIElbSingleConnector::ClassName());
  
  int NumberOfSingleConnector = pListElbSingleConnector?pListElbSingleConnector-&gt;Size():0;
  ...
  CATBaseUnknown_var spCBU = NULL_var;
  spCBU = ((*pListElbSingleConnector)[1]);
  if (NULL_var != spCBU)
    RC = spCBU-&gt;QueryInterface(IID_CATIElbSingleConnector,(void**) &amp;pSingleConnector);

   ...</pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
  <h4><a name="Step5"></a>Retrieving  Back Shell under the Root Product</h4>
<p>Retrieve back Shell</p>
<table class="code">
  <tr>
    <td>
      <pre>...
	  CATListValCATBaseUnknown_var* pListElbBackShell = NULL;
  pListElbBackShell = piRootProduct-&gt;GetAllChildren(CATIElbBackShell::ClassName());
  
  int NumberOfBS = pListElbBackShell?pListElbBackShell-&gt;Size():0;
  ...
  spCBU = ((*pListElbBackShell)[1]);
  CATIElbBackShell * pBackShell = NULL;
  if (NULL_var != spCBU)
    RC = spCBU-&gt;QueryInterface(IID_CATIElbBackShell,(void**) &amp;pBackShell);
	 ...</pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
  <h4><a name="Step6"></a>Retrieving Shell under the Root Product</h4>
<p>Retrieve Shell</p>
<table class="code">
  <tr>
    <td>
      <pre>...
	  CATListValCATBaseUnknown_var* pListShell = NULL;
  pListShell = piRootProduct-&gt;GetAllChildren(CATIElbConnectorShell::ClassName());
  
  int NumberOfShells = pListShell?pListShell-&gt;Size():0;
   
  spCBU = ((*pListShell)[1]);
   CATIElbConnectorShell * pShell1 = NULL;
   CATIElbConnectorShell * pShell2 = NULL;
  if (NULL_var != spCBU)
    RC = spCBU-&gt;QueryInterface(IID_CATIElbConnectorShell,(void**) &amp;pShell1);

  spCBU = ((*pListShell)[2]);
  if (NULL_var != spCBU)
    RC = spCBU-&gt;QueryInterface(IID_CATIElbConnectorShell,(void**) &amp;pShell2);
   ...</pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
  <h4><a name="Step7"></a>Retrieving Mounting Equipment under the Root Product</h4>
<p>Retrieve Mounting Equipment </p>
<table class="code">
  <tr>
    <td>
      <pre>...
	  CATListValCATBaseUnknown_var* pListMountingEquip = NULL;
  pListMountingEquip = piRootProduct-&gt;GetAllChildren(CATIElbMountingEquipment::ClassName());
  ...

  spCBU = ((*pListMountingEquip)[1]);
  CATIElbMountingEquipment * pME1 = NULL;
  CATIElbMountingEquipment * pME2 = NULL;
  if (NULL_var != spCBU)
    RC = spCBU-&gt;QueryInterface(IID_CATIElbMountingEquipment,(void**) &amp;pME1);

  spCBU = ((*pListMountingEquip)[2]);
  if (NULL_var != spCBU)
    RC = spCBU-&gt;QueryInterface(IID_CATIElbMountingEquipment,(void**) &amp;pME2);
	 
	 CATListValCATBaseUnknown_var* pListEquipments = NULL;
	 CATIElbEquipment * pEquipment = NULL;
  pListEquipments = piRootProduct-&gt;GetAllChildren(CATIElbEquipment::ClassName());
  
  int NumberOfEquipments = pListEquipments?pListEquipments-&gt;Size():0;
...
  
  spCBU = ((*pListEquipments)[1]);
  if (NULL_var != spCBU)
    RC = spCBU-&gt;QueryInterface(IID_CATIElbEquipment,(void**) &amp;pEquipment);

  ...</pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step8"></a>Connect MountingEquipment1 to MountingEquipment2</h4>
<p>Connect MountingEquipment1 to MountingEquipment2</p>
<table class="code">
  <tr>
    <td>
      <pre>...
	  CATIElbCavity * pCavity = NULL;
	  CATListValCATBaseUnknown_var* pCavities = NULL; 
  RC = pME1-&gt;ListCavities(pCavities);

  if((NULL != pCavities) && (pCavities-&gt;Size()==1))
  {
    CATBaseUnknown_var hCavity((*pCavities)[1]);
	CATBaseUnknown * pCnctPt = NULL;
    if(NULL_var != hCavity)
    {
      RC = hCavity-&gt;QueryInterface(IID_CATIElbCavity , (void**)&pCavity);

      RC = hCavity-&gt;QueryInterface(IID_CATBaseUnknown , (void**)&pCnctPt);
    }

    if ((NULL != pME1) && (NULL != pCavity) && (NULL != pME2))
    {
      RC = pME2-&gt;Connect(pCavity,pME1,StatusOfGeometricalConstraint);
    }
  }
   ...</pre>
    </td>
  </tr>
</table>
<p align="center">
<img border="0" src="images/CAAElecConnect_connect_ME1_ME2.jpg" width="300" height="400"></p>
<p align="center">
<img border="0" src="images/CAAElecConnect_2_connect_ME1_ME2.jpg" width="300" height="400"></p>
<p>The  MountingEquipment1 is connected to MountingEquipment2</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step9"></a>Test GetConnectedDevice on CATIElbDeviceInstance</h4>
<p>Test GetConnectedDevice on CATIElbDeviceInstance</p>
<table class="code">
  <tr>
    <td>
      <pre>...
	CATListValCATBaseUnknown_var * CavityCnctPts = NULL;
	CATIElbDeviceInstance * pDevInst1 = NULL;
    CATIElbDeviceInstance * pDevInst2 = NULL; 
	CATIProduct_var hPrd1;
    CATIProduct_var hPrd2;
	CATBaseUnknown * pOCnctPt = NULL;
	CATIProduct_var hRootInstPrd1;
    CATIProduct_var hRootInstPrd2;
	CATIElbDeviceInstance * pdevinst = NULL;
	CATBaseUnknown * pdevice = NULL;
  RC = pME2-&gt;ListCavityCnctPts(CavityCnctPts);

  RC = pME1-&gt;QueryInterface(IID_CATIElbDeviceInstance, (void **)&pdevinst);

  if((NULL != pdevinst) && (NULL != pCnctPt))
    RC = pdevinst-&gt;GetConnectedDevice(pCnctPt,pdevice,pOCnctPt);

  hPrd1 = pdevice;
  hPrd2 = pME2;

  if( NULL != piRootProduct && NULL_var != hPrd1 && NULL_var != hPrd2)
  {
    hRootInstPrd1 = hPrd1 -&gt;FindInstance(piRootProduct);
    hRootInstPrd2 = hPrd2 -&gt;FindInstance(piRootProduct);
  }
   ...</pre>
    </td>
  </tr>
</table>
<p>Get the device connected to the current device through a given connection point.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step10"></a>Connect Single Insert Connector to Mounting Equipment</h4>
<p>Connect Single Insert Connector to Mounting Equipment</p>
<table class="code">
  <tr>
    <td>
      <pre>...
  RC = pME2-&gt;ListCavities(pCavities);

  if((NULL != pCavities) && (pCavities-&gt;Size()==1))
  {
    CATBaseUnknown_var hCavity((*pCavities)[1]);

    if(NULL != pCavity)
    {
      pCavity- &gt; Release();
      pCavity = NULL ;
    }

    if(NULL_var!=hCavity)
      RC = hCavity-&gt;QueryInterface(IID_CATIElbCavity , (void**)&amp;pCavity);

    if ((NULL != pSingleConnector) &amp;&amp; (NULL != pCavity) &amp;&amp; (NULL !=pME2))
    {
      RC = pSingleConnector-&gt;Connect(pCavity,pME2,StatusOfGeometricalConstraint);
    }
  }
   ...</pre>
    </td>
  </tr>
</table>
<p align="center">
<img border="0" src="images/CAAElecConnect_connect_SIC_ME.jpg" width="300" height="400"></p>
<p align="center">
<img border="0" src="images/CAAElecConnect_2_connect_SIC_ME.jpg" width="300" height="400"></p>
<p>The  Single Insert Connector is connected to Mounting Equipment</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step11"></a>Disconnect Single Insert Connector from Mounting Equipment</h4>
<p>Disconnect Single Insert Connector from Mounting Equipment</p>
<table class="code">
  <tr>
    <td>
      <pre>...
  RC = pSingleConnector-&gt;QueryInterface(IID_CATIElbDeviceInstance, (void **)&amp;pDevInst1);

  RC = pME2-&gt;QueryInterface(IID_CATIElbDeviceInstance, (void **)&amp;pDevInst2);

  if(SUCCEEDED(RC))
  {
    RC = pDevInst1-&gt;Disconnect(pDevInst2);

  }
   ...</pre>
    </td>
  </tr>
</table>
<p align="center">
<img border="0" src="images/CAAElecConnect_disconnectSIC_ME2.jpg" width="300" height="400"></p>
<p align="center">
<img border="0" src="images/CAAElecConnect_2_Disconnect_SIC_ME.jpg" width="300" height="400"></p>
<p>The  Single Insert Connector is disconnected from Mounting Equipment</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step12"></a>Connect Mounting Equipment to Shell</h4>
<p>Connect Mounting Equipment to Shell</p>
<table class="code">
  <tr>
    <td>
      <pre>...
  if(NULL != pCavities)
  {
    delete pCavities;
    pCavities = NULL;
  }

  RC = pME2-&gt;ListCavities(pCavities);

  if((NULL != pCavities) &amp;&amp; (pCavities-&gt;Size()==1))
  {
    CATBaseUnknown_var hCavity((*pCavities)[1]);

    if(NULL != pCavity)
    {
      pCavity -&gt; Release();
      pCavity = NULL ;
    }

    if(NULL_var!=hCavity)
      RC = hCavity-&gt;QueryInterface(IID_CATIElbCavity , (void**)&amp;pCavity);

    if ((NULL != pShell1) &amp;&amp; (NULL != pCavity) &amp;&amp; (NULL !=pME2))
    {
      RC = pShell1-&gt;Connect(pCavity,pME2,StatusOfGeometricalConstraint);
    }
  }
   ...</pre>
    </td>
  </tr>
</table>
<p align="center">
<img border="0" src="images/CAAElecConnect_connectShell_ME.jpg" width="300" height="400"></p>
<p align="center">
<img border="0" src="images/CAAElecConnect_2_connectShell_Me.jpg" width="300" height="400"></p>
<p>The  Mounting Equipment is connected to Shell</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step13"></a>Disconnect Shell from Mounting Equipment</h4>
<p>Disconnect Shell from Mounting Equipment</p>
<table class="code">
  <tr>
    <td>
      <pre>...
  RC = pShell1-&gt;QueryInterface(IID_CATIElbDeviceInstance, (void **)&amp;pDevInst1);  

  if(SUCCEEDED(RC))
  {
    RC = pDevInst1-&gt;Disconnect(pDevInst2);
... 
  }
   ...</pre>
    </td>
  </tr>
</table>
<p align="center">
<img border="0" src="images/CAAElecConnect_DisconnectShell_ME.jpg" width="300" height="400"></p>
<p align="center">
<img border="0" src="images/CAAElecConnect_2_disconnectShell_Me.jpg" width="300" height="400"></p>
<p>The  Shell is disconnected from Mounting Equipment</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step14"></a>Connect Equipment to Mounting Equipment</h4>
<p>Connect Equipment to Mounting Equipment</p>
<table class="code">
  <tr>
    <td>
      <pre>...
  RC = pME2-&gt;ListCavities(pCavities);

  if((NULL != pCavities) &amp;&amp; (pCavities-&gt;Size()==1))
  {
    CATBaseUnknown_var hCavity((*pCavities)[1]);

    if(NULL != pCavity)
    {
      pCavity -&gt; Release();
      pCavity = NULL ;
    }   

    if(NULL_var!=hCavity)
      RC = hCavity-&gt;QueryInterface(IID_CATIElbCavity , (void**)&amp;pCavity);

    if ((NULL != pEquipment) &amp;&amp; (NULL != pCavity) &amp;&amp; (NULL !=pME2))
    {
      RC = pEquipment-&gt;Connect(pCavity,pME2,StatusOfGeometricalConstraint);
    }
  }
 ...</pre>
    </td>
  </tr>
</table>
<p align="center">
<img border="0" src="images/CAAElecConnect_connect_Equip_ME.jpg" width="300" height="400"></p>
<p align="center">
<img border="0" src="images/CAAElecConnect_2_connect_equip_ME.jpg" width="300" height="400"></p>
<p>The  Equipment is connected to Mounting Equipment</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step15"></a>Connect Single Insert Connector to Equipment</h4>
<p>Connect Single Insert Connector to Equipment</p>
<table class="code">
  <tr>
    <td>
      <pre>...
 
  CATIElbEquipment * pEquipment = NULL;
  RC = pEquipment-&gt;ListCavities(pCavities);

  if((NULL != pCavities) &amp;&amp; (pCavities-&gt;Size()==1))
  {
    CATBaseUnknown_var hCavity((*pCavities)[1]);

    if(NULL != pCavity)
    {
      pCavity -&gt; Release();
      pCavity = NULL ;
    }

    if(NULL_var!=hCavity)
      RC = hCavity-&gt;QueryInterface(IID_CATIElbCavity , (void**)&amp;pCavity);

    if ((NULL != pEquipment) &amp;&amp; (NULL != pCavity) &amp;&amp; (NULL !=pME2))
    {
      RC = pSingleConnector-&gt;Connect(pCavity,pEquipment,StatusOfGeometricalConstraint);
    }
  }
   ...</pre>
    </td>
  </tr>
</table>
<p align="center">
<img border="0" src="images/CAAElecConnect_Connect_sic_equip.jpg" width="300" height="400"></p>
<p align="center">
<img border="0" src="images/CAAElecConnect_2_connect_SIC_equip.jpg" width="300" height="400"></p>
<p>The  Single Insert Connector is connected to  Equipment</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step16"></a>Disconnect Single Insert Connector from Equipment</h4>
<p>Disconnect Single Insert Connector from Equipment</p>
<table class="code">
  <tr>
    <td>
      <pre>...
  RC = pSingleConnector-&gt;QueryInterface(IID_CATIElbDeviceInstance, (void **)&amp;pDevInst1);  

  RC = pEquipment-&gt;QueryInterface(IID_CATIElbDeviceInstance, (void **)&amp;pDevInst2);

  if(SUCCEEDED(RC))
  {
    RC = pDevInst1-&gt;Disconnect(pDevInst2);

    
  }
   ...</pre>
    </td>
  </tr>
</table>
<p align="center">
<img border="0" src="images/CAAElecConnect_Disconnect_sic_me.jpg" width="300" height="400"></p>
<p align="center">
<img border="0" src="images/CAAElecConnect_2_disconnectSIC_ME.jpg" width="300" height="400"></p>
<p>The  Single Insert Connector is disconnected from  Equipment</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step17"></a>Connect Shell 1 to Equipment</h4>
<p>Connect Shell 1 to Equipment</p>
<table class="code">
  <tr>
    <td>
      <pre>...
  RC = pEquipment-&gt;ListCavities(pCavities);

  if((NULL != pCavities) &amp;&amp; (pCavities-&gt;Size()==1))
  {
    CATBaseUnknown_var hCavity((*pCavities)[1]);

    if(NULL != pCavity)
    {
      pCavity -&gt; Release();
      pCavity = NULL ;
    }

    if(NULL_var!=hCavity)
      RC = hCavity-&gt;QueryInterface(IID_CATIElbCavity , (void**)&amp;pCavity);

    if ((NULL != pShell1) &amp;&amp; (NULL != pCavity) &amp;&amp; (NULL !=pME2))
    {
      RC = pShell1-&gt;Connect(pCavity,pEquipment,StatusOfGeometricalConstraint);
    }
  }
   ...</pre>
    </td>
  </tr>
</table>
<p align="center">
<img border="0" src="images/CAAElecConnect_connect_shell_Equip.jpg" width="300" height="400"></p>
<p align="center">
<img border="0" src="images/CAAElecConnect_2_Connect_shell_equip.jpg" width="300" height="400"></p>
<p>The  Shell1 is connected to  Equipment</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step18"></a>Connect Shell 1 to Shell 2</h4>
<p>Connect Shell 1 to Shell 2</p>
<table class="code">
  <tr>
    <td>
      <pre>...
  if ((NULL != pShell1) &amp;&amp; (NULL != pShell2))
  {
    RC = pShell1-&gt;Connect(pShell2,StatusOfGeometricalConstraint);
  }
   ...</pre>
    </td>
  </tr>
</table>
<p align="center">
<img border="0" src="images/CAAElecConnect_connect_shell_shell2.jpg" width="300" height="400"></p>
<p align="center">
<img border="0" src="images/CAAElecConnect_2_connect_shell_shell2.jpg" width="300" height="400"></p>
<p>The  Shell1 is connected to Shell2</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step19"></a>Connect Backshell to Shell</h4>
<p>Connect Backshell to Shell</p>
<table class="code">
  <tr>
    <td>
      <pre>...
  if ((NULL != pBackShell) &amp;&amp; (NULL != pShell2))
  {
    RC = pShell2-&gt;Connect(pBackShell,StatusOfGeometricalConstraint);
  }
 ...</pre>
    </td>
  </tr>
</table>
<p align="center">
<img border="0" src="images/CAAElecConnect_Connect_backShell_Shell.jpg" width="300" height="400"></p>
<p align="center">
<img border="0" src="images/CAAElecConnect_2_Connect_backShell_Shell.jpg" width="300" height="400"></p>
<p>The  Backshell is connected to Shell</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step20"></a>Disconnect Backshell from Shell</h4>
<p>Disconnect Backshell from Shell</p>
<table class="code">
  <tr>
    <td>
      <pre>...
  RC = pBackShell-&gt;QueryInterface(IID_CATIElbDeviceInstance, (void **)&amp;pDevInst1);  

  RC = pShell2-&gt;QueryInterface(IID_CATIElbDeviceInstance, (void **)&amp;pDevInst2);

  if(SUCCEEDED(RC) &amp;&amp; (NULL != pDevInst1))
  {
    RC = pDevInst1-&gt;Disconnect(pDevInst2);
...
   
  }
   ...</pre>
    </td>
  </tr>
</table>
<p align="center">
<img border="0" src="images/CAAElecConnect_DisConnect_backShell_Shell.jpg" width="300" height="400"></p>
<p align="center">
<img border="0" src="images/CAAElecConnect_2_disConnect_backShell_Shell.jpg" width="300" height="400"></p>
<p>The  Backshell is disconnected from Shell</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step21"></a>Connect Single Insert Connector to Shell2</h4>
<p>Connect Single Insert Connector to Shell2</p>
<table class="code">
  <tr>
    <td>
      <pre>...  
  RC = pShell2->ListCavities(pCavities);

  if((NULL != pCavities) &amp;&amp; (pCavities-&gt;Size()==1))
  {
    CATBaseUnknown_var hCavity((*pCavities)[1]);
    ...
    if(NULL_var!=hCavity)
      RC = hCavity-&gt;QueryInterface(IID_CATIElbCavity , (void**)&amp;pCavity);

    if ((NULL != pShell1) &amp;&amp; (NULL != pCavity) &amp;&amp; (NULL !=pME2))
    {
      RC = pSingleConnector-&gt;Connect(pCavity,pShell2,StatusOfGeometricalConstraint);
    }
  }
   ...</pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<p align="center">
<img border="0" src="images/CAAElecConnect_connect_SIC_Shell.jpg" width="300" height="400"></p>
<p align="center">
<img border="0" src="images/CAAElecConnect_2_connect_SIC_Shell.jpg" width="300" height="400"></p>
<p>The  Single Insert Connector is connected to Shell2</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step22"></a>Epilog</h4>
<table class="code">
  <tr>
    <td>
      <pre>...
  rc = CATDocumentServices::Remove(*pDoc);
...</pre>
    </td>
  </tr>
</table>
<p>To remove the document,&nbsp; use the CATDocumentServices::Remove&nbsp; method. For more
detail on managing documents see [<a href="#References">2</a>].</p>
<table class="code">
  <tr>
    <td>
      <pre>...
rc = ::Delete_Session(sessionName);
...</pre>
    </td>
  </tr>
</table>
<p>The session is deleted before exit.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="InShort"></a>In Short</h3>
<p>This usecase explains how to connect Electrical Devices with Connect API.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="References"></a>References</h3>
<table width="100%">
  <tr>
    <td valign="top">[1]</td>
    <td>Building and Launching a CAA V5 Use Case</td>
  </tr>
  <tr>
    <td valign="top">[2]</td>
    <td>Creating  a New Document</td>
  </tr>
  <tr>
    <td valign="top">&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td valign="top">&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td valign="top">&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td valign="top">&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="History"></a>History</h3>
<table width="100%">
  <tr>
    <td valign="top">Version: <strong>1</strong> [Jan 2014]</td>
    <td valign="top">Document created</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<p><i>Copyright © 2014, Dassault Systèmes. All rights reserved.</i></p>

<p>&nbsp;</p>

</body>
</html>


