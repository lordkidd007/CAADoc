<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<script type="text/javascript" src="../CAADocJavaScript/submit.js">
</script>
<title>Various Failure  Cases on Connecting  Devices with Connect API</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>Equipment &amp; Systems Engineering</h1>
    </td>
    <td valign="top">
      <h2>Electrical Library</h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>Various Failure  Cases on Connecting  Devices with Connect API</h3>
      <em>Failure (Non Standard) cases on connecting  Devices with Connect API.</em></td>
  </tr>
  <tr>
    <td class="use" colspan="2">Use Case</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p>This article discusses the <i>CAAElecConnectCases </i> use case. Various failure (Non Standard) 
	  cases while connecting Electrical Devices with Connect API.</p>
      <ul>
        <li><strong><a href="#Learn">What You Will Learn With This Use Case</a></strong></li>
        <li><a href="#UseCase"><strong>The CAAElecConnectCases Use Case</strong></a>
          <ul>
            <li><a href="#What">What Does CAAElecConnectCases Do</a></li>
            <li><a href="#How">How to Launch CAAElecConnectCases </a></li>
            <li><a href="#Where">Where to Find the 
            CAAElecConnectCases  Code</a></li>
          </ul>
        </li>
        <li><strong><a href="#Step">Step-by-Step</a></strong></li>
        <li><strong><a href="#InShort">In Short</a></strong></li>
        <li><strong><a href="#History">History</a></strong></li>
      </ul>
    </td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
<p>This use case is intended to help you make your first steps in programming with 
CATIA ELB Interfaces. Failure (Non Standard) cases on connecting  Devices with Connect API..</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="UseCase"></a>The CAAElecConnectCases Use Case</h3>
<p>CAAElecConnectCases  is a use case of the CAAElecDeviceItf.edu framework
that illustrates the use of the CATIA ELB interface capabilities of 
the ElecDeviceItf framework .</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="What"></a>What Does CAAElecConnectCases  Do</h4>
<p> The goal of CAAElecConnectCases use case is to check the failure (Non Standard) cases on connecting  Devices with Connect API..</i></p>
<p align="center">
<img border="0" src="images/CAAElecConnectCases_data.jpg" width="877" height="706"></p>
<p>Above is a CATIA V5 image of the data used in this sample.
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="How"></a>How to Launch CAAElecConnectCases </h4>
<p>To launch CAAElecConnectCases , you will need to set up the build time
environment, then compile CAAElecConnectCases.cpp along with its
prerequisites, set up the run time environment, and then execute the sample.</p>
<p>To launch the use case, execute the following command:</p>
<pre>mkrun -c &quot;CAAElecConnectCases  Input_data N&quot;</pre>
<ul>
  <li><b>Inputdata</b> - the path to the Cases excluding the suffix which is the case number. 
	<li><b>N</b> - Number of the cases to be tested
	<p>You may reference the supplied CATProduct document called &quot;TOP.CATProduct&quot; in the various cases
	found in:</p>
	<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border-width: 0" bordercolor="#111111" width="100%" id="AutoNumber1">
	  <tr>
      <td width="5%" style="border-style: none; border-width: medium">Unix</td>
      <td width="95%" style="border-style: none; border-width: medium"><code>InstallRootDirectory/CAAElecDeviceItf.edu/CNext/resources/graphic/CAAElecConnectCases</code></td>
    </tr>
    <tr>
      <td width="5%" style="border-style: none; border-width: medium">Windows</td>
      <td width="95%" style="border-style: none; border-width: medium"><code>InstallRootDirectory\CAAElecDeviceItf.edu\CNext\resources\graphic\CAAElecConnectCases</code></td>
    </tr>
	</table>
	<p>where <b>InstallRootDirectory</b> is the root directory of your CAA V5 installation, 
	and <b>OS</b> is a directory the name of which depends on the operating system. 
	Refer to [<a href="#References">1</a>] to get the list of the currently supported 
	operating systems and their associated directory names.</p>
	</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Where"></a>Where to Find the <i>CAAElecConnectCases </i> Code</h4>
<p>CAAElecConnectCases  code is located in the 
CAAElecConnectCases.m use case
module of the CAAElecDeviceItf.edu framework:</p>
<table>
  <tr>
    <td>Unix</td>
    <td><code>InstallRootDirectory/CAAElecDeviceItf.edu/CAAElecConnectCases.m/src/CAAElecConnectCases.cpp</code></td>
  </tr>
  <tr>
    <td>Windows</td>
    <td><code>InstallRootDirectory\CAAElecDeviceItf.edu\CAAElecConnectCases.m\src\CAAElecConnectCases.cpp</code></td>
  </tr>
</table>
<p>where <code>InstallRootDirectory</code> is the directory where the CAA CD-ROM 
is installed.</p>
<p>This sample deals with the following classes:</p>
<table>
	<tr>
		<td><i>IUnknown</i></td>
		<td>Base Class for the References and Instances</td>
	</tr>
	<tr>
		<td><i>CATSessionServices</i></td>
		<td>Class for managing the session</td>
	</tr>
	<tr>
		<td><i>CATDocument</i></td>
		<td>Class for the document base class</td>
	</tr>
	<tr>
		<td><i>CATDocumentServices</i></td>
		<td>Class for managing document in the session</td>
	</tr>
	<tr>
		<td><i>CATIDocRoots</i></td>
		<td>Class for browsing root object in document</td>
	</tr>
	<tr>
		<td><i>CATIEleDocServices</i></td>
		<td>Interface dedicated electrical environment initialization</td>
	</tr>
	<tr>
		<td><i>CATIElecAttrAccess</i></td>
		<td>Interface dedicated to manage electrical attribute</td>
	</tr>
	<tr>
		<td><i>CATIElbEquipment</i></td>
		<td>Interface for defining electrical equipment behavior</td>
	</tr>
	<tr>
		<td><i>CATIElbSingleConnector</i></td>
		<td>Interface for defining single connector behavior</td>
	</tr>
	<tr>
		<td><i>CATIElbCavity</i></td>
		<td>Interface for defining electrical cavity behavior</td>
	</tr>
	<tr>
		<td><i>CATIElbConnectorShell</i></td>
		<td>Interface for defining electrical connector shell behavior</td>
	</tr>
	<tr>
		<td><i>CATIElbBackShell</i></td>
		<td>Interface to manage Back Shells.</td>
	</tr>
	<tr>
		<td><i>CATIElbMountingEquipment</i></td>
		<td>Interface to manage Mounting Equipments.</td>
	</tr>
	<tr>
		<td><i>CATIElbDeviceInstance</i></td>
		<td>Interface to the devices instance management.</td>
	</tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="Step"></a>Step-by-Step</h3>
<p>We will now first comment the Electrical environment and it&#8217;s components creation 
by looking at the code of the CAAElecDevice. There are 30 logical steps in CAAElecDevice:</p>
<table width="100%">
	<tr>
		<td><b>#</b></td>
		<td><b>Step</b></td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step1">1</a></td>
		<td valign="top">Creating the session and opening an existing CATProduct</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step2">2</a></td>
		<td valign="top">Retrieving the root product of the CATProduct document</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step3">3</a></td>
		<td valign="top">Initializing Electrical Environment</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step4">4</a></td>
		<td valign="top">Retrieving Single Insert Connector under the root product  </td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step5">5</a></td>
		<td valign="top">Retrieving Back Shell under the root product  .</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step6">6</a></td>
		<td valign="top">Retrieving Shell under the root product  .</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step7">7</a></td>
		<td valign="top">Retrieving Mounting Equipments under the root product</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step8">8</a></td>
		<td valign="top">Retrieving  Equipments under the root product</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step9">9</a></td>
		<td valign="top">Connect on ME</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step10">10</a></td>
		<td valign="top">Connect on SIC</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step11">11</a></td>
		<td valign="top">Connect on Shell</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step12">12</a></td>
		<td valign="top">Connect on Equipment</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step13">13</a></td>
		<td valign="top">Connect on SIC</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step14">14</a></td>
		<td valign="top">Connect on Shell</td>
	<tr>
		<td valign="top"><a href="#Step15">15</a></td>
		<td valign="top">Connect on Back Shell</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step16">16</a></td>
		<td valign="top">Connect on SIC</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step17">17</a></td>
		<td valign="top">Test GetConnectedDevice on CATIElbDeviceInstance when no device is connected</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step18">18</a></td>
		<td valign="top">Connect MountingEquipment1 to MountingEquipment2</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step19">19</a></td>
		<td valign="top">Connect SIC to ME</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step20">20</a></td>
		<td valign="top">Disconnect SIC from ME</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step21">21</a></td>
		<td valign="top">Connect Shell to ME</td>
	</tr>
	
	<tr>
		<td valign="top"><a href="#Step22">22</a></td>
		<td valign="top">Disconnect Shell from ME</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step23">23</a></td>
		<td valign="top">Connect Equipment to ME</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step24">24</a></td>
		<td valign="top">Connect SIC to Equipment</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step25">25</a></td>
		<td valign="top"> Disconnect SIC from Equipment</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step26">26</a></td>
		<td valign="top">Connect Shell to Equipment</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step27">27</a></td>
		<td valign="top">Connect Shell1 to Shell2</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step28">28</a></td>
		<td valign="top">DisConnect BackShell from Shell2</td>
	</tr>
	<tr>
		<td valign="top"><a href="#Step29">29</a></td>
		<td valign="top">Connect SIC to Shell</td>
	</tr>
	
	<tr>
		<td valign="top"><a href="#Step30">30</a></td>
		<td valign="top">Epilog</td>
	</tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step1"></a>Creating the session and opening an existing CATProduct</h4>
<p>We need a <i>CATSession</i> pointer to create the Session.</p>
<table class="code">
	<tr>
		<td>
		<pre>...
CATSession *pSession = NULL;
char *sessionName = &quot;CAA_ElbDevice_Session&quot;;
HRESULT rc = ::Create_Session(sessionName,pSession);
...</pre>
		</td>
	</tr>
</table>
<p>We need a CATDocument pointer to opening the document.</p>
<table class="code">
	<tr>
		<td>
		<pre>...
CATDocument *pDoc = NULL;
rc = CATDocumentServices::OpenDocument(argv[1], pDoc);
...</pre>
		</td>
	</tr>
</table>
<p>Once the current session has been created, the CATProduct document can be loaded 
into the session. pDoc is a pointer to this document.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step2"></a>Retrieving the root product of the CATProduct document</h4>
<p>We need a <i>CATProduct</i> pointer to retrieve the root product.</p>
<table class="code">
	<tr>
		<td>
		<pre>....
  CATIProduct* piRootProduct = NULL;  
  CATIDocRoots * pDocRoots = NULL;
  rc = pDoc-&gt;QueryInterface(IID_CATIDocRoots,(void**) &amp;pDocRoots);
  ...
  CATListValCATBaseUnknown_var* pListRootProduct = pDocRoots-&gt;GiveDocRoots();
  ...
  if ( pListRootProduct &amp;&amp; pListRootProduct-&gt;Size() )
  {  
    rc = (*pListRootProduct)[1]-&gt;QueryInterface(IID_CATIProduct,(void**) &amp;piRootProduct );
  }
...</pre>
		</td>
	</tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step3">Initializing Electrical Environment</a></h4>
<p>To initialize the electrical environment, use the CATIElecDocServices 
interface:</p>
<table class="code">
  <tr>
    <td>
      <pre>...
 CATIEleDocServices * piElecDocServices = NULL;
rc = pDoc-&gt;QueryInterface(IID_CATIEleDocServices,(void**) &amp;piElecDocServices );
</pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
<h4><a name="Step4">Retrieving Single Insert Connector under the root product  </a></h4>
<p>Retrieving all Single Insert Connector under the root product  </p>
<table class="code">
  <tr>
    <td>
      <pre>...
    CATListValCATBaseUnknown_var* pListElbSingleConnector = NULL;
    pListElbSingleConnector = piRootProduct-&gt;GetAllChildren(CATIElbSingleConnector::ClassName());

    int NumberOfSingleConnector = pListElbSingleConnector?pListElbSingleConnector-&gt;Size():0;
  ...
  CATBaseUnknown_var spCBU = NULL_var;
  CATIElbSingleConnector * pSingleConnector = NULL;
  
    spCBU = ((*pListElbSingleConnector)[1]);
    if (NULL_var != spCBU)
      RC = spCBU-&gt;QueryInterface(IID_CATIElbSingleConnector,(void**) &pSingleConnector);
...</pre>
		</td>
	</tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step5">Retrieving Back Shell under the root product </a></h4>
<p>Retrieving Back Shell under the root product </p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATListValCATBaseUnknown_var* pListElbBackShell = NULL;
    pListElbBackShell = piRootProduct-&gt;GetAllChildren(CATIElbBackShell::ClassName());

    int NumberOfBS = pListElbBackShell?pListElbBackShell-&gt;Size():0;
   ...
   CATIElbBackShell * pBackShell = NULL;
spCBU = ((*pListElbBackShell)[1]);
    if (NULL_var != spCBU)
      RC = spCBU-&gt;QueryInterface(IID_CATIElbBackShell,(void**) &pBackShell);
...
...</pre>
		</td>
	</tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step6">Retrieving Shell under the root product </a></h4>
<p>Retrieving Back Shell under the root product </p>
<table class="code">
  <tr>
    <td>
      <pre>...
    CATListValCATBaseUnknown_var* pListShell = NULL;
    pListShell = piRootProduct-&gt;GetAllChildren(CATIElbConnectorShell::ClassName());

    int NumberOfShells = pListShell?pListShell-&gt;Size():0;
 ...
spCBU = ((*pListShell)[1]);
CATIElbConnectorShell * pShell1 = NULL;
CATIElbConnectorShell * pShell2 = NULL;
    if (NULL_var != spCBU)
      RC = spCBU-&gt;QueryInterface(IID_CATIElbConnectorShell,(void**) &amp;pShell1);

    spCBU = ((*pListShell)[2]);
    if (NULL_var != spCBU)
      RC = spCBU-&gt;QueryInterface(IID_CATIElbConnectorShell,(void**) &amp;pShell2);
...</pre>
		</td>
	</tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step7">Retrieving Mounting Equipments under the root product</a></h4>
<p>Retrieving Mounting Equipments under the root product</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATListValCATBaseUnknown_var* pListMountingEquip = NULL;
    pListMountingEquip = piRootProduct-&gt;GetAllChildren(CATIElbMountingEquipment::ClassName());

    int NumberOfME = pListMountingEquip?pListMountingEquip-&gt;Size():0;
...
    spCBU = ((*pListMountingEquip)[1]);
	CATIElbMountingEquipment * pME1 = NULL;
    CATIElbMountingEquipment * pME2 = NULL;
    if (NULL_var != spCBU)
      RC = spCBU-&gt;QueryInterface(IID_CATIElbMountingEquipment,(void**) &amp;pME1);

    spCBU = ((*pListMountingEquip)[2]);
    if (NULL_var != spCBU)
      RC = spCBU-&gt;QueryInterface(IID_CATIElbMountingEquipment,(void**) &amp;pME2);
   ...</pre>
		</td>
	</tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step8">Retrieving  Equipments under the root product</a></h4>
<p>Retrieving  Equipments under the root product</p>
<table class="code">
  <tr>
    <td>
      <pre>...
    CATListValCATBaseUnknown_var* pListEquipments = NULL;
    pListEquipments = piRootProduct-&gt;GetAllChildren(CATIElbEquipment::ClassName());
    int NumberOfEquipments = pListEquipments?pListEquipments-&gt;Size():0;
   ...
    spCBU = ((*pListEquipments)[1]);
	CATIElbEquipment * pEquipment = NULL;
    if (NULL_var != spCBU)
      RC = spCBU-&gt;QueryInterface(IID_CATIElbEquipment,(void**) &amp;pEquipment);
...</pre>
		</td>
	</tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step9">Connect on ME</a></h4>
<p>Connect on ME</p>
<table class="code">
  <tr>
    <td>
      <pre>...
    int StatusOfGeometricalConstraint = 2;
	CATIElbCavity * pCavity1 = NULL;
	CATIElbMountingEquipment * pME = NULL;
      RC = pME2-&gt;Connect(pCavity1,pME,StatusOfGeometricalConstraint);
	  ...</pre>
		</td>
	</tr>
</table>
<p> The RC is E_INVALIDARG as the Mounting Equipment cannot connect with the other Mounting Equipment</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step10">Connect on SIC</a></h4>
<p>Connect on SIC</p>
<table class="code">
  <tr>
    <td>
      <pre>...
      RC = pSingleConnector-&gt;Connect(pCavity1,pME,StatusOfGeometricalConstraint);
  ...</pre>
		</td>
	</tr>
</table>
<p> The RC is E_INVALIDARG as the Mounting Equipment cannot connect with the Single Insert Connector</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step11">Connect on Shell</a></h4>
<p>Connect on Shell</p>
<table class="code">
  <tr>
    <td>
      <pre>...
      RC = pShell1-&gt;Connect(pCavity1,pME,StatusOfGeometricalConstraint);
...</pre>
		</td>
	</tr>
</table>
<p> The RC is E_INVALIDARG as the Shell cannot connect with the  Mounting Equipment</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step12">Connect on Equipment</a></h4>
<p>Connect on Equipment</p>
<table class="code">
  <tr>
    <td>
      <pre>...
      RC = pEquipment-&gt;Connect(pCavity1,pME,StatusOfGeometricalConstraint);
	  <p> The RC is E_INVALIDARG as the  Equipment cannot connect with the  Mounting Equipment</p>
...</pre>
		</td>
	</tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step13">Connect on SIC</a></h4>
<p>Connect on SIC</p>
<table class="code">
  <tr>
    <td>
      <pre>...
      RC = pSingleConnector-&gt;Connect(pCavity1,pEquipment1,StatusOfGeometricalConstraint);
...</pre>
		</td>
	</tr>
</table>
<p> The RC is E_INVALIDARG as the Single Insert Connector cannot connect with the Equipment</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step14">Connect on Shell</a></h4>
<p>Connect on Shell</p>
<table class="code">
  <tr>
    <td>
      <pre>...
      RC = pShell1-&gt;Connect(pCavity1,pEquipment1,StatusOfGeometricalConstraint);
...
      RC = pShell1-&gt;Connect(pShell,StatusOfGeometricalConstraint);
	  ...</pre>
		</td>
	</tr>
</table>
<p> The RC is E_INVALIDARG as the Shell cannot connect with the other  Equipment</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step15">Connect on Back Shell</a></h4>
<p>Connect on Shell</p>
<table class="code">
  <tr>
    <td>
      <pre>...
      RC = pShell2-&gt;Connect(pBackShell1,StatusOfGeometricalConstraint);
...</pre>
		</td>
	</tr>
</table>
<p> The RC is E_INVALIDARG as the Shell2 cannot connect with the Shell1</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step16">Connect on SIC</a></h4>
<p>Connect on SIC</p>
<table class="code">
  <tr>
    <td>
      <pre>...
      RC = pSingleConnector-&gt;Connect(pCavity1,pShell,StatusOfGeometricalConstraint);
      ...
    }
...</pre>
		</td>
	</tr>
</table>
<p> The RC is E_INVALIDARG as the Single Insert Connector cannot connect with the  Shell</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step17">Test GetConnectedDevice on CATIElbDeviceInstance when no device is connected</a></h4>
<p>Test GetConnectedDevice on CATIElbDeviceInstance when no device is connected</p>
<table class="code">
  <tr>
    <td>
      <pre>...
    if(1==iCase)
    {
      RC = pME2-&gt;ListCavityCnctPts(CavityCnctPts);

      if(SUCCEEDED(RC) &amp;&amp; (NULL != CavityCnctPts) &amp;&amp; (CavityCnctPts-&gt;Size()>0))
        hccp = ((*CavityCnctPts)[1]);
CATIElbDeviceInstance * pDevInst = NULL;
      RC = pME1-&gt;QueryInterface(IID_CATIElbDeviceInstance, (void **)&amp;pdevinst);
   CATBaseUnknown * pCnctPt = NULL;
   CATBaseUnknown * pdevice = NULL;
   CATBaseUnknown * pOCnctPt = NULL;
      if((NULL != pdevinst) &amp;&amp; (NULL != pCnctPt))
        RC = pdevinst&amp;gt;GetConnectedDevice(pCnctPt,pdevice,pOCnctPt);
...
    }
...</pre>
		</td>
	</tr>
</table>
<p>Get the device connected to the current device through a given connection point.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step18">Connect MountingEquipment1 to MountingEquipment2</a></h4>
<p>Connect MountingEquipment1 to MountingEquipment2</p>
<table class="code">
  <tr>
    <td>
      <pre>...
    if(NULL != pCavity)
    {
      RC = pME2-&gt;Connect(pCavity,pME1,StatusOfGeometricalConstraint);
	  
    }
...</pre>
		</td>
	</tr>
</table>
<p> The RC is E_FAIL when the Mounting Equipment1 cannot connect with the other Mountingto  Equipment2
 The RC is SUCCEEDED when geometrical constraint is over constrained</p>
<p align="right">[<a href="#Top">Top</a>]</p>

 <!---------------------------------comment------------------------------------->
<h4><a name="Step19">Connect SIC to ME</a></h4>
<p>Connect SIC to ME</p>
<table class="code">
  <tr>
    <td>
      <pre>...
	  CATListValCATBaseUnknown_var* pCavities = NULL; 
    RC = pME2-&gt;ListCavities(pCavities);

    if((NULL != pCavities) &amp;&amp; (pCavities-&gt;Size()==1))
    {
      CATBaseUnknown_var hCavity((*pCavities)[1]);

      if(NULL != pCavity)
      {
        pCavity -&gt; Release();
        pCavity = NULL ;
      }

      if(NULL_var!=hCavity)
        RC = hCavity-&gt;QueryInterface(IID_CATIElbCavity , (void**)&pCavity);

      if (NULL != pCavity)
      {
        RC = pSingleConnector-&gt;Connect(pCavity,pME2,StatusOfGeometricalConstraint);
      }
    }   
...</pre>
		</td>
	</tr>
</table>
<p> The RC is E_FAIL as the Single Insert Connector cannot connect with the  Mounting Equipment when 
 no Geometrical constraint is defined between the two MEs .
 RC is SUCCEEDED  when geometrical constraint is over constrained</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step20">Disconnect SIC from ME</a></h4>
<p>Disconnect SIC from ME</p>
<table class="code">
  <tr>
    <td>
      <pre>...
      RC = pSingleConnector-&gt;QueryInterface(IID_CATIElbDeviceInstance, (void **)&amp;pDevInst1);

      if(NULL != pDevInst1)
      {
        RC = pDevInst1-&gt;Disconnect(pDevInst2);
...
        RC = pME2-&gt;QueryInterface(IID_CATIElbDeviceInstance, (void **)&amp;pDevInst2);

        if(SUCCEEDED(RC))
        {
          RC = pDevInst1-&gt;Disconnect(pDevInst2);
         ...
        }
      }
    }
...</pre>
		</td>
	</tr>
</table>
<p> The RC is SUCCEEDED for  disconnecting  the Single Insert Connector from the Mounting Equipment</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step21">Connect Shell to ME</a></h4>
<p>Connect Shell to ME</p>
<table class="code">
  <tr>
    <td>
      <pre>...
    RC = pME2-&gt;ListCavities(pCavities);

    if((NULL != pCavities) &amp;&amp; (pCavities-&gt;Size()==1))
    {
      CATBaseUnknown_var hCavity((*pCavities)[1]);
	...

      if(NULL_var!=hCavity)
        RC = hCavity-&gt;QueryInterface(IID_CATIElbCavity , (void**)&amp;pCavity);

      if ((NULL != pShell1) &amp;&amp; (NULL != pCavity) &amp;&amp; (NULL !=pME2))
      {
        RC = pShell1-&gt;Connect(pCavity,pME2,StatusOfGeometricalConstraint);
      }
    }
...</pre>
		</td>
	</tr>
</table>
<p> The RC is E_FAIL as the Shell cannot connect with the  Mounting Equipment when 
 no Geometrical constraint is defined between the devices .
 RC is SUCCEEDED  when geometrical constraint is over constrained</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step22">Disconnect Shell from ME</a></h4>
<p>Disconnect Shell from ME</p>
<table class="code">
  <tr>
    <td>
      <pre>...
      RC = pShell1-&gt;QueryInterface(IID_CATIElbDeviceInstance, (void **)&amp;pDevInst1);  

      if(SUCCEEDED(RC))
      {
        RC = pDevInst1-&gt;Disconnect(pDevInst2);
...
        }
      }
  ...</pre>
		</td>
	</tr>
</table>
<p> The RC is SUCCEEDED for disconnecting  the Shell from the Mounting Equipment</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step23">Connect Equipment to ME</a></h4>
<p>Connect Equipment to ME</p>
<table class="code">
  <tr>
    <td>
      <pre>...
    RC = pME2-&gt;ListCavities(pCavities);

    if((NULL != pCavities) &amp;&amp; (pCavities-&gt;Size()==1))
    {
      CATBaseUnknown_var hCavity((*pCavities)[1]);
	...
	
      if(NULL_var!=hCavity)
        RC = hCavity-&gt;QueryInterface(IID_CATIElbCavity , (void**)&amp;pCavity);

      if ((NULL != pEquipment) &amp;&amp; (NULL != pCavity) &amp;&amp; (NULL !=pME2))
      {
        RC = pEquipment-&gt;Connect(pCavity,pME2,StatusOfGeometricalConstraint);
      }
    }
	...</pre>
		</td>
	</tr>
</table>
<p> The RC is E_FAIL as the Equipment cannot connect with the  Mounting Equipment when 
 no Geometrical constraint is defined on device.
 RC is SUCCEEDED  when geometrical constraint is over constrained</p>
<p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
<h4><a name="Step24">Connect SIC to Equipment</a></h4>
<p>Connect SIC to Equipment</p>
<table class="code">
  <tr>
    <td>
      <pre>...
    RC = pEquipment-&gt;ListCavities(pCavities);

    if((NULL != pCavities) &amp;&amp; (pCavities-&gt;Size()==1))
    {
      CATBaseUnknown_var hCavity((*pCavities)[1]);
	...

      if(NULL_var!=hCavity)
        RC = hCavity-&gt;QueryInterface(IID_CATIElbCavity , (void**)&amp;pCavity);

      if ((NULL != pEquipment) &amp;&amp; (NULL != pCavity) &amp;&amp; (NULL !=pME2))
      {
        RC = pSingleConnector-&gt;Connect(pCavity,pEquipment,StatusOfGeometricalConstraint);
      }
    }
...</pre>
		</td>
	</tr>
</table>
<p> The RC is E_FAIL as the Single Insert Connector cannot connect with the   Equipment when 
 no Geometrical constraint is defined on device.
 RC is SUCCEEDED  when geometrical constraint is over constrained</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step25"> Disconnect SIC from Equipment</a></h4>
<p> Disconnect SIC from Equipment</p>
<table class="code">
  <tr>
    <td>
      <pre>...
      RC = pSingleConnector-&gt;QueryInterface(IID_CATIElbDeviceInstance, (void **)&amp;pDevInst1);  

      RC = pEquipment-&gt;QueryInterface(IID_CATIElbDeviceInstance, (void **)&amp;pDevInst2);

      if(SUCCEEDED(RC))
      {
        RC = pDevInst1-&gt;Disconnect(pDevInst2);
...
      }
    }
...</pre>
		</td>
	</tr>
</table>
<p> The RC is SUCCEEDED for disconnecting  the Single Insert Connector from the  Equipment</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step26">Connect Shell to Equipment</a></h4>
<p>Connect Shell to Equipment</p>
<table class="code">
  <tr>
    <td>
      <pre>...
    RC = pEquipment-&gt;ListCavities(pCavities);

    if((NULL != pCavities) &amp;&amp; (pCavities-&gt;Size()==1))
    {
      CATBaseUnknown_var hCavity((*pCavities)[1]);
	...

      if(NULL_var!=hCavity)
        RC = hCavity-&gt;QueryInterface(IID_CATIElbCavity , (void**)&amp;pCavity);

      if ((NULL != pShell1) &amp;&amp; (NULL != pCavity) &amp;&amp; (NULL !=pME2))
      {
        RC = pShell1-&gt;Connect(pCavity,pEquipment,StatusOfGeometricalConstraint);
      }
    }
...</pre>
		</td>
	</tr>
</table>
<p> The RC is E_FAIL as the Shell cannot connect with the   Equipment when 
 no Geometrical constraint is defined on device.
 RC is SUCCEEDED  when geometrical constraint is over constrained</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step27">Connect Shell1 to Shell2</a></h4>
<p>Connect Shell1 to Shell2</p>
<table class="code">
  <tr>
    <td>
      <pre>...
    if ((NULL != pShell1) &amp;&amp; (NULL != pShell2))
    {
      RC = pShell1-&gt;Connect(pShell2,StatusOfGeometricalConstraint);
    }
  ...</pre>
		</td>
	</tr>
</table>
<p> The RC is E_FAIL as the Shell1 cannot connect with the   Shell2 when 
 no Geometrical constraint is defined on device.
 RC is SUCCEEDED  when geometrical constraint is over constrained</p>
<p align="right">[<a href="#Top">Top</a>]</p>  
<!---------------------------------comment------------------------------------->
<h4><a name="Step28">DisConnect BackShell from Shell2</a></h4>
<p>DisConnect BackShell from Shell2:</p>
<table class="code">
  <tr>
    <td>
      <pre>...
	    CATIElbDeviceInstance * pDevInst1 = NULL;
		CATIElbDeviceInstance * pDevInst2 = NULL;
RC = pBackShell-&gt;QueryInterface(IID_CATIElbDeviceInstance, (void **)&amp;pDevInst1);  

      RC = pShell2-&gt;QueryInterface(IID_CATIElbDeviceInstance, (void **)&amp;pDevInst2);

      if(SUCCEEDED(RC)&amp;&amp;(NULL != pDevInst1))
      {
        RC = pDevInst1-&gt;Disconnect(pDevInst2);
		...
      }
    }
...</pre>
		</td>
	</tr>
</table>
<p> The RC is SUCCEEDED for disconnecting  the Backshell from the Shell2</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step29"> Connect SIC to Shell</a></h4>
<p> Connect SIC to Shell</p>
<table class="code">
  <tr>
    <td>
      <pre>...
RC = pShell2-&gt;ListCavities(pCavities);

    if((NULL != pCavities) &amp;&amp; (pCavities-&gt;Size()==1))
    {
      CATBaseUnknown_var hCavity((*pCavities)[1]);
     ...

      if(NULL_var!=hCavity)
        RC = hCavity-&gt;QueryInterface(IID_CATIElbCavity , (void**)&amp;pCavity);

      if ((NULL != pShell1) &amp;&amp; (NULL != pCavity) &amp;&amp; (NULL !=pME2))
      {
        RC = pSingleConnector-&gt;Connect(pCavity,pShell2,StatusOfGeometricalConstraint);
      }
    }
...</pre>
		</td>
	</tr>
</table>
<p> The RC is E_FAIL as the SIC cannot connect with the  Shell when 
 no Geometrical constraint is defined on device.
 RC is SUCCEEDED  when geometrical constraint is over constrained</p>
<p align="right">[<a href="#Top">Top</a>]</p>
	
<!---------------------------------comment------------------------------------->	
<h4><a name="Step30"></a>Epilog</h4>
<table class="code">
  <tr>
    <td>
<pre>...
  rc = CATDocumentServices::Remove(*pDoc);
...</pre>
    </td>
  </tr>
</table>
<p>To remove the document,&nbsp; use the CATDocumentServices::Remove&nbsp; method. For more
detail on managing documents see [<a href="#References">2</a>].</p>
<table class="code">
  <tr>
    <td>
      <pre>...
rc = ::Delete_Session(sessionName);
...</pre>
    </td>
  </tr>
</table>
<p>The session is deleted before exit.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="InShort"></a>In Short</h3>
<p>Usecase for the Failure (Non Standard) cases on connecting  Devices with Connect API.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="References"></a>References</h3>
<table width="100%">
  <tr>
    <td valign="top">[1]</td>
    <td>Building and Launching a CAA V5 Use Case</td>
  </tr>
  <tr>
    <td valign="top">[2]</td>
    <td>Creating a New Document</td>
  </tr>
  <tr>
    <td valign="top">&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td valign="top">&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td valign="top">&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td valign="top">&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="History"></a>History</h3>
<table width="100%">
  <tr>
    <td valign="top">Version: <strong>1</strong> [Jan 2014]</td>
    <td valign="top">Document created</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<p><i>Copyright © 2014, Dassault Systèmes. All rights reserved.</i></p>

<p>&nbsp;</p>

</body>

</html>


