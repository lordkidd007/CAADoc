<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<title>Creating and Scanning Activities</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>Inspection Process Definition</h1>
    </td>
    <td valign="top">
      <h2>Inspection</h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>Creating and Scanning Activities</h3>
      <em>Creating, accessing and reading activities</em></td>
  </tr>
  <tr>
    <td class="use" colspan="2">Use Case</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p>This article discusses the CAADNBInsScanActivities use case. This use
      case explains how to create a Process document, and then how to add
      activities to it. Then it scans the activity list and displays some of the
      parameters in a text file.
      <ul>
        <li><strong><a href="#Learn">What You Will Learn With This Use Case</a></strong></li>
        <li><strong><a href="#UseCase">The CAADNBInsScanActivities Use Case</a></strong>
          <ul>
            <li><a href="#What">What Does CAADNBInsScanActivities Do</a>
            <li><a href="#How">How to Launch CAADNBInsScanActivities</a></li>
            <li><a href="#Where">Where to Find the CAADNBInsScanActivities Code</a>
          </ul>
        <li><strong><a href="#Step">Step-by-Step</a></strong></li>
        <li><strong><a href="#In Short">In Short</a></strong></li>
      </ul>
    </td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
<p>This use case is intended to help you create a Process document, create
features and activities, and then scan these activities.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h3><a name="UseCase"></a>The CAADNBInsScanActivities Use Case</h3>
<p>CAADNBInsScanActivities is a use case of the CAADNBInsActivities.m module in
the CAADNBInspectInterfaces.edu framework that illustrates
CAADNBInspectInterfaces framework capabilities.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="What"></a>What Does CAADNBInsScanActivities Do</h4>
<p>CAADNBInsScanActivities is a main program (a batch mode application). First,
it creates a Process document named Experiment.CATProcess, and then it creates a
Line feature and a DefineLine activity, a Sphere feature and a DefineSphere
activity, and a Plane feature and a DefinePlane activity. Then it scans the list
of activities and displays the parameters in a text file named output.txt.
Finally, it saves the Process document.</p>
<table border="0">
  <caption>The Experiment.CATProcess Document</caption>
  <tr>
    <td>
      <pre><img border="0" src="images/CAAInsTpi1.gif" width="747" height="402"></pre>
    </td>
  </tr>
</table>
<p>It also outputs a file named output.txt and displays the parameters of the
activities in the process as shown below:</p>
<table border="0">
  <caption>The output.txt Output File</caption>
  <tr>
    <td><img border="0" src="images/CAAInsOutput.gif" width="844" height="667"></td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="How"></a>How to Launch CAADNBInsScanActivities</h4>
<p>To launch CAADNBInsScanActivities, you will need to set up the build time
environment, then compile CAADNBInsScanActivities along with its prerequisites,
set up the run time environment, and then execute the use case [<a href="#References">1</a>].</p>
<p>Launch the use case as follows:</p>
<ul>
  <li>With Windows
    <table class="code">
      <tr>
        <td>
          <pre>d:&gt;CAADNBInsActivities</pre>
        </td>
      </tr>
    </table>
  <li>With UNIX
    <table class="code">
      <tr>
        <td>
          <pre>$ CAADNBInsActivities</pre>
        </td>
      </tr>
    </table>
  </li>
</ul>
<p>where <code>CAADNBInsActivites</code> is the module which contains the use
case.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Where"></a>Where to Find the CAADNBInsScanActivities Code</h4>
<p>The CAADNBInsScanActivities use case is located in the CAADNBInsActivities.m
module of the CAADNBInspectInterfaces.edu framework:</p>
<table>
  <tr>
    <td>Windows</td>
    <td><code>InstallRootDirectory\CAADNBInspectInterfaces.edu\CAADNBInsActivities.m\</code></td>
  </tr>
  <tr>
    <td>Unix</td>
    <td><code>InstallRootDirectory/CAADNBInspectInterfaces.edu/CAADNBInsActivities.m/</code></td>
  </tr>
</table>
<p>where <code>InstallRootDirectory</code> is the directory where the CAA CD-ROM
is installed.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="Step"></a>Step-by-Step</h3>
<p>&nbsp;</p>
<p>Following are the logical steps in CAADNBInsScanActivities:
<ol>
  <li><a href="#Creating a CATProcess">Creating and Initializing a Process
    Document</a>
  <li><a href="#Handler to DNBIInsFtrFactory Interface">Retrieving the Handler
    to the DNBIInsFtrFactory Interface</a>
  <li><a href="#Handler to DNBIInsActivitiesFactory Interface">Retrieving the
    Handler to the DNBIInsActivitiesFactory Interface</a>
  <li><a href="#Activity Root">Retrieving the Activity Root</a>
  <li><a href="#Creating a Line">Creating a Line Feature and a DefineLine
    Activity</a>
  <li><a href="#Creating a Sphere">Creating a Sphere Feature and a DefineSphere
    Activity</a>
  <li><a href="#Creating a Plane">Creating a Plane Feature and a DefinePlane
    Activity</a>
  <li><a href="#Scanning the DefineLine Activity">Scaning the DefineLine
    Activity</a>
  <li><a href="#Scanning the DefineSphere Activities">Scaning the DefineSphere
    Activity</a>
  <li><a href="#Scanning the DefinePlane Activity">Scaning the DefinePlane
    Activity</a>
  <li><a href="#Saving the CATProcess">Saving the Process Document</a></li>
</ol>
<p>We will now comment each of these sections by looking at the code.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Creating a CATProcess"></a>Creating and Initializing a Process
Document</h4>
<table class="code">
  <tr>
    <td>
      <pre>//=============================================================================
//  Initialize : This method creates a New CATProcess
//               and intialize the current document
//=============================================================================
HRESULT
CAADNBInsServices::Initialize( CATDocument **INSLibDoc )
{
    HRESULT rc = E_FAIL;
  //----------------------------------------------------------------------
  // Initialize
  //----------------------------------------------------------------------
  cout &lt;&lt; endl;
  cout &lt;&lt; &quot;################################################&quot; &lt;&lt; endl;
  cout &lt;&lt; &quot;#    Creating a CATProcess                     #&quot; &lt;&lt; endl;
  cout &lt;&lt; &quot;################################################&quot; &lt;&lt; endl;
  cout &lt;&lt; endl;
  
  //----------------------------------------------------------------------
  // Create a New CATProcess
  //----------------------------------------------------------------------
  rc = CATDocumentServices::New( &quot;CATProcess&quot;,*INSLibDoc );
  if( *INSLibDoc == NULL )
    return( E_FAIL ) ;
  
  // Get a Handler to the BasicServices ,return if NULL_var
  DNBIInsBasicServices_var spInsServ( *INSLibDoc );
  if( NULL_var == spInsServ )
    return( E_FAIL ) ;
  
  // Set the Current Document
  rc = spInsServ-&gt;SetCurrentDocument( *INSLibDoc );
  return( S_OK );
}</pre>
    </td>
  </tr>
</table>
<p>A new Process document is created. The input argument in this method is a
pointer to the <i>CATDocument</i> class. This is a handler to the current
document. This method returns a HRESULT value. This method can be found in
CAADNBInsServ.cpp.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Handler to DNBIInsFtrFactory Interface"></a>Retrieving the Handler
to the DNBIInsFtrFactory Interface</h4>
<table class="code">
  <tr>
    <td>
      <pre>//=============================================================================
//  GetFtrFactory : This method gets the Current Document and returns the
//                  handler to the DNBIInsFtrFactory Interface
//=============================================================================
DNBIInsFtrFactory_var 
CAADNBInsServices::GetFtrFactory( CATDocument *INSLibDoc )
{
  HRESULT rc = E_FAIL;
  CATIContainer_var insCont = NULL_var;
  
  // Get a Handler to the BasicServices ,return if NULL_var
  DNBIInsBasicServices_var spInsServ ( INSLibDoc );
  if( NULL_var == spInsServ )
    return( NULL_var );
  
  // Get Inspect Container
  rc = spInsServ-&gt;GetInspectContainer( insCont, INSLibDoc );
  if ( NULL_var == insCont )
    return( NULL_var );


  // Handler to the DNBIInsFtrFactory
  DNBIInsFtrFactory_var ftrFact( insCont );
  if( NULL_var == ftrFact )
    return( NULL_var );
  
  return( ftrFact );
}</pre>
    </td>
  </tr>
</table>
<p>The <code>GetFtrFactory</code> method is used to get the handler to the <i>DNBIInsFtrFactory</i>
Interface. It takes an argument which is the current document. It gets the
handler to the <i>DNBIInsBasicServices</i> and then it gets the Inspect
Container. This method can be found in CAADNBInsServ.cpp.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Handler to DNBIInsActivitiesFactory Interface"></a>Retrieving the
Handler to the DNBIInsActivitiesFactory Interface</h4>
<table class="code">
  <tr>
    <td>
      <pre>//=============================================================================
//  GetActivityFactory : This method gets the InsertActivity and returns the
//                       handler to the DNBIInsActivitiesFactory Interface
//=============================================================================
DNBIInsActivitiesFactory_var
CAADNBInsServices::GetActivityFactory( CATISPPChildManagement_var InsertActivity )
{
  DNBIInsActivitiesFactory_var ActFact( InsertActivity );
  return( ActFact );
}</pre>
    </td>
  </tr>
</table>
<p>The <code>GetActivityFactory</code> method is used to get the handler to the <i>DNBIInsActivitesFactory</i>
Interface. It takes an argument which is the object of type <i>CATISPPChildManagement</i>
class. This method can be found in CAADNBInsServ.cpp.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Activity Root"></a>Retrieving the Activity Root</h4>
<table class="code">
  <tr>
    <td>
      <pre>//=============================================================================
//  GetActivityRoot : This method gets the the Current Document and returns the
//                    insertion point where new activity needs to be added
//                    In the first case its the fatherActivity
//=============================================================================
HRESULT
CAADNBInsServices::GetActivityRoot( CATISPPChildManagement_var &amp;InsertActivity ,
                                    CATDocument **INSLibDoc )
{
  CATInit_var INSLibDocInit( *INSLibDoc );
  
  // Process Container return if NULL_var
  CATISPPProcessContainer_var ProcessContainer =
                              INSLibDocInit-&gt;GetRootContainer(
                              CATISPPProcessContainer::ClassName() );
  if( NULL_var == ProcessContainer )
    return( E_FAIL );
  
  // List Of Processes
  CATListValCATBaseUnknown_var *listOfProcesses =
                                ProcessContainer-&gt;GetAllProcess();
  if( NULL == listOfProcesses )
    return( E_FAIL );
  
  // Activity Root
  CATISPPActivityRoot_var spActivityRoot = ( *listOfProcesses )[1];
  if( NULL_var == spActivityRoot )
    return( E_FAIL );
  
  // Get the Insert Activity , New Features will be added to the insert activity
  InsertActivity =  spActivityRoot;
  return( S_OK );
}</pre>
    </td>
  </tr>
</table>
<p>The <code>GetActivityRoot</code> method is used to get the Activity Root. It
takes two arguments, one of which is the object of type <i>CATISPPChildManagement</i>
interface, and the other one is of type <i>CATDocument</i> class (the current
document). This method can be found in CAADNBInsServ.cpp.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Creating a Line"></a>Creating a Line Feature and a DefineLine
Activity</h4>
<table class="code">
  <tr>
    <td>
      <pre>//=============================================================================
//  CreateLine : This method gets the InsertActivity , creates a LineFeature
//               ,creates a LineActivity, sets the LineItem to the Activity
//               List and returns the handler to the Line
//=============================================================================
DNBIInsLine
*CreateLine( CATDocument *INSLibDoc,
             CATISPPChildManagement_var &amp;InsertActivity )
{
  HRESULT rc = E_FAIL;
  DNBIInsFtrFactory_var ftrFact = NULL_var;
  DNBIInsActivitiesFactory_var ActFact = NULL_var;
 
  CATISpecObject_var spObj = NULL_var;
  CATBaseUnknown_var spIDefineLine = NULL_var;
 
  // Get the handler to the feature factory
  ftrFact = CAADNBInsServices::GetFtrFactory( INSLibDoc );

  // Get the handler to the Activity factory
  ActFact = CAADNBInsServices::GetActivityFactory( InsertActivity );

  // Return if the Handler to the FtrFactory or ActivitiesFactory is NULL_var
	if( NULL_var == ftrFact || NULL_var == ActFact )
		return( NULL );

  //----------------------------------------------------------------------
  //  Create Line Feature
  //----------------------------------------------------------------------
  rc = ftrFact-&gt;CreateLine( spObj );
  if( NULL_var == spObj )
    return( NULL );
  
  // Get the Handler to the Line
  DNBIInsLine *spLine = NULL;
  rc = spObj-&gt;QueryInterface( IID_DNBIInsLine,( void ** )&amp;spLine );
  if( FAILED( rc ) )
    return( NULL );
  
  // Set Line Parameters
  spLine-&gt;SetLength( 25.00 );
  spLine-&gt;SetMatOffset( 1.00 );
  
  //----------------------------------------------------------------------
  //  Create Line Activity
  //----------------------------------------------------------------------
  spIDefineLine = ActFact-&gt;Create( InsertActivity,&quot;DefineLine&quot; );
  
  // Set the Item
  CATISPPItemMgt_var spItm( spIDefineLine );
  if( NULL_var == spItm )
    return( NULL );
  spItm-&gt;AddItem( spLine );
  
  // Set the InsertActivity(Insertion Point) as the New Activity
  InsertActivity =  spIDefineLine ;
  
  return( spLine );
}</pre>
    </td>
  </tr>
</table>
<p><br>
The <code>CreateLine</code> method gets the InsertActivity, creates a Line
feature then it creates a DefineLine activity, finally it adds this activity to
the InsertActivity and it returns the handler to the Line.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Creating a Sphere"></a>Creating a Sphere Feature and a DefineSphere
Activity</h4>
<table class="code">
  <tr>
    <td>
      <pre>//=============================================================================
//  CreateSphere : This method gets the InsertActivity ,creates a SphereFeature
//                 creates a SphereActivity,sets the SphereItem to the Activity
//                 list and returns the handler to the Sphere
//=============================================================================
DNBIInsSphere
*CreateSphere( CATDocument *INSLibDoc,
               CATISPPChildManagement_var &amp;InsertActivity )
{
  HRESULT rc = E_FAIL;
  DNBIInsFtrFactory_var ftrFact = NULL_var;
  DNBIInsActivitiesFactory_var ActFact = NULL_var;
  CATISpecObject_var spObj = NULL_var;
  CATBaseUnknown_var spIDefineSphere = NULL_var;

  // Get the handler to the feature factory
  ftrFact = CAADNBInsServices::GetFtrFactory( INSLibDoc );

  // Get the handler to the Activity factory
  ActFact = CAADNBInsServices::GetActivityFactory( InsertActivity );

  // Return if the Handler to the FtrFactory or ActivitiesFactory is NULL_var
	if( NULL_var == ftrFact || NULL_var == ActFact )
		return( NULL );

  //----------------------------------------------------------------------
  //  Create Sphere Feature
  //----------------------------------------------------------------------
  rc = ftrFact-&gt;CreateSphere( spObj );
  if( NULL_var == spObj )
    return( NULL );
  
  // Get the Handler to the Sphere
  DNBIInsSphere *spSphere = NULL;
  rc = spObj-&gt;QueryInterface( IID_DNBIInsSphere,( void ** )&amp;spSphere );
  if( FAILED( rc ) )
    return( NULL );
  
  CATMathVector Vec( 20.00,-30.00,0 );
  CATMathTransformation objPos;
  objPos.SetVector(Vec);
  
  // Set Sphere Parameters
  spSphere-&gt;SetDiameter( 30.00 );
  spSphere-&gt;SetPosition( objPos );
  
  //----------------------------------------------------------------------
  //  Create Sphere Activity
  //----------------------------------------------------------------------
  spIDefineSphere = ActFact-&gt;Create( InsertActivity,&quot;DefineSphere&quot; );
  
  // Set the Item
  CATISPPItemMgt_var spItm ( spIDefineSphere );
  if( NULL_var == spItm )
    return( NULL );
  spItm-&gt;AddItem( spSphere );
  
  // Set the InsertActivity(Insertion Point) as the New Activity
  InsertActivity =  spIDefineSphere ;
  
  return( spSphere );
}</pre>
    </td>
  </tr>
</table>
<p>The <code>CreateSphere</code> method gets the InsertActivity, creates a
Sphere feature then it creates a DefineSphere activity, finally it adds this
activity to the InsertActivity and it returns the handler to the Sphere.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Creating a Plane"></a>Creating a Plane Feature and a DefinePlane
Activity</h4>
<table class="code">
  <tr>
    <td>
      <pre>//=============================================================================
//  CreatePlane : This method gets the InsertActivity , creates a PlaneFeature,
//                creates a PlaneActivity ,Sets the PlaneItem to the Activity 
//                List and returns a handler to the Plane
//=============================================================================
DNBIInsPlane
*CreatePlane( CATDocument *INSLibDoc,
              CATISPPChildManagement_var &amp;InsertActivity )
{
  HRESULT rc = E_FAIL;
  DNBIInsFtrFactory_var ftrFact = NULL_var;
  DNBIInsActivitiesFactory_var ActFact = NULL_var;
  CATISpecObject_var spObj = NULL_var;
  CATBaseUnknown_var spIDefinePlane = NULL_var;

  // Get the handler to the feature factory
  ftrFact = CAADNBInsServices::GetFtrFactory( INSLibDoc );

  // Get the handler to the Activity factory
  ActFact = CAADNBInsServices::GetActivityFactory( InsertActivity );

  // Return if the Handler to the FtrFactory or ActivitiesFactory is NULL_var
	if( NULL_var == ftrFact || NULL_var == ActFact )
		return( NULL );

  //----------------------------------------------------------------------
  // Create Plane Feature
  //----------------------------------------------------------------------
  rc = ftrFact-&gt;CreatePlane( spObj );
  if( NULL_var == spObj )
    return( NULL );
  
  // Get the Handler to the Plane
  DNBIInsPlane *spPlane = NULL;
  rc = spObj-&gt;QueryInterface( IID_DNBIInsPlane,( void ** )&amp;spPlane );
  if( FAILED( rc ) )
    return( NULL );
  
  
  CATMathVector Vec(-20.00,35.00,0);
  CATMathTransformation objPos;
  objPos.SetVector(Vec);
  
  // Set Plane Parameters
  spPlane-&gt;SetLength(40.00);
  spPlane-&gt;SetWidth(40.00);
  spPlane-&gt;SetPosition(objPos);
  //----------------------------------------------------------------------
  //  Create Plane Activity
  //----------------------------------------------------------------------
  spIDefinePlane = ActFact-&gt;Create( InsertActivity,&quot;DefinePlane&quot; );
  
  // Set the Item
  CATISPPItemMgt_var spItm ( spIDefinePlane );
  if( NULL_var == spItm )
    return( NULL );
  spItm-&gt;AddItem( spPlane );
  
  // Set the InsertActivity(Insertion Point) as the New Activity
  InsertActivity =  spIDefinePlane ;
  
  return( spPlane );
}</pre>
    </td>
  </tr>
</table>
<p>The <code>CreatePlane</code> method gets the InsertActivity, creates a Plane
feature then it creates a DefinePlane activity, finally it adds this activity to
the InsertActivity and it returns the handler to the Plane.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Scanning the DefineLine Activity"></a>Scanning the DefineLine
Activity</h4>
<table class="code">
  <tr>
    <td>
      <pre>//=============================================================================
//  ScanLine   : This method gets the handler to the Line Activity 
//               and then it displays the information about the Line
//=============================================================================
CATUnicodeString
ScanLine( DNBIInsLine *objLine )
{
  // Declaring the variables
  double length ,thick ;
  CATUnicodeString name;
  CATUnicodeString output;
  CATUnicodeString temp;
  
  // Check if handler to DNBIInsLine Interface is not null
  if( NULL == objLine )
    return( output );
  
  // Get the Parameters
  objLine-&gt;GetLength( length );         // Length
  objLine-&gt;GetMatOffset( thick );       // Thickness
  
  CATIAlias_var alias( objLine );       // Name
  if( NULL_var != alias )
  {
    name = alias-&gt;GetAlias();
  }
  
  // Output
  output.Append(&quot;\n LINE INFO ::\n&quot;);
  output.Append(&quot;\tName     \t\t&quot;);
  output.Append(name.ConvertToChar());
  output.Append(&quot;\n\tLength   \t\t&quot;);
  // To convert integer to string
  temp.BuildFromNum( length ); 
  output.Append( temp );
  output.Append(&quot; mm\n&quot;);
  output.Append(&quot;\tThickness\t\t&quot;);
  temp.BuildFromNum( thick );
  output.Append( temp );
  output.Append(&quot; mm\n&quot;);

  return( output );
}</pre>
    </td>
  </tr>
</table>
<p>The <code>ScanLine</code> method gets the handler to the Line feature which
needs to be scanned. It then gets the Line parameters and returns a <i>CATUnicodeString</i>
which holds all the Line Parameters.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Scanning the DefineSphere Activities"></a>Scanning the DefineSphere
Activity</h4>
<table class="code">
  <tr>
    <td>
      <pre>//=============================================================================
//  ScanSphere : This method gets the handler to the Sphere Activity
//               and then it displays the information about the Sphere
//=============================================================================
CATUnicodeString
ScanSphere( DNBIInsSphere *objSphere )
{
  // Declare the Variables
  double diam ,thick;
  CATUnicodeString name ;
  double ioI,ioJ,ioK ;
  double XCord, YCord, ZCord ;
  CATMathPoint Center ;
  CATMathVector oNorm ;
  CATUnicodeString output;
  CATUnicodeString temp;
  
  // Check if the Handler to the DNBIInsSphere interface is not null
  if( NULL == objSphere )
    return( output );
  
  // Get the parameters
  objSphere-&gt;GetNormal( oNorm );             // Handler for Normal
  oNorm.GetCoord( ioI,ioJ,ioK );             // Normal Co-ordinates
  objSphere-&gt;GetOrigin ( Center );           // Handler for Origin
  Center.GetCoord( XCord , YCord , ZCord );  // Origin Co-ordinates
  objSphere-&gt;GetDiameter( diam );
  objSphere-&gt;GetMatOffset( thick );
  
  CATIAlias_var alias( objSphere );       // Name
  if( NULL_var != alias )
  {
    name = alias-&gt;GetAlias();
  }
  
  // Output
  output.Append(&quot;\n\n\n SPHERE INFO ::\n&quot;);
  output.Append(&quot;\tName     \t\t&quot;);
  output.Append(name.ConvertToChar());
  output.Append(&quot;\n\tOrigin Coordinates   \n\t\tX\t\t&quot;);
  temp.BuildFromNum( XCord );
  output.Append( temp );
  output.Append( &quot; mm\n\t\tY\t\t&quot; );
  temp.BuildFromNum( YCord );
  output.Append( temp );
  output.Append( &quot; mm\n\t\tZ\t\t&quot; );
  temp.BuildFromNum( ZCord );
  output.Append( temp );
  output.Append( &quot; mm\n\tNormalCordinates\n\t\tI\t\t&quot; );
  temp.BuildFromNum( ioI );
  output.Append( temp );
  output.Append( &quot; mm\n\t\tJ\t\t&quot; );
  temp.BuildFromNum( ioJ );
  output.Append( temp );
  output.Append( &quot; mm\n\t\tK\t\t&quot; );
  temp.BuildFromNum( ioK );
  output.Append( temp );
  output.Append( &quot; mm&quot; );
  
  output.Append(&quot;\n\tDiameter\t\t&quot;);
  temp.BuildFromNum( diam );
  output.Append( temp );
  output.Append(&quot; mm&quot;);
  
  output.Append(&quot;\n\tThickness\t\t&quot;);
  temp.BuildFromNum( thick );
  output.Append( temp );
  output.Append(&quot; mm\n&quot;);
  
  return( output );
}</pre>
    </td>
  </tr>
</table>
<p>The <code>ScanSphere</code> method gets the handler to the Sphere feature
which needs to be scanned. It then gets the Sphere parameters and returns a <i>CATUnicodeString</i>
which holds all the Sphere parameters.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Scanning the DefinePlane Activity"></a>Scanning the DefinePlane
Activity</h4>
<table class="code">
  <tr>
    <td>
      <pre>//=============================================================================
//  ScanPlane  : This method gets the handler to the Plane Activity
//               and then it displays the information about the Plane
//=============================================================================
CATUnicodeString
ScanPlane( DNBIInsPlane *objPlane )
{
  // Declaring the Variables
  int type ;
  CATUnicodeString name ;
  CATUnicodeString planetype ;
  double length,width,thick;
  double XCord, YCord, ZCord ;
  CATMathPoint Center ;
  CATUnicodeString output;
  CATUnicodeString temp;
  
  // Check if the object to the DNBIInsPlane Interface is not null
  if( NULL == objPlane )
    return( output );
  
  objPlane-&gt;GetLength( length );         // Length
  objPlane-&gt;GetWidth( width );           // Width
  objPlane-&gt;GetPlaneType( type );        
  objPlane-&gt;GetMatOffset( thick );       // Thickness
  objPlane-&gt;GetOrigin ( Center );           // Handler for Origin
  Center.GetCoord( XCord , YCord , ZCord );  // Origin Co-ordinates
  
  //----------------------------------------------------------------------
  //  Extract Plane Type from 'type' value
  //----------------------------------------------------------------------
  if( type == 1 )
    planetype = &quot;Rectangular&quot;;
  else
    planetype = &quot;Circular&quot;;
  
  
  CATIAlias_var alias( objPlane );       // Name
  if( NULL_var != alias )
  {
    name = alias-&gt;GetAlias();
  }
  
  // Output
  output.Append(&quot;\n\n PLANE INFO ::&quot;);
  output.Append(&quot;\n\tName\t\t&quot;);
  output.Append(name.ConvertToChar());
  output.Append(&quot;\n\tOrigin Coordinates\n\t\tX\t\t&quot;);
  temp.BuildFromNum( XCord );
  output.Append( temp );
  output.Append( &quot; mm\n\t\tY\t\t&quot; );
  temp.BuildFromNum( YCord );
  output.Append( temp );
  output.Append( &quot; mm\n\t\tZ\t\t&quot; );
  temp.BuildFromNum( ZCord );
  output.Append( temp ); 
  output.Append(&quot; mm\n\tlength\t\t&quot;);
  temp.BuildFromNum( length );
  output.Append( temp );
  output.Append(&quot; mm&quot;);
  
  output.Append(&quot;\n\tWidth\t\t\t&quot;);
  temp.BuildFromNum( width );
  output.Append( temp );
  output.Append(&quot; mm&quot;);
  
  output.Append(&quot;\n\tThickness\t\t&quot;);
  temp.BuildFromNum( width );
  output.Append( temp );
  output.Append(&quot; mm\n\t&quot;);
  output.Append(&quot;PlaneType\t\t&quot;);
  output.Append(planetype);
  
  return( output );
}</pre>
    </td>
  </tr>
</table>
<p>The <code>ScanPlane</code> method gets the handler to the Plane feature which
needs to be scanned. It then gets the Plane parameters and returns a <i>CATUnicodeString</i>
which holds all the Plane parameters.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Saving the CATProcess"></a>Saving the Process Document</h4>
<p>The Process document is saved with the name Experiment.CATProcess.&nbsp;This
method can be found in CAADNBInsServ.cpp.</p>
<table class="code">
  <tr>
    <td>
      <pre>//=============================================================================
//  SaveProcess : This method gets the Current Document and saves the
//                CATProcess
//=============================================================================
HRESULT
CAADNBInsServices::SaveProcess( CATDocument *INSLibDoc )
{
  //----------------------------------------------------------------------
  //   Save the CATProcess
  //----------------------------------------------------------------------

  cout &lt;&lt; endl;
  cout &lt;&lt; &quot;################################################&quot; &lt;&lt; endl;
  cout &lt;&lt; &quot;#    Save the document                         #&quot; &lt;&lt; endl;
  cout &lt;&lt; &quot;################################################&quot; &lt;&lt; endl;
  cout &lt;&lt; endl;

  cout &lt;&lt; &quot;  Saving the process ...&quot;;
  CATIPersistent_var Persistdoc (INSLibDoc);
  if( NULL_var == Persistdoc  )
    return( E_FAIL );
 
  Persistdoc-&gt;SaveAs( &quot;Experiment.CATProcess&quot;,FALSE );
  cout &lt;&lt; &quot;OK&quot; &lt;&lt; endl;
  return( S_OK );
}</pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="In Short"></a>In Short</h3>
<p>This use case has demonstrated the way to create a Process document and add
features, create activities and finally scanning the activities.</p>
<p>The use case:</p>
<ul>
  <li>Creates a Process document</li>
  <li>Creates features and sets their parameters</li>
  <li>Creates activities and adds to the parent activity</li>
  <li>Scans the activities and stores the results in a output file named
    output.txt</li>
  <li>Saves the Process document as Experiment.CATProcess.</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="References"></a>References</h3>
<table width="100%">
  <tr>
    <td>[1]</td>
    <td><a href="../CAADocUseCases/CAADocRunSample.htm">Building
      and Launching a CAA V5 Use Case</a></td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<table border="0" width="100%">
  <tr>
    <td colspan="2"><strong><em><a name="History">History</a></em></strong></td>
  </tr>
  <tr>
    <td valign="top">Version: <strong>1</strong> [Mar 2002]</td>
    <td valign="top">Document created</td>
  </tr>
  <tr>
    <td valign="top" colspan="2">
      <p align="right">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<p><i>Copyright © 2000, Dassault Systèmes. All rights reserved.</i></p>

</body>

</html>
