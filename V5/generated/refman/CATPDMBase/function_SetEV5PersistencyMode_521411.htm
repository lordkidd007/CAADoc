<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
 <meta http-equiv="Content-Language" content="en-us"> 
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
 <meta name="Generator" content="CppGene v1.1">
 <meta http-equiv="Expires" content="Tue, 04 Dec 1993 21:29:02 GMT">
 <title>CATPDMBase Global Function SetEV5PersistencyMode</title>
<link rel="Stylesheet" type="text/css" href="../../../caav5.css">
</head>
<body>
<pre><a href="../main.htm">All Frameworks</a>  <a href="../tree.htm">Class Hierarchy</a>  <a href="../CATPDMBase.htm">This Framework</a>  <a href="../HomeIdx.htm">Indexes</a></pre>
<hr>
<h1>CATPDMBase Global Function SetEV5PersistencyMode</h1>

<br><dt><table><tr><td>  <a href="../System/typedef_HRESULT_8345.htm"> HRESULT</a>  <b>SetEV5PersistencyMode</b>(<td><a href="../ObjectModelerBase/class_CATDocument_25209.htm">CATDocument*</a> <td><tt>ipDoc</tt>,<tr><td></td><td> const CATIPDMPersistency::VaultMode&amp; <td><tt>iSaveMode</tt>,<tr><td></td><td> const <a href="../System/typedef_CATBoolean_20142.htm">CATBoolean&amp;</a> <td><tt>iPropagate</tt><td><tt>= FALSE</tt>)<a href="../DNBSystem/struct__0.htm"></a>  </table></dt>
<dl>
  <dd>
 Interface to set the persistency mode for a product to be saved in ENOVIA V5 and its children.

 <br><b>Role:</b>Enable to set the persistency mode for a product and optionally its children before to Save them in ENOVIA V5.
 <br>

 
<dl>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> ipDoc</tt>
   <dd>    (input) The CATIA document to set its persistency mode.

 </dd>
    <dt><tt> iSaveMode</tt>
   <dd>    (input) The persistency mode for the document to be saved. Possible values are: 
    <ul>
      <li><tt>PermanentBlackBox</tt>: Product, Part or any other applicative document will be streamed in the Vault.</li>
      <li><tt>VolatileExposed</tt>: Product document will be saved and exposed in ENOVIA V5 VPM.</li>
      <li>Values NotDefined and PermanentExposed are not accepted.</li>
    </ul>

 </dd>
    <dt><tt> iPropagate</tt>
   <dd>    (input) Boolean flag to enable the persistency mode propagation on children documents. Possible values are:
    <ul>
      <li><tt>TRUE</tt>: Propagation enable.</li>
      <li><tt>FALSE</tt>: Propagation unable.</li>
    </ul>

 </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>      <ul>
      <li><tt>S_OK</tt>: Persistency mode successfully set on document and successfully propagated on children.</li>
      <li><tt>S_FALSE</tt>: VolatileExposed mode successfully set on document, but the children propagation has only been partially executed.</li>
      <li><tt>E_FAIL</tt>: Persistency Mode or persistency children propagation has failed. Possible errors may be: 
       <ul>
        <li>The connection with the ENOVIA V5 Server isn't established.</li>
        <li>The Document to be set is already persisted in ENOVIA V5.</li>
        <li>The VolatileExposed mode isn’t supported on standalone CATProduct</li>
        <li>The PermanentBlackBox mode can't be set on Document, because the VolatileExposed mode is set on one of its children.</li>
        <li>The VolatileExposed mode can't be set on Document, because the PermanentBlackBox mode is set on one of its parents.</li>
        <li>The VolatileExposed mode propagation can't be done, because a child of the document is already persisted as a PermanentBlackBox in EV5.</li>
        <li>The PermanentBlackBox mode propagation can't be done, because a child of the document is already persisted as VolatileExposed in EV5.</li>
        <li>An abnormal error happened while setting or propagting the VaultMode.</li>
       </ul>
      </li>
      <li><tt>E_INVALIDARG</tt>: One or several arguments contain an improper value. Possible errors may be:
       <ul>
        <li>The [ipDoc] parameter is NULL or is not a CATDocument.</li>
        <li>The [iSaveMode] parameter value is different from "PermanentBlackBox" and "VolatileExposed"</li>
        <li>The [iSaveMode] parameter value is "VolatileExposed" whereas the [ipDoc] parameter isn't a "CATProduct" typed document.</li>
       </ul>
      </li>
    </ul>
</dl>
</dl>
<hr>
 This object is included in the file: <b>CATPDMInteropServices.h</b><br>

</body>
<hr><p><i>
Copyright &#169; 2003, Dassault Syst&#232;mes. All rights reserved.</i></p>
</html>
