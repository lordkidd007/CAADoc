<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="en-us" http-equiv="Content-Language" />
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
<link href="../CAADocStyleSheets/caav5.css" rel="stylesheet" type="text/css"/>
<script src="../CAADocJavaScript/DSDocTocToc.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/DSDocHighlight.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/submit.js" type="text/javascript">/* */</script>
<title>Creating an Add-in in the Folder Workshop</title>
</head>

<body onload="highlightSearchTerms();">

<table class="DocHeader">
	<tr>
		<td class="DocHeader1">
		<h1><a name="Top"></a>Creating an Add-in in the Folder Workshop</h1>
		</td>
	</tr>
	<tr>
		<td class="use">Use Case</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table class="abstract">
	<tr>
		<td>
		<h2>Abstract</h2>
		<p>This article shows how to create an add-in in Folder workshop based on 
		CAAFldUIFolderWorkshopAddin use case. </p>
		<ul>
			<li><a href="#Learn">What You Will Learn With This Use Case</a> </li>
			<li><a href="#UseCase">The CAAFldUIFolderWorkshopAddin Use Case</a>
				<ul>
					<li><a href="#What">What Does CAAFldUIFolderWorkshopAddin Do</a></li>
					<li><a href="#How">How to Launch CAAFldUIFolderWorkshopAddin</a></li>
					<li><a href="#Where">Where to Find the CAAFldUIFolderWorkshopAddin 
						Code</a></li>
				</ul>
			</li>
			<li><a href="#Step">Step-by-Step</a> </li>
			<li><a href="#InShort">In Short</a> </li>
			<li><a href="#References">References</a> </li>
		</ul>
		</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Learn"></a>What You Will Learn With This Use Case</h2>
<p>By implementing the <em>PLMIFolderWorkshopAdd</em> ininterface, a toolbar with 
its commands can be made active in any Folder Workshop. Please see article [<a href="#References">1</a>] 
if the toolbar should only be made active in the Folder Editor workbench.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="UseCase"></a>The CAAFldUIFolderWorkshopAddin Use Case</h2>
<p>CAAFldUIFolderWorkshopAddin is a use case of the CAAFolderInterfacesUI.edu framework 
that illustrates PLMFolderViewerInterfaces framework capabilities.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="What"></a>What Does CAAFldUIFolderWorkshopAddin Do</h3>
<p>The goal of CAAFldUIFolderWorkshopAddin is to demonstrate how to implement the
<em>PLMIFolderWorkshopAddin</em> interface. It consists of the following parts:</p>
<ul>
	<li>Code to create the toolbar and the layout of the commands.</li>
	<li>Code to be executed when the command is selected.</li>
	<li>Resource definition for the visual aspects of the user interface.</li>
</ul>
<p>
<img alt="Folder Workshop Add-in" src="images/CAAFldUIFolderWorkshopAddin_Global.png"/></p>
<p>A new toolbar appears on top of the CATIA frame and contains a single command 
represented by the
<img alt="Folder Workshop Add-in Icon" height="24" src="images/CAAFldUIFolderWorkshopAddin_I.png" width="24"/> 
icon.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="How"></a>How to Launch CAAFldUIFolderWorkshopAddin</h3>
<p>To launch CAAFldUIFolderWorkshopAddin:</p>
<ol>
	<li>Edit <code>InstallRootFolder\CAADoc\CAAFolderInterfacesUI.edu\CNext\code\dictionary\CAAFolderInterfacesUI.edu.dico</code> 
		dictionary by uncommenting the #CAA# from the following line containing
		<code>PLMIFolderWorkshopAddin</code>
		<pre class="code"># CAAFolderWorkshopAddin use case
# -------------------------------
#CAA# CAAFldUIFolderWorkshopAddinExt PLMIFolderWorkshopAddin libCAAFldUIFolderWorkshopAddin 
#CAA# CAAFldUIFolderWorkshopAddinExt CATIWorkbenchAddin libCAAFldUIFolderWorkshopAddin </pre>
	</li>
	<li>See reference [<a href="#References">2</a>] for other steps.</li>
	<li>Once launched, display the toolbar named &quot;CAA Folder Workshop Add-in 
		Toolbar&quot; if necessary:
		<p>
		<img alt="Folder Workshop Add-in Toolbar" src="images/CAAFldUIFolderWorkshopAddin_Toolbar.png"/></p>
	</li>
	<li>Click on the command and a dialog box will appear. </li>
</ol>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Where"></a>Where to Find the CAAFldUIFolderWorkshopAddin Code</h3>
<p>The CAAFldUIFolderWorkshopAddin use case is made of a single file located in 
the CAAFldUIFolderWorkshopAddin.m module of the CAAFolderInterfacesUI.edu framework:</p>
<p><code>InstallRootFolder\CAADoc\CAAFolderInterfacesUI.edu\CAAFldUIFolderWorkshopAddin.m</code></p>
<p>where <code>InstallRootFolder</code> [<a href="#References">2</a>] is the folder 
where the API CD-ROM is installed.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Step"></a>Step-by-Step</h2>
<p>There are two steps in CAAFldUIFolderWorkshopAddin:</p>
<ol>
	<li><a href="#Step1">Toolbar Creation and Layout</a></li>
	<li><a href="#Step3">User Interface</a></li>
</ol>
<p>We will now detail each of those sections:</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step1"></a>Toolbar Creation and Layout</h3>
<p>The implementation of <em>PLMIFolderWorkshopAddin</em> is provided by CAAFldUIFolderWorkshopAddin 
class. Its purpose is to create the toolbar and to layout the commands on it. Only 
two methods need be defined: <a href="#CreateToolbars"><code>CreateToolbars</code></a> 
and <a href="#CreateCommands"><code>CreateCommands</code></a>.</p>
<pre class="code">...
class CATCmdContainer;

class CAAFldUIFolderWorkshopAddin: public CATBaseUnknown
{
  CATDeclareClass;

  public:
    // Standard constructors and destructors for an implementation class
    // -----------------------------------------------------------------
    CAAFldUIFolderWorkshopAddin();
    virtual ~CAAFldUIFolderWorkshopAddin();

    /**
     * @see ApplicationFrame.CATIWorkbenchAddin#CreateCommands
     */
    void CreateCommands();

    /**
     * @see ApplicationFrame.CATIWorkbenchAddin#CreateToolbars
     */
    CATCmdContainer * CreateToolbars();

  private:
    // The copy constructor and the equal operator must not be implemented
    // -------------------------------------------------------------------
    CAAFldUIFolderWorkshopAddin(CAAFldUIFolderWorkshopAddin &amp;);
    CAAFldUIFolderWorkshopAddin&amp; operator=(CAAFldUIFolderWorkshopAddin&amp;);
};
...</pre>
<p><a name="CreateToolbars"></a>The purpose of the <code>CreateToolbars</code> method 
is to create all the command headers of our toolbar. In this case a toolbar named 
CAAFldUIFolderWorkshopAddinToolbar with a command named CAAFldUIFolderWorkshopAddinCmd1 
is created.</p>
<pre class="code">...
CATCmdContainer * CAAFldUIFolderWorkshopAddin::CreateToolbars()
{
  CAAFldUIFolderWorkshopAddinTRACE(&quot;&gt;&gt; CAAFldUIFolderWorkshopAddin::CreateToolbars()&quot;);

  // Declaration of toolbar for Addin
  NewAccess(CATCmdContainer, pToolbarContainer, CAAFldUIFolderWorkshopAddinToolbar);
  NewAccess(CATCmdStarter, pCommandStarter, CAAFldUIFolderWorkshopAddinStarter);

  // Arranging the command within the toolbar
  SetAccessCommand(pCommandStarter, &quot;CAAFldUIFolderWorkshopAddinCmd1&quot;);
  SetAccessChild(pToolbarContainer, pCommandStarter);

  int visibleFlag = 1;
  AddToolbarView (pToolbarContainer, visibleFlag, Top);

  CAAFldUIFolderWorkshopAddinTRACE(&quot;&lt;&lt; CAAFldUIFolderWorkshopAddin::CreateToolbars()&quot;);
  return pToolbarContainer;
}
...</pre>
<p><a name="CreateCommands"></a>The purpose of the <code>CreateCommands</code> method 
is to create all the command headers of our toolbar. Our command header class CAAFldUIFolderWorkshopAddinHeader 
is defined by the means of <code>MacDeclareHeader</code> macro.</p>
<p>Here a command named CAAFldUIFolderWorkshopAddinCmd1 is created. It is located 
in the CAAFldUIFolderWorkshopAddin shared library and its associated class is CAAFldUIFolderWorkshopAddinCmd. 
The ShowProduct identifier will be used to locate resources related to this command.</p>
<pre class="code">...
void CAAFldUIFolderWorkshopAddin::CreateCommands()
{
  CAAFldUIFolderWorkshopAddinTRACE(&quot;&gt;&gt; CAAFldUIFolderWorkshopAddin::CreateCommands()&quot;);

  // Instantiates the command header for the command
  new CAAFldUIFolderWorkshopAddinHeader(&quot;CAAFldUIFolderWorkshopAddinCmd1&quot;, // command name
    &quot;CAAFldUIFolderWorkshopAddin&quot;, // lib name
    &quot;CAAFldUIFolderWorkshopAddinCmd&quot;, // class name
    (void*) NULL);

  CAAFldUIFolderWorkshopAddinTRACE(&quot;&lt;&lt; CAAFldUIFolderWorkshopAddin::CreateCommands()&quot;);
}
...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step3"></a>User Interface</h3>
<p>There are two visible objects: the toolbar and its command.</p>
<p>The title of the toolbar named CAAFldUIFolderWorkshopAddinToolbar is defined 
by the CAAFldUIFolderWorkshopAddin.CATNls which can be found in <code>InstallRootFolder\CAADoc\CAAFolderInterfacesUI.edu\CNext\resources\msgcatalog</code> 
directory.</p>
<pre class="code">CAAFldUIFolderWorkshopAddinToolbar.Title = &quot;CAA Folder Workshop Addin Toolbar&quot;;</pre>
<p>CAAFldUIFolderWorkshopAddinCmd1 resources are defined by three files:</p>
<ol>
	<li><code>CAAFldUIFolderWorkshopAddinHeader</code>.<code>CATNls</code> (located 
		in the <code>InstallRootFolder\CAADoc\CAAFolderInterfacesUI.edu\CNext\resources\msgcatalog</code> 
		folder):
		<pre class="code">CAAFldUIFolderWorkshopAddinHeader.CAAFldUIFolderWorkshopAddinCmd1.Title = &quot;CAA Folder Workshop cmd1&quot;;
CAAFldUIFolderWorkshopAddinHeader.CAAFldUIFolderWorkshopAddinCmd1.Help = &quot;CAA Folder Workshop cmd1 long help text&quot;;
CAAFldUIFolderWorkshopAddinHeader.CAAFldUIFolderWorkshopAddinCmd1.ShortHelp = &quot;CAA Folder Workshop cmd1 info&quot;;</pre>
		<p>These texts correspond to the screen tip, the documentation line and 
		the command prompt input:</p>
		<p>
		<img alt="Folder Workshop cmd1 info" src="images/CAAFldUIFolderWorkshopAddin_CmdInfo.png"/></p>
	</li>
	<li><code>CAAFldUIFolderWorkshopAddinHeader.CATRsc</code> (located in the
		<code>InstallRootFolder\CAADoc\CAAFolderInterfacesUI.edu\CNext\resources\msgcatalog</code> 
		folder) defines the bitmap name for the command icon:
		<pre class="code">CAAFldUIFolderWorkshopAddinHeader.CAAFldUIFolderWorkshopAddinCmd1.Icon.Normal=&quot;CAAFldUIFolderWorkshopAddin_I&quot;;</pre>
	</li>
	<li><code>CAAFldUIFolderWorkshopAddin_I.png</code> (located in the <code>InstallRootFolder\CAADoc\CAAFolderInterfacesUI.edu\CNext\resources\graphic\icons\normal</code> 
		folder) contains the bitmap the command icon:
		<img alt="Folder Workshop Add-in Icon" height="24" src="images/CAAFldUIFolderWorkshopAddin_I.png" width="24"/>
	</li>
</ol>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="InShort"></a>In Short</h2>
<p>This use case has shown how to create a toolbar with a command within folder 
workshop:</p>
<ul>
	<li>Implement the <em>PLMIFolderWorkshopAddin</em> interface to create a toolbar 
		and layout the commands.</li>
	<li>Derive from CATCommand to implement the command action.</li>
	<li>Define resource files for the user interface.</li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="References"></a>References</h2>
<table class="reference">
	<tr>
		<td>[1]</td>
		<td><a href="CAAFldUcUIFolderWorkbenchAddin.htm">Creating an Add-in in the 
		Folder Workbench</a></td>
	</tr>
	<tr>
		<td>[2]</td>
		<td>
		<a href="../CAADocUseCases/CAADocRunSample.htm">
		Building and Launching a Use Case</a></td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="History"></a>History</h2>
<table class="history">
	<tr>
		<td>Version: <strong>1</strong> [Nov 2006]</td>
		<td>Document created</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
