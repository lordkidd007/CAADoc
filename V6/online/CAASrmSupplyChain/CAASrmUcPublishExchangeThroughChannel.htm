<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<script type="text/javascript" src="../CAADocJavaScript/DSDocHighlight.js"></script>
<script type="text/javascript" src="../CAADocJavaScript/submit.js"></script>
<title>Publishing a PLM Entity through a PLM Channel</title>
</head>

<body onload="highlightSearchTerms();">

<table class="DocHeader">
	<tr>
		<td class="DocHeader1">
		<h1><a name="Top"></a>Publishing a PLM Entity through a PLM Channel</h1>
		</td>
	</tr>
	<tr>
		<td class="use">Use Case</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table class="abstract">
	<tr>
		<td>
		<h2>Abstract</h2>
		<p>The Use Case shows how to publish a PLM Entity through a PLM Channel.</p>
		<p>A PLM Channel is an exchange context created between two specific repositories 
		in order to allow optimized data exchange and ownership transfers. Refer 
		the Technical article [<a href="#References">1</a>] for the details of PLM 
		Channel creation and Data Exchange.</p>
		<ul>
			<li><a href="#Learn">What You Will Learn With This Use Case</a> </li>
			<li><a href="#UseCase">The CAASrmPublishExchangeThroughChannel Use Case</a>
			<ul>
				<li><a href="#What">What Does CAASrmPublishExchangeThroughChannel 
				Do</a> </li>
				<li><a href="#How">How to Launch CAASrmPublishExchangeThroughChannel
				</a></li>
				<li><a href="#Where">Where to Find the CAASrmPublishExchangeThroughChannel 
				Code</a> </li>
			</ul>
			</li>
			<li><a href="#Step">Step-by-Step</a> </li>
			<li><a href="#InShort">In Short</a> </li>
			<li><a href="#References">References</a> </li>
		</ul>
		</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Learn"></a>What You Will Learn With This Use Case</h2>
<p>This use case is intended to show you how to publish a PLM Entity to initiate 
data exchange through the PLM Channel. It retrieves a PLM Entity from the local 
repository and generates a PLMBriefcase file containing the exchange data.</p>
<p>Publish extracts PLM data to be exchanged, at Sender site and published it through 
the PLM Channel. It generates a PLMBriefcase file containing the exchange data. 
This briefcase is sent (through email , file transfer etc) to the receiver site. 
The Publish operation gives the option of transferring the site ownership of the 
entire published data to the other site. Refer the Technical article [<a href="#References">1</a>]&nbsp; 
for the details of Site Ownership Transfer.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="UseCase"></a>The CAASrmPublishExchangeThroughChannel Use Case</h2>
<p><code><strong>CAASrmPublishExchangeThroughChannel</strong></code> is a use case 
of the <code><strong>CAASRMExposedServices.edu</strong></code> framework that illustrates
<code><strong>PLMSRMExposedServices</strong></code> framework capabilities.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="What"></a>What Does CAASrmPublishExchangeThroughChannel Do</h3>
<p>Acknowledging the PLM Channel creation[<a href="#References">4</a>] use case 
activates the PLM channel . Once the PLM Channel is activated , data can be exchanged 
between the two sites. Sender begins the process of data exchange by retrieving 
the identificators of PLM Entity and then the PLM entities are published .The use 
case generates a PLMBriefcase file (containing the exchange information of all the 
PLM Entities ) to be published to other site.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="How"></a>How to Launch CAASrmPublishExchangeThroughChannel</h3>
<p>To launch <code><strong>CAASrmPublishExchangeThroughChannel</strong></code>, 
you will need to set up the build time environment, then compile <code><strong>CAASrmPublishExchangeThroughChannel
</strong></code>along with its prerequisites, set up the run time environment, and 
then execute the use case [<a href="#References">7</a>].</p>
<p>To launch the use case execute the command:</p>
<p><code><strong>mkrun -c &quot;CAASrmPublishExchangeThroughChannel <em>Repository Server 
User Password SecurityCtx PLMType ChannelIDTextFilePath Date 
OwnershipTransfer BriefcaseFilePath IDAttribute1 AttrValue1 [IDAttribute2 Value2 
...]</em>&quot;</strong></code></p>
<p>where:</p>
<table class="border1">
	<tr>
		<th>Repository</th>
		<td>
		<script type="text/javascript">insertRepository();</script>
		</td>
	</tr>
	<tr>
		<th>Server</th>
		<td>The server as <em>Host::port_number/RootURI</em></td>
	</tr>
	<tr>
		<th>User</th>
		<td>The user name</td>
	</tr>
	<tr>
		<th>Password</th>
		<td>The user password to authenticate the user</td>
	</tr>
	<tr>
		<th>SecurityCtx</th>
		<td>A string representing the security context (Role.Organization.Project). 
		Choose Role as Designer</td>
	</tr>
			<tr>
		<th>PLMType</th>
		<td>A PLMType</td>
	</tr>
	<tr>
		<th>ChannelIDTextFilePath</th>
		<td>The path of the text file containing the identification of the PLM Channel. 
		This channel identification will be used for publishing the PLM entities 
		through PLM Channel. The text file used here comes either from Initializing 
		PLM Channel[<a href="#References">2</a>] use case or Finalizing PLM Channel[<a href="#References">3</a>] 
		use case.</td>
	</tr>
	<tr>
		<th>dateString</th>
		<td>A string which is used to decide whether the representations should 
		be filtered depending on the current local date or not. If its value is 
		YES, then all Representations modified before the current local date are 
		excluded from the list of PLM Entities to publish.</td>
	</tr>
	<tr>
		<th>transfer</th>
		<td>A string which is used to decide whether to transfer or not the site 
		ownership of the published entities. If its value is TRUE , then the site 
		ownership of the PLM Entities are transferred else not transferred.</td>
	</tr>
	<tr>
		<th>BriefcaseFilePath</th>
		<td>The path of the file where to write the PLMBriefcase file generated 
		by this use case. The file must not exist and its extension must be &quot;.PLMBriefcase&quot;. 
		Example: &quot;C:\Temp\BriefcaseFilePath.PLMBriefcase&quot;.</td>
	</tr>
	<tr>
		<th>IDAttribute1*</th>
		<td>IDSet attribute Name of the PLM Reference to be published through the 
		PLM Channel</td>
	</tr>
	<tr>
		<th>AttrValue1*</th>
		<td>Attribute Value of the PLM Reference to be published through the PLM 
		Channel</td>
	</tr>
</table>
<p>* We could have several such Attribute-Value set. The count is determined by 
the IDSet attributes of the PLM Reference to be published</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Where"></a>Where to Find the CAASrmPublishExchangeThroughChannel Code</h3>
<p>The <code><strong>CAASrmPublishExchangeThroughChannel</strong></code> use case 
is made of a single file located in the <code><strong>CAASrmPublishExchangeThroughChannel</strong></code> 
module of the <code><strong>CAASRMExposedServices.edu</strong></code> framework:</p>
<p><code>InstallRootFolder\CAADoc\CAASRMExposedServices.edu\CAASrmPublishExchangeThroughChannel.m\</code></p>
<p>where <code>InstallRootFolder</code> [<a href="#References">8</a>] is the folder 
where the API CD-ROM is installed.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Step"></a>Step-by-Step</h2>
<ul>
	<li><a href="#Prolog">Prolog</a></li>
	<li><a href="#Retrieve">Retrieve the Identificators</a> </li>
	<li><a href="#Publish">Publish the PLM Entity</a></li>
	<li><a href="#Epilog">Epilog</a> </li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Prolog"></a>Prolog</h3>
<p>The <code><strong>CAASrmPublishExchangeThroughChannel</strong></code> use case 
begins by creating a session and connecting to the Input Repository with an appropriate 
role. The use case &quot;Creating a Basic PLM Batch&quot; [<a href="#References">8</a>] deals 
with Opening and Closing a PLM Session.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Retrieve"></a>Retrieve the Identificators</h3>
<p>Once the PLM Channel is created and activated [<a href="#References">4</a>]successfully, 
data can now be exchanged between the two sites . Sender first retrieve the
<code><strong>Identificators</strong></code> of the input PLM Entity.</p>
<pre class="code">...
  CATIAdpPLMIdentificator* opiIDComp = NULL;
  hr = ::CAARetrieveIDofUniquePLMObject(iListAttributeName,iListAttributeValue,														
					iStrPLMType,opiIDComp);   
...</pre>
<p>A call to <strong>CAARetrieveIDofUniquePLMObject</strong><code><strong>
</strong></code>returns the identificator of the input PLM Entity. This API takes 
the PLM type and the Attribute set as input. These identificators are 
then used to publish the PLM Entity.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Publish"></a>Publish the PLM Entity</h3>
<p>Publishing the PLM Entity mainly involves reading the channel identification 
from the text file and then using it for publishing the PLM data.</p>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h4>Read the Channel Identification from the text file</h4>
<pre class="code">...
     CATUnicodeString ChannelIDTextFilePath = ChannelIDTextFile; 
     unsigned int oFileDescriptor = 0;
     HRESULT rc = <strong>CATFOpen</strong>(&amp;ChannelIDTextFilePath, &quot;w&quot;, &amp;oFileDescriptor);  
     {
     ...
     unsigned int NbChar = 0;
     rc = <strong>CATFSize</strong>(oFileDescriptor,&amp;NbChar);
     ...
     char* pBuffer = new char[NbChar+1];
     unsigned int onbReadChar = 0;
     rc = <strong>CATFRead</strong>(oFileDescriptor, pBuffer, NbChar,&amp; onbReadChar); 
     ...
     rc = <strong>CATFClose</strong>(oFileDescriptor);
     }
...
</pre>
<p>The <code><strong>CATFOpen</strong></code> method takes as input the path of 
the text file to be opened and the opening mode of the file. It returns a file descriptor 
that will be used in the other functions for manipulating the opened file.</p>
<p>The <code><strong>CATFSize</strong></code> method returns the current size of 
a file previously opened with CATFOpen. It takes as input the file descriptor that 
has been obtained through CATFOpen and returns the size of the file.</p>
<p>The <code><strong>CATFRead</strong></code> method reads from a file previously 
opened with CATFOpen. It takes as input the file descriptor of the file , the buffer 
where the data will be stored and the size of the buffer. It returns the length 
of the data actually read. The Channel identificator read in this process is used 
by the site for publishing the PLM data.</p>
<p>The <code><strong>CATFClose</strong></code> method closes the file. It takes 
as input the file descriptor.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h4>Publish the PLM data</h4>
<p>Sender publishes the data using the identificators of PLM Entities ( retrieved 
in the previous step (<a href="#Retrieve">Retrieve</a>). In this use case we use 
the <code>PublishExchange</code> method in order to realize a complete transfer, 
in other words all expanded PLM Object from the root PLM entites will be transfered 
too. There is another method, <code>PublishExchangeWithoutExpand,</code> enabling 
you to optimize the exchange of data and to gain flexibility [<a href="#References">1</a>].</p>
<pre class="code">...
   CATPLMExchangeChannelServices* pExchangeChannelServices = 
   			     new <strong>CATPLMExchangeChannelServices</strong>();
   if (NULL!=pExchangeChannelServices)
   {
      ...
      CATListPtrCATIAdpPLMIdentificator partRefIdsList;
      ...
      CATTime idate;
      CATUnicodeString dateTest = <strong>dateString</strong>;
      if (<strong>dateTest</strong>==&quot;YES&quot;)
         <strong>idate </strong>= CATTime::GetCurrentLocalTime();
      else
         idate.SetDate(0, 0, 0);
      CATBoolean itransferOwnership = FALSE;
      CATUnicodeString transferTest = <strong>transfer</strong>;
      if (<strong>transferTest</strong>==&quot;TRUE&quot;)
         <strong>itransferOwnership </strong>= TRUE;
      HRESULT Rc = pExchangeChannelServices-&gt;<strong>PublishExchange</strong>
            (<strong>ichannelID</strong>, ipartRefIdsList, idate,<strong>itransferOwnership</strong> , ibriefcaseFilePath);
      ...
   }
...</pre>
<p>The <code><strong>PublishExchange</strong></code> takes five arguments:</p>
<ul>
	<li><code>ichannelID</code>, CATString type, the PLM Channel identification 
	where data is to be published. This <strong>channel identificator</strong> is 
	read from the text file comes either from Initializing PLM Channel[<a href="#References">2</a>] 
	use case or Finalizing PLM Channel[<a href="#References">3</a>] use case (depending 
	on whether Sender has initialized or finalized the PLM Channel).</li>
	<li><code>ipartRefIdsList</code>, CATListPtrCATIAdpPLMIdentificator type, list 
	of PLM Components identificators to be exchanged with the other site.
	<strong>partRefIdsList</strong> can only contain reference and representation 
	reference. For a Reference, the complete structure is sent too.</li>
	<li><code>idate</code>, CATTime type, parameter to filter data in order to reduce 
	the size of the exchange.</li>
	<li><code>itransferOwnership</code>, CATBoolean type, allows to transfer or 
	not the site ownership of the published data (if set TRUE, allow the site ownership 
	transfer).</li>
	<li><code>ibriefcaseFilePath</code>, CATUnicodeString type, the path of the 
	file where the PLM Briefcase file is to be generated.</li>
</ul>
<p>The <code><strong>CATPLMExchangeChannelServices::PublishExchange</strong></code> 
API generates a PLMBriefcase file which contains the data to be exchanged with the 
other site. Sender sends this briefcase file (through email, ftp etc) to the Receiver. 
Receiver further process the data exchange by synchronizing the data at its end.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Epilog"></a>Epilog</h3>
<p>The <code><strong>CAASrmPublishExchangeThroughChannel</strong></code> use case 
ends by simply closing the PLM session. Since all use cases necessarily conclude 
by closing the PLM session, we have a dedicated article on this topic namely &quot;Creating 
a Basic PLM Batch&quot; [<a href="#References">8</a>]. </p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="InShort"></a>In Short</h2>
<p>The use case illustrates how to publish a PLM Entity to generate a PLMBriefcase 
to initiate data exchange through the PLM Channel. The Publish operation also gives 
the option of transferring the site ownership of the entire published data to the 
other site. The PLM Briefcase is sent ( through email, ftp etc) to the receiver 
site. Receiver processes this briefcase file and synchronize the data at its side 
[<a href="#References">5</a>]. </p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="References"></a>References</h2>
<table class="reference">
	<tr>
	</tr>
	<tr>
		<td>[1]</td>
		<td><a href="CAASrmTaSupplyChain.htm">Exchanging Data Using PLM Channel</a></td>
	</tr>
	<tr>
		<td>[2]</td>
		<td><a href="CAASrmUcInitializeChannelCreation.htm">Initializing a PLM Channel</a></td>
	</tr>
	<tr>
		<td>[3]</td>
		<td><a href="CAASrmUcFinalizeChannelCreation.htm">Finalizing a PLM Channel</a></td>
	</tr>
	<tr>
		<td>[4]</td>
		<td><a href="CAASrmUcAcknowledgeChannelCreation.htm">Acknowledging the PLM 
		Channel Creation</a></td>
	</tr>
	<tr>
		<td>[5]</td>
		<td><a href="CAASrmUcSynchronizeExchangeThroughChannel.htm">Synchronizing 
		a PLM Channel</a></td>
	</tr>
	<tr>
		<td>[6]</td>
		<td><a href="CAASrmUcAcknowledgeExchangeThroughChannel.htm">Acknowledging 
		Data Exchange through a PLM Channel</a></td>
	</tr>
	<tr>
		<td>[7]</td>
		<td>
		<a href="../CAADocUseCases/CAADocRunSample.htm">
		Building and Launching a Use Case</a></td>
	</tr>
	<tr>
		<td>[8]</td>
		<td>
		<a href="../CAAPlmServerAccess/CAAAdpUcBasicBatch.htm">
		Creating a Basic PLM Batch</a></td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="History"></a>History</h2>
<table class="history">
	<tr>
		<td>Version: <strong>1</strong> [July 2008]</td>
		<td>Document created</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
