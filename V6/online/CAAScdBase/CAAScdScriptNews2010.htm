<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
<meta http-equiv="Content-Language" content="en-us" />
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta name="devlang" content="idl" />
<link rel="stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css"/>
<script type="text/javascript" src="../CAADocJavaScript/DSDocTocToc.js">/* */</script>
<script type="text/javascript" src="../CAADocJavaScript/DSDocHighlight.js">/* */</script>
<script type="text/javascript" src="../CAADocJavaScript/submit.js">/* */</script>
<title>What&#39;s New with V6R2010 Automation</title>
</head>

<body onload="highlightSearchTerms();">

<table class="DocHeader">
	<tbody>
	<tr>
		<td class="DocHeader1">
		<h1><a name="Top"></a>What's New with V6R2010 Automation</h1>
		</td>
	</tr>
	<tr>
		<td class="tech">Technical Article</td>
	</tr>
</tbody>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table class="abstract">
	<tbody>
	<tr>
		<td>
		<h2>Abstract</h2>
		<p>This article presents Automation objects, methods, and properties that 
		are added since V6R2009x GA to enhance V6 Automation capabilities, support 
		functional evolutions, and correct defects. Some of those modifications 
		may already exist in V6R2009x maintenance fixes. A few properties and methods 
		might have been modified or removed. VB and VBScripts code using those methods 
		may have to be modified. VB projects using the corresponding objects must 
		be recompiled.</p>
		<p>Consult
		<a href="../CAAScdInfInfrastructure/CAAInfHints.htm">About Automation Languages, Debug, and Compatibility</a>
	 for details on manual adjustments 
		that may be required for existing VB/VBA and VSTA projects to be usable 
		on a new release.</p>
		<ul>
			<li><a href="#NewObject">New Objects</a></li>
			<li><a href="#NewMethod">New Methods</a></li>
			<li><a href="#NewEnum">New Enums</a></li>
			<li><a href="#NewProperty">New Properties</a></li>
			<li><a href="#Modif">Modified Methods and Properties</a></li>
			<li><a href="#Suppress">Removed Objects, Collections, Methods and Properties</a></li>
		</ul>
		<p>Deprecated APIs can be found in
		<a href="#" onclick="javascript:CAAlink('IDL', 'Deprecated');return false;">
		V6 IDL API Deprecated Index</a>.</p>
		</td>
	</tr>
	<tr>
		<td>
		<p>You can also find news from previous V6 releases:</p>
		<ul>
			<li><a href="CAAScdScriptNews2009x.htm">V6R2009x What's New?</a></li>
		</ul>
		</td>
	</tr>
</tbody>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table>
	<tbody>
	<tr>
		<th colspan="2"><a name="NewObject"></a>New Objects</th>
	</tr>
</tbody>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table>
	<tbody>
	<tr>
		<th colspan="2"><a name="NewMethod"></a>New Methods</th>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'CATTPSIDLItf', 'interface', 'Capture', 'DisplayCapture2');return false;">
		Capture::DisplayCapture2</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DraftingIDLItf','interface', 'DrawingGenService', 'CheckViewLinkIntegrity');return false;">
		DrawingGenService::CheckViewLinkIntegrity</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DraftingIDLItf','interface', 'DrawingGenView', 'AddLink');return false;">
		DrawingGenView::AddLink</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DraftingIDLItf','interface', 'DrawingGenView', 'GetLink');return false;">
		DrawingGenView::GetLink</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DraftingIDLItf','interface', 'DrawingGenView', 'GetNumberOfInfoForLink');return false;">
		DrawingGenView::GetNumberOfInfoForLink</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DraftingIDLItf','interface', 'DrawingGenView', 'PutLinks');return false;">
		DrawingGenView::PutLinks</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DraftingIDLItf','interface', 'DrawingGenView','RemoveLink');return false;">
		DrawingGenView::RemoveLink</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'CATGSMIDLItf','interface', 'HybridShapeFactory', 'AddNewPointOnCurveAlongDirection');return false;">
		HybridShapeFactory::AddNewPointOnCurveAlongDirection</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'CATGSMIDLItf','interface', 'HybridShapeFactory', 'AddNewPointOnCurveWithReferenceAlongDirection');return false;">
		HybridShapeFactory::AddNewPointOnCurveWithReferenceAlongDirection</a>
		</td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'CATGSMIDLItf','interface', 'HybridShapeFill', 'RemoveAllConstraints');return false;">
		HybridShapeFill::RemoveAllConstraints</a> </td>
	</tr>
<!--
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DNBD5IInterfaces','interface', 'ImportD5SettingAtt', 'GetImportAnnotationsInfo');return false;">
		ImportD5SettingAtt::GetImportAnnotationsInfo</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DNBD5IInterfaces','interface', 'ImportD5SettingAtt', 'GetImportCoorsysInfo');return false;">
		ImportD5SettingAtt::GetImportCoorsysInfo</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DNBD5IInterfaces','interface', 'ImportD5SettingAtt', 'GetImportPDBCacheExpanded');return false;">
		ImportD5SettingAtt::GetImportPDBCacheExpanded</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DNBD5IInterfaces','interface', 'ImportD5SettingAtt', 'GetImportPDBCacheInfo');return false;">
		ImportD5SettingAtt::GetImportPDBCacheInfo</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DNBD5IInterfaces','interface', 'ImportD5SettingAtt', 'GetImportToolFrmInfo');return false;">
		ImportD5SettingAtt::GetImportToolFrmInfo</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DNBD5IInterfaces','interface', 'ImportD5SettingAtt', 'GetKinCorrectionOptionInfo');return false;">
		ImportD5SettingAtt::GetKinCorrectionOptionInfo</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DNBD5IInterfaces','interface', 'ImportD5SettingAtt', 'SetImportAnnotationsLock');return false;">
		ImportD5SettingAtt::SetImportAnnotationsLock</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DNBD5IInterfaces','interface', 'ImportD5SettingAtt', 'SetImportCoorsysLock');return false;">
		ImportD5SettingAtt::SetImportCoorsysLock</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DNBD5IInterfaces','interface', 'ImportD5SettingAtt', 'SetImportPDBCacheLock');return false;">
		ImportD5SettingAtt::SetImportPDBCacheLock</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DNBD5IInterfaces','interface', 'ImportD5SettingAtt', 'SetImportToolFrmLock');return false;">
		ImportD5SettingAtt::SetImportToolFrmLock</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DNBD5IInterfaces','interface', 'ImportD5SettingAtt', 'SetKinCorrectionOptionLock');return false;">
		ImportD5SettingAtt::SetKinCorrectionOptionLock</a> </td>
	</tr>
-->	
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'InfInterfaces','interface', 'Selection', 'SelectElement');return false;">
		Selection::SelectElement</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'InfInterfaces','interface', 'Selection', 'SelectElementOtherEditor');return false;">
		Selection::SelectElementOtherEditor</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'InfInterfaces', 'interface', 'Selection', 'SelectMultipleElements');return false;">
		Selection::SelectMultipleElements</a> </td>
	</tr>
</tbody>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table>
	<tbody>
	<tr>
		<th colspan="2"><a name="NewEnum"></a>New Enums</th>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'InfInterfaces', 'enum', 'CatScriptCommand');return false;">
		CatScriptCommand</a> </td>
	</tr>
</tbody>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table>
	<tbody>
	<tr>
		<th colspan="2"><a name="NewProperty"></a>New Properties</th>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'CATGSMIDLItf','interface', 'HybridShapeCylinder','SymmetricalExtension');return false;">
		HybridShapeCylinder::SymmetricalExtension</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'CATGSMIDLItf','interface', 'HybridShapeExtrude','SymmetricalExtension');return false;">
		HybridShapeExtrude::SymmetricalExtension</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'CATGSMIDLItf','interface', 'HybridShapePointOnCurve','Direction');return false;">
		HybridShapePointOnCurve::Direction</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'CATGSMIDLItf','interface', 'HybridShapePointOnCurve','OnCurveType');return false;">
		HybridShapePointOnCurve::OnCurveType</a> </td>
	</tr>
<!--
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DNBD5IInterfaces','interface', 'ImportD5SettingAtt','ImportAnnotations');return false;">
		ImportD5SettingAtt::ImportAnnotations</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DNBD5IInterfaces','interface', 'ImportD5SettingAtt','ImportCoorsys');return false;">
		ImportD5SettingAtt::ImportCoorsys</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DNBD5IInterfaces','interface', 'ImportD5SettingAtt','ImportPDBCache');return false;">
		ImportD5SettingAtt::ImportPDBCache</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DNBD5IInterfaces','interface', 'ImportD5SettingAtt','ImportToolFrm');return false;">
		ImportD5SettingAtt::ImportToolFrm</a> </td>
	</tr>
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'DNBD5IInterfaces','interface', 'ImportD5SettingAtt','KinCorrectionOption');return false;">
		ImportD5SettingAtt::KinCorrectionOption</a> </td>
	</tr>
-->
	<tr>
		<td>
		<a href="#" onclick="javascript:CAAlink('IDL', 'ProductStructureClientIDLItf','interface', 'VPMRepReference','Father');return false;">
		VPMRepReference::Father</a> </td>
	</tr>
</tbody>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table class="border1">
	<tbody>
	<tr>
		<th colspan="2"><a name="Modif"></a>Modified Methods and Properties</th>
	</tr>
	<tr>
		<td>Application::ScriptCommand (Property Read/Write)</td>
		<td>Return type has been changed from type <code>long</code> to enum
		<code>CatScriptCommand</code>.</td>
	</tr>
	<tr>
		<td>Application::CreateSendTo</td>
		<td>Method was useless and didn&#8217;t work so has been removed.</td>
	</tr>
	<tr>
		<td>LicenseSettingAtt::DemoMode, LicenseSettingAtt::GetDemoModeInfo, CATIALicenseSettingAtt::DemoMode, 
		CATIALicenseSettingAtt::SetDemoModeLock</td>
		<td>Those methods were related to a non existing setting, so were not working 
		and have been removed.</td>
	</tr>
	<tr>
		<td>Relations::Optimizations (Property Read Only).</td>
		<td>Replaced by KnowledgeObject::GetKnowledgeRootSet method.</td>
	</tr>
	<tr>
		<td>DrawingGenView::GetViewLinks and DraignGenView::SetViewLinks.</td>
		<td>See chapter below on <a href="#DrawingLinks">Setting and Retrieving 
		Generative Drawing Source Objects</a>.</td>
	</tr>
</tbody>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table class="border1">
	<tbody>
	<tr>
		<th colspan="2"><a name="Suppress"></a>Removed Objects, Collections, Methods, 
		and Properties </th>
	</tr>
	<tr>
		<td>ConstraintSatisfaction, FreeParameter, FreeParameters, OptimizationConstraint, 
		OptimizationConstraints, Optimization, Optimizations </td>
		<td>Those objects have been moved from the KnowledgeIDLItf Object library 
		into the OptimizationIDLItf object library. No impact on vbscript code. 
		Existing VBA projects may require to add the reference on this object library.</td>
	</tr>
</tbody>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="DrawingLinks"></a>
Setting And Retrieving Generative Drawing Source Objects</h3>
<p>In V6R2009x, only links from a DrawingGenView object on its source VPMRepInstance 
objects are accessible through VB APIs:</p>
<table style="border">
	<tbody>
	<tr>
		<td>
		<pre>
nbLinks = myView.DrawingGenView.NumberOfLinks
Dim mylistOfViewLinks (0) as CATSafeArrayVariant
ReDim mylistOfViewLinks (nbLinks - 1) 
myView.DrawingGenView.GetViewLinks mylistOfViewLinks
</pre>
		</td>
	</tr>
</tbody>
</table>
<p>In V6R2010, an evolution alows to retrieve links on <code>PartBody</code> Objects. 
In this case 3 objects must be used to solve the link because a link to a <code>
PartBody</code> Object is defined from 3 elements:</p>
<ul>
	<li>a <code>Body</code> object, that represents the Part Body</li>
	<li>a <code>VPMRepInstance</code> Object, that represents the Representation 
	Instance</li>
	<li>a <code>PLMOccurrence</code> Object, that represents the PLM Occurence.
	</li>
</ul>
<table style="border">
	<tbody>
	<tr>
		<td>
		<pre>
<span class="comment">' Find the dimension of the myListOfViewLinks</span>
nbLinks = myView.DrawingGenView.NumberOfLinks
NbInfoTot = 0
<span class="keyword">For</span> indice1 = 1  <span class="keyword">To</span> nbLinks
    NbInfo2  = myView.DrawingGenView.GetNumberOfInfoForLink (indice1) 
    NbInfoTot = NbInfoTot+NbInfo2
<span class="keyword">Next</span>
<span class="comment">'</span>
<span class="keyword">Redim</span> mylistOfViewLinks (NbInfoTot-1 )

<span class="comment">'Retrieve all the links</span> 
Index=0
<span class="keyword">For</span> numlnk = 1 <span class="keyword">To</span> nblinks
     nbInfoLinks = myView.DrawingGenView.GetNumberOfInfoForLink(numlnk)
     <span class="keyword">For</span> numInfolnk = 1 <span class="keyword">To</span> nbInfoLinks
        <span class="keyword">Redim</span> myViewLinkTmp (numInfolnk-1 )
        <span class="keyword">Set</span> myListOfViewLinks = myView.DrawingGenView.GetLink(numInfoLinks,myViewLnkTmp)
     <span class="keyword">Next</span>
     <span class="keyword">For</span> indice = 1 <span class="keyword">To</span> nbInfoLinks
        <span class="keyword">Set</span> mylistOfViewLinks (index) = myViewLnkTmp(indice-1)
        index=index+1
     <span class="keyword">Next</span>    
<span class="keyword">Next</span>
</pre>
		</td>
	</tr>
</tbody>
</table>
<p>The same way, the <code>SetViewLinks</code> method has been replaced by the
<code>putlinks</code> methods. For example, if there is only one link on a VPM Rep 
Instance you can replace the existing V6R2009x code macro</p>
<table style="border">
	<tbody>
	<tr>
		<td>
		<pre>
<span class="keyword">Dim</span> mylistOfViewLinks (0) <span class="keyword">As</span> CATSafeArrayVariant
                <span class="keyword">Set</span> mylistOfViewLinks (0)  = &#8230; 
myView.DrawingGenView. SetViewLinks mylistOfViewLinks
</pre>
		</td>
	</tr>
</tbody>
</table>
<p>By the following code in V6R2010</p>
<table style="border">
	<tbody>
	<tr>
		<td>
		<pre>
<span class="keyword">Dim</span> mylistOfViewLinks (0) <span class="keyword">As</span> CATSafeArrayVariant
                <span class="keyword">Set</span> mylistOfViewLinks (0)  = &#8230; 
Nblinks = 1
myView.DrawingGenView.PutLinks mylistOfViewLinks Nblinks, mylistOfViewLinks
</pre>
		</td>
	</tr>
</tbody>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
