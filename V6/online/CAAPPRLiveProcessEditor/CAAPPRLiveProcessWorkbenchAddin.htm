<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="en-us" http-equiv="Content-Language" />
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
<link href="../CAADocStyleSheets/caav5.css" rel="stylesheet" type="text/css"/>
<script src="../CAADocJavaScript/DSDocTocToc.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/DSDocHighlight.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/submit.js" type="text/javascript">/* */</script>
<title>Customize the Manufactured Item Definition App Toolbars</title>
</head>

<body onload="highlightSearchTerms();">

<table class="DocHeader">
	<tr>
		<td class="DocHeader1">
		<h1><a name="Top"></a>Customize the Manufactured Item Definition App bars</h1>
		</td>
	</tr>
	<tr>
		<td class="use">Use Case</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table class="abstract">
	<tr>
		<td>
		<h2>Abstract</h2>
		<p>This article discusses the CAAPPRLiveProcessWorkbenchAddin use case. 
		It explains how to implement the CATIPPRLiveProcessWkbAddin to customize 
		Manufactured Item Definition App bars.</p>
		<ul>
			<li><a href="#Learn">What You Will Learn With This Use Case</a></li>
			<li><a href="#UseCase">The CAAPPRLiveProcessWorkbenchAddin Use Case</a>
				<ul>
					<li><a href="#What">What Does CAAPPRLiveProcessWorkbenchAddin 
						Do</a></li>
					<li><a href="#How">How to Launch CAAPPRLiveProcessWorkbenchAddin</a></li>
					<li><a href="#Where">Where to Find the CAAPPRLiveProcessWorkbenchAddin 
						Code</a></li>
				</ul>
			</li>
			<li><a href="#Step">Step-by-Step</a></li>
			<li><a href="#InShort">In Short</a></li>
			<li><a href="#References">References</a></li>
		</ul>
		</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Learn"></a>What You Will Learn With This Use Case</h2>
<p>This use case is intended to help you to create your own bars in the Manufactured Item Definition App with command headers launching different manufactured item definition 
functionalities.</p>
<ul>
	<li>Describing the different steps dedicated to the knowhow of the company through 
		the customization.</li>
	<li>Implementing the methods of CATIPPRLiveProcessWkbAddin to create toolbars 
		in the Manufactured Item Definition App.</li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="UseCase"></a>The CAAPPRLiveProcessWorkbenchAddin Use Case</h2>
<p>CAAPPRLiveProcessWorkbenchAddin is a use case of the CAADELPPRLiveProcessItf.edu 
framework that illustrates Manufactured Item Definition Appcustomization capabilities.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="What"></a>What Does CAAPPRLiveProcessWorkbenchAddin Do</h3>
<p>This use case illustrate adds a new bar in the Manufactured Item Definition App</p>
<ul>
	<li>Add a bar in the Manufactured Item Definition App.</li>
	<li>Create commands headers that will launch Manufactured Item Definition App functionality.</li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="How"></a>How to Launch CAAPPRLiveProcessWorkbenchAddin</h3>
<p>To use CAAPPRLiveProcessWorkbenchAddin, you will need to:</p>
<ul>
	<li>Set up the <strong>build time</strong> environment, then compile CAAPPRLiveProcessWorkbenchAddin.m 
		module along with its prerequisites [<a href="#References">1</a>].</li>
	<li>Edit the interface dictionary, that is, the CAADELPPRLiveProcessItf.edu.dico 
		file located in:
		<p><code>InstallRootFolder\CAADoc\CAADELPPRLiveProcessItf.edu\CNext\code\dictionary\</code></p>
		<p>where <code>InstallRootFolder</code> [<a href="#References">1</a>] is 
		the folder where the API CD-ROM is installed, and decomment the following 
		line by removing the '#CAA#' character:</p>
		<pre>CAAPPRLiveProcessWorkbenchAddinExt CATIPPRLiveProcessWkbAddin libCAAPPRLiveProcessWorkbenchAddin</pre>
	</li>
	<li>Set up the <strong>run time</strong> environment.</li>
	<li>Launch a CATIA V6 session.</li>
	<li>Go to the Manufactured Item Definition App.</li>
	<li>Look for the &quot;CAA Manufactured Item Definition AppAddin Toolbar&quot; 
		Toolbar (if this toolbar is not visible, make it visible from the list that 
		is displayed when right clicking any toolbar).</li>
	<li>Select the first icon in the toolbar, that will launch a command on the 
		system.</li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Where"></a>Where to Find the CAAPPRLiveProcessWorkbenchAddin Code</h3>
<p>The CAAPPRLiveProcessWorkbenchAddin use case code is located in the CAAPPRLiveProcessWorkbenchAddin.m 
module of the CAADELPPRLiveProcessItf.edu framework:</p>
<p><code>InstallRootFolder\CAADoc\CAADELPPRLiveProcessItf.edu\CAAPPRLiveProcessWorkbenchAddin.m</code></p>
<p>where <code>InstallRootFolder</code> [<a href="#References">1</a>] is the folder 
where the API CD-ROM is installed.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Step"></a>Step-by-Step</h2>
<p>The class CAAPPRLiveProcessWorkbenchAddin, implements the Interface CATIPPRLiveProcessWkbAddin, 
this implementation is located on the file CAAPPRLiveProcessWorkbenchAddin.m\src\CAAPPRLiveProcessWorkbenchAddin.cpp, 
Its purpose is to create the toolbar and to layout the commands on it. Only two 
methods need be defined: <code><a href="#CreateToolbars">CreateToolbars</a></code> 
and <a href="#CreateCommands"><code>CreateCommands</code></a>.</p>
<p>Here is the declaration of this class:</p>
<pre class="code">class CAAPPRLiveProcessWorkbenchAddin: public CATBaseUnknown {
  CATDeclareClass;
  public:
    // Standard constructors and destructors for an implementation class
    // -----------------------------------------------------------------
    CAAPPRLiveProcessWorkbenchAddin();
    virtual ~CAAPPRLiveProcessWorkbenchAddin();
    void <strong>CreateCommands</strong>();
    CATCmdContainer *<strong>CreateToolbars</strong>();
  private:
    // The copy constructor and the equal operator must not be implemented
    // -------------------------------------------------------------------
    CAAPPRLiveProcessWorkbenchAddin (CAAPPRLiveProcessWorkbenchAddin &amp;);
    CAAPPRLiveProcessWorkbenchAddin&amp; operator=(CAAPPRLiveProcessWorkbenchAddin &amp;);
    static CATCmdContainer* _pCreatedToolbar;
};</pre>
<p>There are two logical steps in CAAPPRLiveProcessWorkbenchAddin:</p>
<ol>
	<li><a href="#Step1">Creating the Command Headers to Launch Manufactured Item Definition Editor 
		Functionalities</a></li>
	<li><a href="#Step2">Adding a Manufactured Item Definition Editor Toolbar</a></li>
</ol>
<p>We now comment each of those sections by looking at the code.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step1"></a>Creating the Command Headers to Launch Manufactured Item Definition App 
Functionalities</h3>
<p>The command that is going to be called when the toolbar button is clicked is 
is created on the method: CAAPPRLiveProcessWorkbenchAddin::CreateCommands.</p>
<pre class="code">void <a name="CreateCommands"></a><strong>CAAPPRLiveProcessWorkbenchAddin::CreateCommands</strong>()
{
  CAAPPRLiveProcessWorkbenchAddinTRACE(&quot;&gt;&gt;CAAPPRLiveProcessWorkbenchAddin::CreateCommands()&quot;);
  // Instantiates the command header for the command
  <strong>CATAfrCommandHeader::CATCreateCommandHeader(&quot;CAAPPRLiveProcessWorkbenchAddinCmd1&quot;,
                                             &quot;CAAPPRLiveProcessWorkbenchAddin&quot;,
                                             &quot;CAAPPRLiveProcessWorkbenchAddinCmd&quot;,
                                             (void *)NULL,
                                             &quot;CAAPPRLiveProcessWorkbenchAddinHeader&quot;,
                                             CATFrmAvailable);</strong>
  CAAPPRLiveProcessWorkbenchAddinTRACE(&quot;&lt;&lt;CAAPPRLiveProcessWorkbenchAddin::CreateCommands()&quot;);
}</pre>
<p>Here a command named <strong>CAAPPRLiveProcessWorkbenchAddinCmd1</strong> is 
created, this comand is going to be tied with the tool bar button, as explained 
on the next section. It is located in the <strong>CAAPPRLiveProcessWorkbenchAddin</strong> 
shared library and its associated class is <strong>CAAPPRLiveProcessWorkbenchAddinCmd</strong>. 
The base name for resource files for this command will be <strong>CAAPPRLiveProcessWorkbenchAddinHeader</strong> 
as explained later.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h4><a name="Step2"></a>Adding a Manufactured Item Definition Editor Toolbar</h4>
<p>The visual part of the toolbar (The Toolbar itself and the button to access the 
command <strong>CAAPPRLiveProcessWorkbenchAddinCmd1</strong> created previously) 
is created on the implementation of the method: <strong>CAAPPRLiveProcessWorkbenchAddin::CreateToolbars</strong>.</p>
<pre class="code">CATCmdContainer *<a name="CreateToolbars"></a><strong>CAAPPRLiveProcessWorkbenchAddin::CreateToolbars</strong>()
{
  CAAPPRLiveProcessWorkbenchAddinTRACE(&quot;&gt;&gt; CAAPPRLiveProcessWorkbenchAddin::CreateToolbars()&quot;);
  // Verify if tool bar has not been created already
  if (_pCreatedToolbar==NULL)
  {
    // create the tool bar called: CAAPPRLiveProcessWorkbenchAddinToolbar
    NewAccess (CATCmdContainer,pToolBarPPRLiveProcess,CAAPPRLiveProcessWorkbenchAddinToolbar);

    // create the command starter called CAAPPRLiveProcessWorkbenchAddinStarter
    NewAccess (CATCmdStarter,pCommandStarter,CAAPPRLiveProcessWorkbenchAddinStarter);

    // tell to the system that the starter we have just created start the command called CAAPPRLiveProcessWorkbenchAddinCmd1
    SetAccessCommand (pCommandStarter,&quot;CAAPPRLiveProcessWorkbenchAddinCmd1&quot;);

    // adding the command starter as a child of the new created toolbar
    SetAccessChild (pToolBarPPRLiveProcess,pCommandStarter);

    // add the tool bar,
    // the tool bar is by default Visible and on the Top side
    int visibleFlag = 1;
    AddToolbarView (pToolBarPPRLiveProcess,visibleFlag,Top);
    CAAPPRLiveProcessWorkbenchAddinTRACE(&quot;&lt;&lt; CAAPPRLiveProcessWorkbenchAddin::CreateToolbars()&quot;)

    _pCreatedToolbar = pToolBarPPRLiveProcess;
    return pToolBarPPRLiveProcess;
  }
  else
  { 
    // in case it was already created (this function was already called) return NULL,
    // that avoids the creation of the toolbar two times
    return NULL;
   }
}</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h4>User Interface</h4>
<p>There are two visible objects: the toolbar container and its command.</p>
<p>The ToolBar Container</p>
<p>The title of the toolbar named CAAPPRLiveProcessWorkbenchAddinToolbar is defined 
on the file <code>DELPPRLiveProcessWorkbenchAddinAdapter.CATNls</code> which can 
be found in <code><em>install_root</em>/CAADELPPRLiveProcessItf.edu/CNext/resources/msgcatalog</code> 
directory. The name of this file is predertermined ans it should be used as it is. 
All the custom tool bars that you will define should define its names on this file, 
following the same format:<br />
</p>
<pre class="code"> NAME_OF_THE_TOOLBAR.Title = &quot;Localized Title Text&quot;;
On this example the title is defined as follows: 

CAAPPRLiveProcessWorkbenchAddinToolbar.Title = &quot;CAA Manufactured Item Definition AppAddin Toolbar&quot;;</pre>
<p><strong>Note</strong>: The NAME_OF_THE_TOOLBAR part is on this case replaced 
by: &quot;CAAPPRLiveProcessWorkbenchAddinToolbar&quot; This is the name given to 
the toolbar when creating its container using the NewAccess macro, on the CreateToolbars 
function.</p>
<p>The Commands</p>
<p>CAAPPRLiveProcessWorkbenchAddinCmd1 resources are defined by three files:</p>
<ol>
	<li><code>CAAPPRLiveProcessWorkbenchAddinHeader.CATNls</code> (located in the
		<code>InstallRootFolder\CAADoc\CAADELPPRLiveProcessItf.edu\CNext\resources\msgcatalog</code> 
		folder):
		<pre class="code">CAAPPRLiveProcessWorkbenchAddinHeader.CAAFldUIFolderWorkbenchAddinCmd1.Title = &quot;Example LPE Command&quot;;
CAAPPRLiveProcessWorkbenchAddinHeader.CAAFldUIFolderWorkbenchAddinCmd1.Help = &quot;Example LPE Command detailed help&quot;;
CAAPPRLiveProcessWorkbenchAddinHeader.CAAFldUIFolderWorkbenchAddinCmd1.ShortHelp = &quot;Example LPE Command short help&quot;;</pre>
		<p>These texts correspond to the screen tip, the documentation line and 
		the command prompt input.</p>
		<p><strong>Note</strong>: The name &quot;CAAPPRLiveProcessWorkbenchAddinHeader&quot; 
		is the name given when calling CATAfrCommandHeader::CATCreateCommandHeader 
		function.</p>
	</li>
	<li>
		<p><code>CAAPPRLiveProcessWorkbenchAddinHeader.CATRsc</code> (located in 
		the <code>InstallRootFolder\CAADoc\CAADELPPRLiveProcessItf.edu\CNext\resources\msgcatalog</code> 
		directory) defines the bitmap name for the command icon:</p>
		<pre class="code">CAAPPRLiveProcessWorkbenchAddinHeader.CAAPPRLiveProcessWorkbenchAddinCmd1.Icon.Normal=&quot;CAAPPRLiveProcessWorkbenchAddin_I&quot;;</pre>
	</li>
	<li><code>CAAPPRLiveProcessWorkbenchAddin_I.png</code> (located in the <code>
		InstallRootFolder\CAADoc\CAADELPPRLiveProcessItf.edu\CNext\resources\graphic\icons\normal</code> 
		folder) contains the bitmap the command icon.</li>
</ol>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="InShort"></a>In Short</h2>
<p>This article provides an example on how to use the CATIPPRLiveProcessWkbAddin 
interface to add a Manufactured Item Definition Toolbar.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="References"></a>References</h2>
<table class="reference">
	<tr>
		<td>[1]</td>
		<td>
		<a href="../CAADocUseCases/CAADocRunSample.htm">
		Building and Launching a Use Case</a></td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="History"></a>History</h2>
<table class="history">
	<tr>
		<td>Version: <strong>1</strong> [Apr 2010]</td>
		<td>Document created</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
