<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="en-us" http-equiv="Content-Language" />
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
<link href="../CAADocStyleSheets/caav5.css" rel="stylesheet" type="text/css"/>
<script src="../CAADocJavaScript/DSDocTocToc.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/DSDocHighlight.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/submit.js" type="text/javascript">/* */</script>
<title>Get Where Used</title>
</head>

<body onload="highlightSearchTerms();">

<table class="DocHeader">
	<tr>
		<td class="DocHeader1">
		<h1><a name="Top"></a>Get Where Used</h1>
		</td>
	</tr>
	<tr>
		<td class="use">Use Case</td>
	</tr>
</table>
<table class="abstract">
	<tr>
		<td>
		<h2>Abstract</h2>
		<p>This Use Case demonstrates the use of GetWhereUsed API to retrieve all 
		the Parent PLM Product Reference from the database, being given the child 
		Product Reference ( or Product representation Reference).</p>
		<ul>
			<li><a href="#Learn">What You Will Learn With This Use Case</a></li>
			<li><a href="#UseCase">The CAAPstCountProductRef Use Case</a>
				<ul>
					<li><a href="#What">What Does CAAPstCountProductRef Do</a></li>
					<li><a href="#How">How to Launch CAAPstCountProductRef</a></li>
					<li><a href="#Where">Where to Find the CAAPstCountProductRef 
						Code</a></li>
				</ul>
			</li>
			<li><a href="#Step">Step-by-Step</a></li>
			<li><a href="#InShort">In Short</a></li>
			<li><a href="#References">References</a></li>
		</ul>
		</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Learn"></a>What You Will Learn With This Use Case</h2>
<p>The user learns how to retrieve all the Product Structure Objects under which 
the the provided/selected Object (Product /Product Representation Reference) has 
been instantiated, using the <code>CATPLMPrdProductReferenceServices::GetWhereUsed</code> 
API.</p>
<p>Some of the points to be kept in mind when using this API are:</p>
<ul>
	<li>Only those Parent References will be retrieved, that satisfy the following 
		conditions:
		<ul>
			<li>The Parent Reference is an existing database object.</li>
			<li>It can be read under the current connection conditions (read security 
				process granted).</li>
		</ul>
	</li>
	<li>The returned Product Reference list, must be provided as an empty List on 
		the input.</li>
	<li>The Identificators returned in the list, have to be each released by the 
		caller of the API.</li>
</ul>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="UseCase"></a>The CAAPstCountProductRef Use Case</h2>
<p>CAAPstCountProductRef is a use case of the CAAProductStructure.edu framework 
that illustrates ProductStructureAccess framework capabilities.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="What"></a>What Does CAAPstCountProductRef Do</h3>
<p>To begin with, it creates the Product Tree depicted in <a href="#Fig1">Fig.1</a> 
below.</p>
<table>
	<caption><a name="Fig1">Fig. 1</a> Product Tree</caption>
	<tr>
		<td><img alt="Product Tree" src="images/CAAPstGetWhereUsed.jpg"/></td>
	</tr>
</table>
<p>It then gets the Identificator[<a href="#References">1</a>] of the Product on 
which the GetWhereUsed API has to be called ie- the 'Child' Product. Then we call 
GetWhereUsed API to retrieve all the Products under which the 'Child' Product has 
been instantiated ie - the 'Parent' Products.</p>
<p>The API should return S_OK and the list of 'Parent' Identificators. Since, in 
this case we are giving an Input Identificator with 2 parents, the API call should 
be successful and should return S_OK with 2 Parent Identificators ie - Identificators 
of Parent1 and Parent2.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="How"></a>How to Launch CAAPstCountProductRef</h3>
<p>To launch CAAPstCountProductRef, you will need to set up the build time environment, 
then compile CAAPstCountProductRef along with its prerequisites, set up the run 
time environment, and then execute the use case [<a href="#References">2</a>].</p>
<p>To launch the use case execute the command:</p>
<p><code>mkrun -c "CAAPstGetWhereUsed Repository Server User Password SecurityCtx &quot;</code></p>
<p>where:</p>
<table class="fill">
	<tr>
		<th>Repository</th>
		<td>
		<script type="text/javascript">insertRepository();</script>
		</td>
	</tr>
	<tr>
		<th>Server</th>
		<td>The server as ServerName:ServerPort/rootURI</td>
	</tr>
	<tr>
		<th>User</th>
		<td>The user name</td>
	</tr>
	<tr>
		<th>Password</th>
		<td>The user password to authenticate the user</td>
	</tr>
	<tr>
		<th>SecurityCtx</th>
		<td>A string representing the security context (Role.Organization.Project). 
		Choose Role as Designer</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Where"></a>Where to Find the CAAPstCountProductRef Code</h3>
<p>The CAAPstCountProductRef use case is defined at the location:</p>
<p><code>InstallRootFolder\CAADoc\CAAProductStructure.edu\CAAPstGetWhereUsed.m\</code></p>
<p>where <code>InstallRootFolder</code> [<a href="#References">3</a>] is the folder 
where the API CD-ROM is installed.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Step"></a>Step-by-Step</h2>
<ul>
	<li><a href="#Prolog">Prolog</a></li>
	<li><a href="#Step1">Getting the Identificator of the Product</a></li>
	<li><a href="#Step2">Retrieving the Parent PLM Components of the Input Child 
		Component</a></li>
	<li><a href="#Epilog">Epilog</a></li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Prolog"></a>Prolog</h3>
<p>The CAAPstCountProductRef use case begins by creating a session and connecting 
to the Input Repository with an appropriate role (Designer, in this case). The Use 
Case "Connecting to V6 Server" [<a href="#References"> 3</a>] deals with opening 
and closing a PLM Session.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step1"></a>Getting the Identificator of the Product</h3>
<p>We get the Identificator of the Product on which the GetWhereUsed API has to 
be called (Child).</p>
<pre class="code">
 ...
 rc = pProductFactory-&gt;<strong>CreatePrdReference</strong> (spRefType, EmptyListAttr, pChildProd, NULL);
 if ( NULL != pChildProd )
 {
    // Save is mandatory to got a valid CATIAdpPLMIdentificator
   <strong>CATAdpSaver saver</strong>;
   rc = <strong>saver.Save()</strong>;
    // got its PLM Id
    CATIPLMComponent_var spPLMCompOnChild = pChildProd ;
    if ( NULL_var != pChildProd )
    {
       rc = spPLMCompOnChild-&gt;<strong>GetAdpID</strong>(opiPLMIdOfChild);
    }
</pre>
<p>After the child product creation, we got its identifier thanks the <code>GetAdpID</code>
method of <em>CATIPLMComponent</em>. <code>opiPLMIdOfChild</code> is a
<em>CATIAdpPLMIdentificator</em> interface pointer.</p>
<p>But note here an important call : the save. Indeed, the <em>CATIAdpPLMIdentificator</em> 
interface pointer will be valid for a query in DB only if the PLM Component has 
been saved once.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step2"></a>Retrieving the Parent PLM Components of the Input Child 
Component</h3>
<p>Thanks the <em>CATIAdpPLMIdentificator</em> interface pointer on the child and 
the <code>GetWhereUsed</code> method we can get the Product aggregating at least 
one instance of this reference.</p>
<pre class="code">...
  CATLISTP(CATIAdpPLMIdentificator) oPrdUsingReference;
  HRESULT HR = CATPLMPrdProductReferenceServices::GetWhereUsed (*pAdpIDOnInputComp, oPrdUsingReference);
...</pre>
<p>The <code>GetWhereUsed</code> method of the <em>CATPLMPrdProductReferenceServices</em> 
class call takes an Identificator of the Object whose parents are to be retrieved.
<code>pAdpIDOnInputComp</code> is <code>opiPLMIdOfChild</code> retrieved in the 
previous step.</p>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Epilog"></a>Epilog</h3>
<p>The <code>CAAPstCountProductRef</code> use case ends by simply closing the PLM 
session. Since all use cases necessarily conclude by closing the PLM session, we 
have a dedicated article on this topic namely "Connecting to V6 Server" [<a href="#References">3</a>].</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="InShort"></a>In Short</h2>
<p>The Use Case illustrates the retrieval of Parent Product References using the
<code>CATPLMPrdProductReferenceServices::GetWhereUsed</code> API.</p>
<p>The GetWhereUsed API requires a Product Reference or Product Representation Reference 
by its <code>Identificator</code> as an input. It returnsa list of Product 
References under which the input Product Reference is instantiated in the form of 
an Identificator list.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="References"></a>References</h2>
<table class="reference">
	<tr>
		<td>[1]</td>
		<td>
		<a href="../CAAPlmServerAccess/CAAPlmTaCATIAdpPLMIdentificator.htm">
		PLM Component Identifier</a></td>
	</tr>
	<tr>
		<td>[2]</td>
		<td>
		<a href="../CAADocUseCases/CAADocRunSample.htm">
		Building and Launching a Use Case</a></td>
	</tr>
	<tr>
		<td>[3]</td>
		<td>
		<a href="../CAAPlmServerAccess/CAAAdpUcBasicBatch.htm">
		Connecting to V6 Server</a></td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="History"></a>History</h2>
<table class="history">
	<tr>
		<td>Version: <strong>1</strong> [Mar 2008]</td>
		<td>Document created</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
