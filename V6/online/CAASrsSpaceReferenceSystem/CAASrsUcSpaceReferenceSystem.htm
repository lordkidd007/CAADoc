<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<script type="text/javascript" src="../CAADocJavaScript/DSDocHighlight.js"></script>
<script type="text/javascript" src="../CAADocJavaScript/submit.js"></script>
<title>Retrieving and Modifying SRS</title>
</head>

<body onload="highlightSearchTerms();">

<table class="DocHeader">
	<tr>
		<td class="DocHeader1">
		<h1><a name="Top"></a>Retrieving and Modifying SRS</h1>
		</td>
	</tr>
	<tr>
		<td class="use">Use Case</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table class="abstract">
	<tr>
		<td>
		<h2>Abstract</h2>
		<p>This article discusses the CATSrsUseItf use case. This use case 
		explains how to retrieve and modify SRS.</p>
		<ul>
			<li><a href="#Learn">What You Will Learn With This Use Case</a></li>
			<li><a href="#UseCase">The CAASpaceReferenceSystem Use Case</a>
			<ul>
				<li><a href="#What">What Does CAASpaceReferenceSystem Do</a></li>
				<li><a href="#How">How to Launch CAASpaceReferenceSystem</a></li>
				<li><a href="#Where">Where to Find the CAASpaceReferenceSystem 
					Code</a></li>
			</ul>
			</li>
			<li><a href="#Step">Step-by-Step</a></li>
			<li><a href="#InShort">In Short</a></li>
			<li><a href="#history">History</a></li>
		</ul>
		</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Learn"></a>What You Will Learn With This Use Case</h2>
<p>This use case is intended to help you make your first steps in programming with 
CATIA SRS (Space Reference System) Interfaces. Its main intent is to allow you to retrieve and modify SRS.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="UseCase"></a>The CAASpaceReferenceSystem Use Case</h2>
<p>CAASpaceReferenceSystem.m is a use case of the CAASpaceReferenceSystem.edu framework 
that illustrates the CATIA SRS Interfaces framework capabilities.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="What"></a>What Does CAASpaceReferenceSystem Do</h3>
<p>The goal of CAASpaceReferenceSystem use case is to show how to retrieve and modify SRS data.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="How"></a>How to Launch CAASpaceReferenceSystem</h3>
<p>To launch CAASpaceReferenceSystem , you will need to set up the build time 
environment, then compile CAASpaceReferenceSystem along with its prerequisites, 
set up the run time environment, and then execute the sample.</p>
<p>To launch the use case, execute the following command:</p>
<pre class="code"><em>mkrun -c &quot; CAASpaceReferenceSystem Repository Server User Password SecutityCtx PLM_ExternalID &quot;</em></pre>
<p>where:</p>
<table class="border1">
	<tr>
		<th>Repository</th>
		<td>
		<script type="text/javascript">insertRepository();</script>
		</td>
	</tr>
	<tr>
		<th>Server</th>
		<td>The server as <em>Host:port_number/RootURI</em></td>
	</tr>
	<tr>
		<th>User</th>
		<td>The user name.</td>
	</tr>
	<tr>
		<th>Password</th>
		<td>The user password to authenticate the user.</td>
	</tr>
	<tr>
		<th>SecurityCtx</th>
		<td>A string representing the security context (Role.Organization.Project). 
		Choose Role as Designer.</td>
	</tr>
	<tr>
		<th>PLM_ExternalID</th>
		<td>The value of the <code>PLM_ExternalID</code> attribute of the PLM representation 
		reference containing the data to create the user feature reference.</td>
	</tr>
</table>

<p>* The input model is retrieved by importing the <strong>CAASrsUcCGR.3dxml</strong>
    file from the  <strong>CAASpaceReferenceSystem.edu</strong> framework.
</p>
<p>
<code> InstallRootFolder\CAADoc\CAASpaceReferenceSystem.edu\InputData\CAASrsUcCGR.3dxml</code><br>
</p>

<p>where <code>InstallRootFolder</code> [<a href="#References">1</a>] is the folder 
where the API CD-ROM is installed.</p>

<p>This 3D XML file contains the root Product Reference with the
following attributes:</p>

<ul>
  <li><a><code><strong>PLM_ExternalID</strong></code></a>:
    <code>CAASrsUcPart</code></li>
  <li><a><code><strong>Version</strong></code></a>:
    ---</li>
</ul>

<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Where"></a>Where to Find the CAASpaceReferenceSystem Code</h3>
<p>The CAASpaceReferenceSystem sample is made up of a single file located in the CAASpaceReferenceSystem.m module of the CAASpaceReferenceSystem.edu 
framework: <code>InstallRootFolder\CAADoc\CAASpaceReferenceSystem.edu\CAASpaceReferenceSystem.m\</code></p>
<p>where <code>InstallRootFolder</code> [<a href="#References">1</a>] is the folder 
where the API CD-ROM is installed.</p>
<p>This sample deals with the following classes:</p>
<table>
	<tr>
		<td><em>CATPLMSessionServices</em></td>
		<td>  Class to create and delete a batch session.</td>
	</tr>
	<tr>
		<td><em>CATAdpDictionaryServices</em></td>
		<td>  Class to provide all basic functions to browse and navigate on PLM dictionaries.</td>
	</tr>
	<tr>
		<td><em>CATAdpQueryServices</em></td>
		<td>  Class to manage queries on PLM component in database.</td>
	</tr>
	<tr>
		<td><em>CATAdpOpenSaveServices</em></td>
		<td>  Class to manage Open and Save in session.</td>
	</tr>
	<tr>
		<td><em>CATISrsUsePart</em></td>
		<td>  Interface dedicated to the SRS part.</td>
	</tr>
	<tr>
		<td><em>CATISrsUseGridSet</em></td>
		<td>  Interface dedicated to grid set.</td>
	</tr>
	<tr>
		<td><em>CATISrsUseGridFace</em></td>
		<td>  Interface dedicated to grid face present in the grid set of SRS part.</td>
	</tr>
	<tr>
		<td><em>CATISrsUseCategoryMngt</em></td>
		<td>  Interface for set/get category of a grid face.</td>
	</tr>
	<tr>
		<td><em>CATISrsUseCentreLine</em></td>
		<td>  Interface dedicated to get reference plane of the centreline.</td>
	</tr>
	<tr>
		<td><em>CATISrsUseMidShip</em></td>
		<td>  Interface dedicated to the MidShip plane of the SRS part.</td>
	</tr>
	<tr>
		<td>&nbsp;</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Step"></a>Step-by-Step</h2>
<p>We will now first comment the environment and it&#8217;s components creation 
by looking at the code of the Main. There are 17 logical steps in Main:</p>
<table>
	<tr>
		<th>#</th>
		<th>Step</th>
	</tr>
	<tr>
		<td>1</td>
		<td><a href="#Step1">Checking the Input Data</a></td>
	</tr>
	<tr>
		<td>2</td>
		<td><a href="#Step2">Setting the Connection Parameters</a></td>
	</tr>
	<tr>
		<td>3</td>
		<td><a href="#Step3">Creating a Session</a></td>
	</tr>
	<tr>
		<td>4</td>
		<td><a href="#Step6">Retrieving the Customized Reference of the Product 
		Modeler</a></td>
	</tr>
	<tr>
		<td>5</td>
		<td><a href="#Step7">Opening the &quot;CAASrsUcPart&quot; Model (arg[6])</a></td>
	</tr>
	<tr>
		<td>6</td>
		<td><a href="#Step8">Opening the Product</a></td>
	</tr>
	<tr>
		<td>7</td>
		<td><a href="#Step9">Getting the CATIMmiPrtContainer and Part</a></td>
	</tr>
	<tr>
		<td>8</td>
		<td><a href="#Step10">Getting a Grid Set and Retrieving CATISrsUseGridSet</a></td>
	</tr>
	<tr>
		<td>9</td>
		<td><a href="#Step11">Getting the Group Faces of the Grid Set</a></td>
	</tr>
	<tr>
		<td>10</td>
		<td><a href="#Step12">Getting a Grid Face and Retrieving the CATISrsUseGridFace</a></td>
	</tr>
	<tr>
		<td>11</td>
		<td><a href="#Step13">Getting Short Name of the Grid Face</a></td>
	</tr>
	<tr>
		<td>12</td>
		<td><a href="#Step14">Setting Short Name of the Grid Face</a></td>
	</tr>
	<tr>
		<td>13</td>
		<td><a href="#Step15">Getting the CATISrsUseCategoryMngt and Retrieving the Category</a></td>
	</tr>
	<tr>
		<td>14</td>
		<td><a href="#Step16">Getting the Reference Hull Surface of the SRS Part</a></td>
	</tr>
	<tr>
		<td>15</td>
		<td><a href="#Step17">Getting MidShip Plane of the SRS Part from CATISrsUseMidShip</a></td>
	</tr>
	<tr>
		<td>16</td>
		<td><a href="#Step18">Getting the CentreLine Plane of the SRS Part from CATISrsUseCentreLine</a></td>
	</tr>
	<tr>
		<td>17</td>
		<td><a href="#Step19">Disconnecting and Deleting the Session</a></td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step1"></a>Checking the Input Data</h3>
<pre class="code">...
if (7 != argc)
{
  cout &lt;&lt; endl;
  cout &lt;&lt;&quot;Usage: CAASpaceReferenceSystem &lt;Repository&gt; &lt;Server&gt; &lt;User&gt; &lt;Password&gt; &lt;SecurityCtx&gt; &lt;PLM_ExternalID&gt;&quot;&lt;&lt; endl;
  cout &lt;&lt;&quot;Repository: The repository name (like PLM1)&quot; &lt;&lt;endl;
  cout &lt;&lt;&quot;Server: The URL string used for connection, expected format is 'protocol://ServerName:PortNumber/RootURI.&quot; &lt;&lt;endl;
  cout &lt;&lt;&quot;User: The user name for connection.&quot; &lt;&lt;endl ;
  cout &lt;&lt;&quot;Password: The user password for connection.&quot; &lt;&lt;endl;
  cout &lt;&lt;&quot;SecurityCtx: A string representing the security context ( Role. Organization. Project )&quot; &lt;&lt;endl;
  cout &lt;&lt;&quot;PLM_ExternalID: The PLM_ExternalID of a SRS product&quot; &lt;&lt;endl;
...
}
</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step2"></a>Setting the Connection Parameters</h3>
<p>Connection Parameters initialization.</p>
<pre class="code">...
hr = CATPLMSessionServices::SetPLMSessionParameter(&quot;Repository&quot;, argv[1]);
...

hr = CATPLMSessionServices::SetPLMSessionParameter(&quot;Server&quot;, argv[2]);
...

hr = CATPLMSessionServices::SetPLMSessionParameter(&quot;UserID&quot;, argv[3]);
...

hr = CATPLMSessionServices::SetPLMSessionParameter(&quot;UserPasswd&quot;, argv[4]);
...

hr = CATPLMSessionServices::SetPLMSessionParameter(&quot;SecurityCtx&quot;, argv[5]);
...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step3"></a>Creating a Session</h3>
<p>A session must always be created in a batch environment.</p>
<pre class="code">...
hr = CATPLMSessionServices::InitPLMSession();
...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step6"></a>Retrieving the Customized Reference of the Product Modeler</h3>
<pre class="code">...
hr = CATCkePLMNavPublicServices::RetrieveKnowledgeType("VPMReference", hTypeModeler);

...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step7"></a>Opening the &quot;CAASrsUcPart&quot; Model (arg[6])</h3>
<pre class="code">...
attributeSet.AddAttribute(&quot;PLM_ExternalID&quot;,argv[6]);
hr = CATAdpPLMQueryServices::GetElementsFromAttributes(hTypeModeler,
                                                       attributeSet,
                                                       ListP_QueryResults) ;

if(1 <=ListP_QueryResults.Size())
{
  pQueryResult =ListP_QueryResults[1] ;
  if(NULL !=pQueryResult)
  {
    hr =pQueryResult->GetIdentifier(pIPLMIdent) ;
  }
}
...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step8"></a>Opening the Product</h3>
<pre class="code">...
  hr = adpOpener.CompleteAndOpen(pIPLMIdent,IID_CATIPLMProducts, (void**) &amp;pIPLMProduct);
...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step9"></a>Getting the CATIMmiPrtContainer and Part</h3>
<pre class="code">...
  hr  =  SwitchToDesignModeAndReturnPartContainer(pIPLMProduct,pIPrtCont,piUsePart);  
...
  hr = GetSrsPartObj(piUsePart, spSrsPart)
...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step10"></a>Getting a Grid Set and Retrieving CATISrsUseGridSet</h3>
<pre class="code">...
  CATISrsUseGridSet *piSrsUseGridSet = NULL;
  hr = ispGridSet-&gt;QueryInterface(IID_CATISrsUseGridSet,(void **) &amp;piSrsUseGridSet); 

...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step11"></a>Getting the Group Faces of the Grid Set</h3>
<pre class="code">...
  CATLISTV(CATIMmiMechanicalFeature_var) lvAfterLastGridFaces; 
  CATLISTV(CATIMmiMechanicalFeature_var) lvBeforeLastGridFaces; 
  CATListOfDouble lvAfterOffsets; 
  CATListOfDouble lvBeforeOffsets;
...
  hr = piSrsUseGridSet-&gt;GetGroupFaces(lvAfterLastGridFaces, 
                                          lvBeforeLastGridFaces, 
                                          lvAfterOffsets, 
                                          lvBeforeOffsets);

...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step12"></a>Getting a Grid Face and Retrieving the CATISrsUseGridFace</h3>
<pre class="code">...
  spGridFace = lvGridFaces[1];
  //-----------------------------------------------------------------------
  // - Get CATISrsUseGridFace
  //-----------------------------------------------------------------------
  hr = ispGridFace-&gt;QueryInterface(IID_CATISrsUseGridFace,(void **) &amp;piSrsUseGridFace); 

...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step13"></a>Getting Short Name of the Grid Face</h3>
<pre class="code">...
  CATUnicodeString ucSrsGridFaceShortName;
... 
  hr = piSrsUseGridFace-&gt;GetShortName(ucSrsGridFaceShortName);

...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step14"></a>Setting Short Name of the Grid Face</h3>
<pre class="code">...
  CATUnicodeString ucShortName = "WT.01"
  hr = piSrsUseGridFace-&gt;SetShortName(ucShortName);
...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step15"></a>Getting the CATISrsUseCategoryMngt and Retrieving the Category</h3>
<pre class="code">...
  CATUnicodeString ucCategory; 

  CATISrsUseCategoryMngt_var spUseCategoryMngt = ispSrsUseGridFace; 
  if(!!spUseCategoryMngt) 
   hr = spUseCategoryMngt-&gt;GetCategory(ucCategory);
...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step16"></a>Getting the Reference Hull Surface of the SRS Part</h3>
<pre class="code">...
  CATIMmiMechanicalFeature_var spReferenceSurface;
  ...

  hr = ispSrsUsePart-&gt;GetReferenceSurface(spReferenceSurface); 
  ...

...</pre>
<script type="text/javascript">    insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step17"></a>Getting MidShip Plane of the SRS Part from CATISrsUseMidShip</h3>
<pre class="code">...
  CATISrsUseMidShip * piMidShip = NULL; 
  CATIMmiMechanicalFeature_var spMidShipFeature; 
  CATIMmiMechanicalFeature_var spMidShipPlane;

...
  CATIMmiMechanicalFeature_var spMidShipFeature;
  hr = ispSrsUsePart-&gt;GetMidShip(spMidShipFeature); 
  if(SUCCEEDED(hr) &amp;&amp; !!spMidShipFeature) 
  { 
    hr = spMidShipFeature-&gt;QueryInterface(IID_CATISrsUseMidShip,(void **) &amp;piMidShip); 
...
    hr = piMidShip-&gt; GetReferencePlane(spMidShipPlane); 
...</pre>
<script type="text/javascript">    insertLinkToTop();</script>
<h3><a name="Step18"></a>Getting the CentreLine Plane of the SRS Part from CATISrsUseCentreLine</h3>
<pre class="code">...
  CATISrsUseCentreLine * piCenterLine = NULL; 
  CATIMmiMechanicalFeature_var spCenterLinePlane; 
...
  CATIMmiMechanicalFeature_var spCenterLineFeature; 
  hr = ispSrsUsePart-&gt;GetCentreLine(spCenterLineFeature); 
  if(SUCCEEDED(hr) &amp;&amp; !!spCenterLineFeature) 
  { 
   hr = spCenterLineFeature-&gt;QueryInterface(IID_CATISrsUseCentreLine,(void **) &amp;piCenterLine); 
   if(SUCCEEDED(hr) &amp;&amp; NULL != piCenterLine) 
   { 
     hr = piCenterLine-&gt; GetReferencePlane(spCenterLinePlane);
...</pre>
<h3><a name="Step19"></a>Disconnecting and Deleting the Session</h3>
<pre class="code">...
  hr = CATPLMSessionServices::ClosePLMSession();
...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="InShort"></a>In Short</h2>
<p>This use case has demonstrated the way to retrieve and modify SRS data.</p>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="References"></a>References</h2>
<table class="reference">
	<tr>
		<td>[1]</td>
		<td>
		<a href="../CAADocUseCases/CAADocRunSample.htm">
		Building and Launching a Use Case</a></td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="history"></a>History</h2>
<table class="history">
	<tr>
		<td>Version: <strong>1</strong> [August 2013]</td>
		<td>Document created</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
