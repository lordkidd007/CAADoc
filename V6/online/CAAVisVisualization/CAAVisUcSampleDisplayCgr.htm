<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="en-us" http-equiv="Content-Language" />
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
<link href="../CAADocStyleSheets/caav5.css" rel="stylesheet" type="text/css"/>
<script src="../CAADocJavaScript/DSDocTocToc.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/DSDocHighlight.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/submit.js" type="text/javascript">/* */</script>
<title>Displaying cgr Files</title>
</head>

<body onload="highlightSearchTerms();">

<table class="DocHeader">
	<tr>
		<td class="DocHeader1">
		<h1><a name="Top"></a>Displaying cgr Files</h1>
		</td>
	</tr>
	<tr>
		<td class="use">Use Case</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table class="abstract">
	<tr>
		<td>
		<h2>Abstract</h2>
		<p>This article discusses the CAAVisBasics use case. This use case explains 
		how to open a cgr file and to display it in a viewer.</p>
		<ul>
			<li><a href="#Learn">What You Will Learn With This Use Case</a></li>
			<li><a href="#UseCase">The CAAVisBasics Use Case</a>
				<ul>
					<li><a href="#What">What Does CAAVisBasics Do</a></li>
					<li><a href="#How">How to Launch CAAVisBasics</a></li>
					<li><a href="#Where">Where to Find the CAAVisBasics Code</a></li>
				</ul>
			</li>
			<li><a href="#Step">Step-by-Step</a></li>
			<li><a href="#InShort">In Short</a></li>
			<li><a href="#References">References</a></li>
		</ul>
		</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Learn"></a>What You Will Learn With This Use Case</h2>
<p>This use case is intended to open a cgr file read from the disk and to display 
it in a 3D navigation viewer.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="UseCase"></a>The CAAVisBasics Use Case</h2>
<p>CAAVisBasics is a set of use cases of the CAAVisualization.edu framework that 
illustrates Vizualization framework capabilities.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="What"></a>What Does CAAVisBasics Do</h3>
<p>CAAVisBasics is an MDI interactive application that displays viewers in its model 
windows. One of these viewers is dedicated to display a cgr file selected using 
the File Open command in the file selection box. This article focuses on the way 
this cgr file is displayed.</p>
<p>The cubes.cgr file is selected and read from disk and displayed in a 3D navigation 
viewer.</p>
<p>
<img alt="Cubes CGR File" height="456" src="images/CAAVisCGRFile1.jpg" width="466"/></p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="How"></a>How to Launch CAAVisBasics</h3>
<p>To launch CAAVisBasics, you will need to set up the build time environment, then 
compile CAAVisBasics along with its prerequisites, set up the run time environment, 
and then execute the use case [<a href="#References">1</a>]. When you have launched 
CAAVisBasics, the following is displayed.</p>
<p>
<img alt="Torus CGR File" height="625" src="images/CAAVisCGRFile2.jpg" width="620"/></p>
<p>Then point <strong>File</strong>, and click <strong>Open</strong>. In the
<strong>Select a CGR File</strong> dialog box, select the resources\cgr directory 
in the run time view, and click the <strong>CUBES.cgr</strong> file that displays 
the cgr file with the cubes.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Where"></a>Where to Find the CAAVisBasics Code</h3>
<p>CAAVisBasics code is located in the CAAVisBasics.m use case module of the CAAVisualization.edu 
framework:</p>
<p><code>InstallRootFolder\CAADoc\CAAVisualization.edu\CAAVisBasics.m</code></p>
<p>where <code>InstallRootFolder</code> [<a href="#References">1</a>] is the folder 
where the API CD-ROM is installed.</p>
<p>CAAVisBasics includes the following files:</p>
<table>
	<tr>
		<td><strong>LocalInterfaces directory</strong></td>
	</tr>
	<tr>
		<td>CAAVisBaseApplication.h</td>
		<td>Header file for the interactive application that hosts the viewer</td>
	</tr>
	<tr>
		<td>CAAVisBaseCGRDocument.h</td>
		<td>Header file for the model that displays a cgr file</td>
	</tr>
	<tr>
		<td>CAAVisBaseDocument.h</td>
		<td>Header file for the model base class</td>
	</tr>
	<tr>
		<td>CAAVisBaseView.h</td>
		<td>Header file for the model window containing a viewer to display the 
		model</td>
	</tr>
	<tr>
		<td><strong>src directory</strong></td>
	</tr>
	<tr>
		<td>CAAVisBaseApplication.cpp</td>
		<td>Source file for the interactive application that hosts the viewer</td>
	</tr>
	<tr>
		<td>CAAVisBaseCGRDocument.cpp</td>
		<td>Source file for the model that displays a cgr file</td>
	</tr>
	<tr>
		<td>CAAVisBaseDocument.cpp</td>
		<td>Source file for the model base class</td>
	</tr>
	<tr>
		<td>CAAVisBaseView.cpp</td>
		<td>Source file for the model window containing a viewer to display the 
		model</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Step"></a>Step-by-Step</h2>
<p>To open and display a cgr file in a 3D viewer, there are three main steps:</p>
<table>
	<colgroup span="3" valign="top">
	</colgroup>
	<tr>
		<th>#</th>
		<th>Step</th>
		<th>Where</th>
	</tr>
	<tr>
		<td>1</td>
		<td><a href="#Step1">Create a 3D navigation viewer instance</a></td>
		<td><code>CAAVisBaseView::CreateViewer</code> method</td>
	</tr>
	<tr>
		<td>2</td>
		<td><a href="#Step2">Create a 3D representation bag from the selected cgr 
		file</a></td>
		<td><code>CAAVisBaseCGRDocument::CreateModel</code> method</td>
	</tr>
	<tr>
		<td>3</td>
		<td><a href="#Step3">Display the representation in the viewer</a></td>
		<td><code>CAAVisBaseDocument::AddRepToViewer</code> method</td>
	</tr>
</table>
<p>The preliminary tasks that consist in creating the application and its main window 
with menus and commands, displaying the file selection box, retrieving the input 
file name from the file selected, and checking that its a cgr file, are not described. 
The input file name is a data member of <em>CAAVisBaseCGRDocument</em> class.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step1"></a>Creating a 3D Navigation Viewer Instance</h3>
<p>The 3D navigation viewer is an instance of the <em>CATNavigation3DViewer</em> 
class. It is created in the <code>CreateViewer</code> method of the <em>CAAVisBaseView</em> 
class that is called when the application is launched.</p>
<pre class="code">void CAAVisBaseView::CreateViewer()
{
  _pViewer = new CATNavigation3DViewer(this, &quot;3DViewer&quot;,
                                      CATDlgFraNoTitle | CATDlgFraNoFrame,
                                      500, 500);
Attach4Sides(_pViewer);
}</pre>
<p>The <code>_pViewer</code> pointer to the 3D navigation viewer is kept as a data 
member of the <em>CAAVisBaseView</em> class. Its parameter are:</p>
<table>
	<colgroup span="2" valign="top">
	</colgroup>
	<tr>
		<td><code>this</code></td>
		<td>The viewer parent in the dialog containment tree structure and in the 
		command tree structure [<a href="#References">2</a>]</td>
	</tr>
	<tr>
		<td><code>3DViewer</code></td>
		<td>The viewer identifier</td>
	</tr>
	<tr>
		<td><code>CATDlgFraNoTitle</code></td>
		<td>The viewer has no title [<a href="#References">3</a>]</td>
	</tr>
	<tr>
		<td><code>CATDlgFraNoFrame</code></td>
		<td>The viewer frame is not displayed [<a href="#References">3</a>]</td>
	</tr>
	<tr>
		<td><code>500, 500</code></td>
		<td>The viewer width and height expressed in pixels</td>
	</tr>
</table>
<p>The <code>Attach4Sides</code> method attaches the four sides of the viewer to 
those of the window. This makes the viewer occupy the whole window space.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step2"></a>Creating a 3D Representation Bag from the Selected cgr File</h3>
<p>The <em>CAAVisBaseCGRDocument</em> constructor stores the cgr file name as a 
data member, and calls methods to create the representation and to display it in 
the viewer.</p>
<pre class="code">CAAVisBaseCGRDocument::CAAVisBaseCGRDocument(const char * fileName,
                                             CATCommand * iParent,
                                             CATDialog  * iDialogParent,
                                             CATString  * iDocumentName)
                     : CAAVisBaseDocument(iParent, iDialogParent, iDocumentName)
{
  _pFileToOpen = (char *)malloc((strlen(fileName)+1)*sizeof(char));
  memset(_pFileToOpen, 0, strlen(fileName)+1);
  strcpy(_pFileToOpen, fileName);

  CreateModel();

  AddRepToViewer();
}</pre>
<p>The representation bag is created thanks to the <code>CreateModel</code> method.</p>
<pre class="code">void CAAVisBaseCGRDocument::CreateModel()
{
  _pRootContainer = new CAT3DBagRep;
  //Reading of the CGR file. The rep issued from this reading
  //is added as a children of _pRootContainer
  CAT3DBagRep * cgr = (CAT3DBagRep *)::<strong>CATReadCgr</strong>((char *) _pFileToOpen,
                                                  USE_LODS_TEXTURE_EDGE);
  if(cgr)
  {
    _pRootContainer-&gt;AddChild(*cgr);
  }
}</pre>
<p>This representation is created as a <em>CAT3DBagRep</em>, since the cgr file 
may need several representations to accomodate its data. The global function
<code>CATReadCgr</code> takes the name of the cgr file as parameter. The second 
parameter is useless, and must always be set to <code>USE_LODS_TEXTURE_EDGE</code>.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step3"></a>Displaying the Representation in the Viewer</h3>
<p>The <code>AddRepToViewer</code> method displays the created representation.</p>
<pre class="code">void CAAVisBaseDocument::AddRepToViewer()
{
  _pView-&gt;Add3DRep(_pRootContainer);
}</pre>
<p><code>_pView</code> is a pointer to the 3D navigation viewer. The representation 
is assigned to this viewer thanks to the <code>Add3DRep</code> method.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="InShort"></a>In Short</h2>
<p>This use case shows the objects involved when displaying a cgr file, namely the 
3D navigation viewer that displays the cgr file and the 3D representation bag into 
which the cgr file is put to be passed to the viewer.</p>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="References"></a>References</h2>
<table class="reference">
	<tr>
		<td>[1]</td>
		<td>
		<a href="../CAADocUseCases/CAADocRunSample.htm">
		Building and Launching a Use Case</a></td>
	</tr>
	<tr>
		<td>[2]</td>
		<td><a href="../CAADlgDialog/CAADlgTaCreatingDialogs.htm">How 
		to Create Dialog Objects</a></td>
	</tr>
	<tr>
		<td>[3]</td>
		<td><a href="../CAADlgDialog/CAADlgQrCATDlgFrame.htm">CATDlgFrame</a></td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="History"></a>History</h2>
<table class="history">
	<tr>
		<td>Version: <strong>1</strong> [Feb 2000]</td>
		<td>Document created</td>
	</tr>
	<tr>
		<td>Version: <strong>2</strong> [Dec 2006]</td>
		<td>Document updated</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
