<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="en-us" http-equiv="Content-Language" />
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
<link href="../CAADocStyleSheets/caav5.css" rel="stylesheet" type="text/css"/>
<script src="../CAADocJavaScript/DSDocTocToc.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/DSDocHighlight.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/submit.js" type="text/javascript">/* */</script>
<title>Constructing Graphic Representations in Batch Mode</title>
</head>

<body onload="highlightSearchTerms();">

<table class="DocHeader">
	<tr>
		<td class="DocHeader1">
		<h1><a name="Top"></a>Constructing Graphic Representations in Batch Mode</h1>
		</td>
	</tr>
	<tr>
		<td class="use">Use Case</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table class="abstract">
	<tr>
		<td>
		<h2>Abstract</h2>
		<p>This article shows how to construct graphic representations in batch 
		mode.</p>
		<ul>
			<li><a href="#Learn">What You Will Learn With This Use Case</a></li>
			<li><a href="#UseCase">The CAAGviVisuBatch Use Case</a>
				<ul>
					<li><a href="#What">What Does CAAGviVisuBatch Do</a></li>
					<li><a href="#How">How to Launch CAAGviVisuBatch</a></li>
					<li><a href="#Where">Where to Find the CAAGviVisuBatch Code</a></li>
				</ul>
			</li>
			<li><a href="#Step">Step-by-Step</a></li>
			<li><a href="#InShort">In Short</a></li>
			<li><a href="#References">References</a></li>
		</ul>
		</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Learn"></a>What You Will Learn With This Use Case</h2>
<p>This use case is intended to show you how to use the <em>CATVisManager</em> to 
construct the graphic representations (rep) of a model.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="UseCase"></a>The CAAGviVisuBatch Use Case</h2>
<p>CAAGviVisuBatch is a use case of the CAAGeometryVisualization.edu framework that 
illustrates Visualization and VisualizationBase framework capabilities.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="What"></a>What Does CAAGviVisuBatch Do</h3>
<p>CAAGviVisuBatch constructs the graphic representations associated with the MechanicalPart 
(<code>Part1</code>) of the following Model:</p>
<table>
	<caption><a name="Fig.1"></a>Fig.1 The CAAVisuBatch Part Model</caption>
	<tr>
		<td>
		<img alt="CAAVisuBatch Part Model" height="237" src="images/CAAVisVisuBatch.jpg" width="314"/></td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="How"></a>How to Launch CAAGviVisuBatch</h3>
<p>To launch CAAGviVisuBatch , you will need to set up the build time environment, 
then compile CAAGviVisuBatch along with its prerequisites, set up the run time environment, 
and then execute the use case [<a href="#References">1</a>].</p>
<p>mkrun -c &quot;CAAGviVisuBatch Repository Server UserId Password role Environment 
PLMExternalIDValue Version&quot;</p>
<p>where the description of the arguments is the following:</p>
<table>
	<colgroup align="center" span="1">
	</colgroup>
	<tr>
		<th>Position</th>
		<th>Description</th>
		<th>Example</th>
		<th>Category</th>
	</tr>
	<tr>
		<td>1</td>
		<td>PLM repository</td>
		<td>
		<script type="text/javascript">insertRepository();</script>
		</td>
		<td>Connection</td>
	</tr>
	<tr>
		<td>2</td>
		<td>PLM server</td>
		<td>e4au2dsy:1571</td>
	</tr>
	<tr>
		<td>3</td>
		<td>Username</td>
		<td>odtitp</td>
	</tr>
	<tr>
		<td>4</td>
		<td>Password</td>
		<td><em>password</em></td>
	</tr>
	<tr>
		<td>5</td>
		<td>Role</td>
		<td>VPMDESIGNER.VPM.DEFAULT</td>
	</tr>
	<tr>
		<td>6</td>
		<td>PLM Type</td>
		<td>RepReference</td>
	</tr>
	<tr>
		<td>7</td>
		<td>PLMExternalIDValue</td>
		<td>CAATpiAccessAnnotation</td>
		<td>Component Attribute </td>
	</tr>
	<tr>
		<td>8</td>
		<td>Version</td>
		<td>---</td>
	</tr>
</table>
<ul>
	<li><strong>Repository</strong>:
		<script type="text/javascript">insertRepository();</script>
	</li>
	<li><strong>Server</strong>: The name and port of the server as <em>name</em>:<em>port_number</em></li>
	<li><strong>Username</strong>: The user name</li>
	<li><strong>Password</strong>: The user password to authenticate the user</li>
	<li><strong>Role</strong>: a string representing the security context (Role.Organization.Project). 
		Choose Role as Reviewer (since we only browse the PLM Data, no modifications)</li>
	<li><strong>Type</strong> : The name of the PLM type. </li>
	<li><strong>PLMExternalIDValue</strong> : the value of the PLM_ExternalID attribute 
		of a PLM Reference or PLM Representation reference*.</li>
	<li><strong>Version</strong> : the value of the majorrevision attribute of a PLM 
		Reference or PLM Representation reference.</li>
</ul>
<p>* The input model is retrieved by importing the 3DXML file <strong>CAAGviVisuBatch.3dxml</strong> 
supplied in the CAAGeometryVisualization.edu framework:</p>
<p><code>InstallRootFolder\CAADoc\CAAGeometryVisualization.edu\InputData\CAAGviVisuBatch.3dxml</code></p>
<p><strong>Attention</strong>: Please refer to the document [<a href="#References">1</a>] 
for how to import and reimport such a 3D XML file in your PLM repository.</p>
<p>The <code><strong>PLM_ExternalId</strong></code> attribute value of the imported 
model is typically of the format &quot;<code><strong>YourPrefix + CAAGviVisuBatch</strong></code>&quot;, 
where <a><code><strong>YourPrefix</strong></code></a> is the string provided as 
prefix, while importing a 3D XML file to CATIA.</p>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Where"></a>Where to Find the CAAGviVisuBatch Code</h3>
<p>The CAAGviVisuBatch use case is made of a single file, <em>CAAGviVisuBatch.cpp</em>, 
located in the CAAGviVisuBatch.m module of the CAAGeometryVisualization.edu framework:</p>
<p><code>InstallRootFolder\CAADoc\CAAGeometryVisualization.edu\CAAGviVisuBatch.m\</code></p>
<p>where <code>InstallRootFolder</code> [<a href="#References">1</a>] is the folder 
where the API CD-ROM is installed.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Step"></a>Step-by-Step</h2>
<p>There are seven logical steps in CAAGviVisuBatch:</p>
<ol>
	<li><a href="#Step1">Prolog</a></li>
	<li><a href="#Step2">Creates a Path with the MechanicalPart feature of the Part 
		Model</a></li>
	<li><a href="#Step3">Retrieves the unique CATVisManager Instance </a></li>
	<li><a href="#Step4">Attaches the Root Model to the CATVisManager</a></li>
	<li><a href="#Step5">Retrieves the Graphic Representation of the MechanicalPart 
		feature</a></li>
	<li><a href="#Step6">Detaches the Root Model from the CATVisManager</a></li>
	<li><a href="#Step7">Epilog</a></li>
</ol>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step1"></a>Prolog</h3>
<p>CAAGviVisuBatch begins by creating a session, and opening a 3D Representation. 
Next it retrieves the root container of this Representation as a pointer to <em>
CATIPrtContainer</em>, <code>piPartContainer.</code></p>
<p>Thanks to the <code>GetPart</code> method on the root container we retrieve the 
Mechanical Part. This part is handled by the smart pointer <code>spPart</code>.</p>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step2"></a>Creates a Path with the MechanicalPart feature of the Part 
Model</h3>
<pre class="code">...
 <strong>CATPathElement</strong> * pRootObjectPath = new CATPathElement(spPart);       
...</pre>
<p>In this use case, the <em>CATPathElement</em> is built with the root feature 
of the 3D Representation Model. This feature is the MechanicalPart feature, those 
called Part1 in the specification tree. Refer to the Mechanical Modeler articles. 
But anyhow, you can create this path with any feature of the model.</p>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step3"></a>Retrieves the unique CATVisManager Instance</h3>
<pre class="code">...
 <strong>CATVisManager</strong>* pVisManager = CATVisManager::<strong>GetVisManager</strong>();   
...</pre>
<p>There is only one instance of the <em>CATVisManager</em> class in a session. 
The <code>GetVisManager</code> static method enables you to retrieve it.</p>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step4"></a>Attaches the Root Model to the CATVisManager</h3>
<pre class="code">...
    list&lt;IID&gt; ListIVisu3d;
    IID * pIIDInf = new IID(IID_CATI3DGeoVisu) ;
    ListIVisu3d.<strong>fastadd</strong>(pIIDInf);

    CAT3DViewpoint * pVP = new <strong>CAT3DViewpoint</strong>();
    
    rc = pVisManager-&gt;<strong>AttachTo</strong> ( pRootObjectPath, pVP, ListIVisu3d);
...</pre>
<p>On the <em>CATVisManager</em> you attach to the <em>CATVisManager</em>:</p>
<ul>
	<li>The Path of the root model to build, p<code>RootObjectPath, </code></li>
	<li>For a default viewpoint, <code>pVP,</code></li>
	<li>For a given list of the visualization interfaces, <code>ListIVisu3d</code>. 
		Here, it is a list with only the <em>CATI3DGeoVisu</em> interface, once 
		the Mechanical features implement it.</li>
</ul>
<table class="Remark">
	<tr>
		<td><span class="run-in">Warning</span>: The <code>AttachTo</code> method 
		constructs the graphic representations.</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step5"></a>Retrieves the Graphic Representation of the MechanicalPart 
feature</h3>
<pre class="code">...
    <strong>CATI3DGeoVisu</strong> * pIVisuOnRoot =NULL ;    
    rc = spPart-&gt;QueryInterface(IID_CATI3DGeoVisu,
                                                          (void **) &amp; pIVisuOnRoot);
    ...
       CATRep * pRep = pIVisuOnRoot-&gt;<strong>GiveRep</strong>();
       if ( NULL != pRep )
       {
          CAT3DRep * p3DRep = (CAT3DRep *) pRep;

          CAT3DBoundingSphere pBe = p3DRep-&gt;GetBoundingElement();
          ...

...</pre>
<p>After the <code>AttachTo</code> method, it is possible to retrieve the graphic 
representations (rep) of an element thanks to the <code>GiveRep</code> method of 
the <em>CATI3DGeoVisu</em> interface. In this use case, the rep of the MechanicalPart 
feature (the root) is asked.</p>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step6"></a>Detaches the Root Model from the CATVisManager</h3>
<pre class="code">...
 rc = pVisManager-&gt;<strong>DetachFrom</strong>(pVP,0) ;</pre>
<pre> pVP-&gt;Release();
 pVP = NULL ;
...</pre>
<p>When the graphic representations are useless, you should detach the root model 
from the <em>CATVisManager</em>. With the <code>DetachFrom</code> method with only 
the viewpoint, all the root models and the list of interfaces attached with this 
viewpoint will be detached too. (The same root model can be attached with different 
viewpoints and with different interfaces)</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step7"></a>Epilog</h3>
<p>The last part of the CAAGviVisuBatch use case shows how to removes the 3D Representation 
model from the session and delete the session.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="InShort"></a>In Short</h2>
<p>This use case explains how to use the CATVisManager to create the graphic representations 
of model in a batch.</p>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="References"></a>References</h2>
<table class="reference">
	<tr>
		<td>[1]</td>
		<td>
		<a href="../CAADocUseCases/CAADocRunSample.htm">
		Building and Launching a Use Case</a></td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="History"></a>History</h2>
<table class="history">
	<tr>
		<td>Version: <strong>1</strong> [Fev 2003]</td>
		<td>Document created</td>
	</tr>
	<tr>
		<td>Version: <strong>2</strong> [Jan 2007]</td>
		<td>Document updated</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
