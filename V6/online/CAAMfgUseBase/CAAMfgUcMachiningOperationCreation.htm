<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="en-us" http-equiv="Content-Language" />
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
<link href="../CAADocStyleSheets/caav5.css" rel="stylesheet" type="text/css"/>
<script src="../CAADocJavaScript/DSDocTocToc.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/DSDocHighlight.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/submit.js" type="text/javascript">/* */</script>
<title>Machining Operation Creation</title>
</head>

<body onload="highlightSearchTerms();">

<table class="DocHeader">
	<tr>
		<td class="DocHeader1">
		<h1><a name="Top">Machining Operation Creation</a></h1>
		</td>
	</tr>
	<tr>
		<td class="use">Use Case</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table class="abstract">
	<tr>
		<td>
		<h2>Abstract</h2>
		<p>This article discusses the CAAMfgMachiningOperationCreation use case 
		and explains how to create a machining operation and set parameters in it.</p>
		<ul>
			<li><a href="#Learn">What You Will Learn With This Use Case</a></li>
			<li><a href="#UseCase">The CAAMfgMachiningOperationCreation Use Case</a>
				<ul>
					<li><a href="#What">What Does CAAMfgMachiningOperationCreation 
						Do</a></li>
					<li><a href="#How">How to Launch CAAMfgMachiningOperationCreation</a></li>
					<li><a href="#Where">Where to Find the CAAMfgMachiningOperationCreation 
						Code</a></li>
				</ul>
			</li>
			<li><a href="#Step">Step-by-Step</a></li>
			<li><a href="#InShort">In Short</a></li>
			<li><a href="#References">References</a></li>
		</ul>
		</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Learn"></a>What You Will Learn With This Use Case</h2>
<p>This use case is intended to help you to create a machining operation. This involves 
the following:</p>
<ul>
	<li>Create a machining operation in the selected program.</li>
	<li>Set geometry parameters.</li>
	<li>Set strategy parameters.</li>
	<li>Set the tool.</li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="UseCase"></a>The CAAMfgMachiningOperationCreation Use Case</h2>
<p>CAAMfgMachiningOperationCreation is a use case of the CAAMachiningUse.edu framework 
that illustrates how to create a machining operation.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="What"></a>What Does CAAMfgMachiningOperationCreation Do</h3>
<p>CAAMfgMachiningOperationCreation create 1 command to:</p>
<ul>
	<li>Create a machining operation in a given manufacturing program. And then 
		set parameters and the tool in it.</li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="How"></a>How to Launch CAAMfgMachiningOperationCreation</h3>
<p>To launch CAAMfgMachiningOperationCreation, you will need to set up the build 
time environment, then compile CAAMfgMachiningOperationCreation.m along with its 
prerequisites, set up the run time environment, and then execute the use case [<a href="#References">1</a>].</p>
<p>Don't forget to edit the interface dictionary CAAMachiningUse.edu.dico located 
in:</p>
<p><code>InstallRootFolder\CAADoc\CAAMachiningUse.edu\CNext\code\dictionary\</code></p>
<p>where <code>InstallRootFolder</code> is the folder where the API CD-ROM is installed, 
and uncomment the appropriate lines by removing the '#CAA#' characters:</p>
<pre class="code">
# Decomment this line to run CAAMfgMachiningOperationCreation Sample (remove #CAA# keyword)
#CAA#CAAMfgWksAddin						DELIManufacturingProgramAddin           libCAAMfgMachiningOperationCreation
#CAA#CAAMfgWksAddin						CATIWorkbenchAddin						libCAAMfgMachiningOperationCreation</pre>
<p>Launch a V6 session and enter the Machining workbench.</p>
<p>Use Case add a new tool bar &quot;CAA Machining Operation Creation&quot;:</p>
<p>
<img alt="Toolbar CAA Machining Operation Creation" src="images/CAAMfgMachiningOperationCreationToolBar.png"/>
</p>
<p>You can use for this use case the data <code>InstallRootFolder\CAADoc\CAAMachiningUse.edu\InputData\CAAMfgMachining.3dxml</code></p>
<p>It contains all the required geometries to create a complete machining operation.</p>
<p>When you launch the command you have to select the manufacturing program in which 
you want to create the machining operation.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Where"></a>Where to Find the CAAMfgMachiningOperationCreation Code</h3>
<p>The CAAMfgMachiningOperationCreation use case is made of several classes/a single 
file located in the CAAMfgMachiningOperationCreation.m module of the CAAMachiningUse.edu 
framework: <code>InstallRootFolder\CAADoc\CAAMachiningUse.edu\CAAMfgMachiningOperationCreation.m</code></p>
<p>where <code>InstallRootFolder</code> [<a href="#References">1</a>] is the folder 
where the API CD-ROM is installed.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Step"></a>Step-by-Step</h2>
<p>There are four logical steps in CAAMfgMachiningOperationCreation:</p>
<ol>
	<li><a href="#Step1">Creating a Machining Operation</a></li>
	<li><a href="#Step2">Settin Geometry Parameters</a></li>
	<li><a href="#Step3">Setting Strategy Parameters</a></li>
	<li><a href="#Step4">Setting the Tool</a></li>
</ol>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step1"></a>Creating a Machining Operation</h3>
<pre class="code">...
CATBoolean AutoSequence = TRUE;
RC = spNCProgram-&gt;AppendOperation (_TypeToCreate, AutoSequence, _spCreatedActivity);
...</pre>
<p>spNCProgram is the program in which you want to create the operation.</p>
<p>_TypeToCreate is the type of the created operation, here it's &quot;M3xSweeping&quot;.</p>
<p>We obtain the created operation: <code>_spCreatedActivity</code>.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step2"></a>Setting Geometry Parameters</h3>
<p>You can first create a machining area which will be set as the feature of the 
operation.</p>
<pre class="code">...
DELISmgFactory  *  pSmgFactory  =  NULL;  
hr  =  featCont-&gt;QueryInterface(IID_DELISmgFactory,  (void**)  &amp;pSmgFactory);  
if  (SUCCEEDED(hr) &amp;&amp; pSmgFactory != NULL)  
{
  pSmgFactory-&gt;CreateMachiningArea(oMachArea);
}

if (pSmgFactory)
{
  pSmgFactory-&gt;Release();
  pSmgFactory = NULL;
}
...</pre>
<p>Call CreateMachiningArea to create a new machining area. This method return the 
created machining area oMachArea.</p>
<p>Then you can fill this machining area with geoemtries.</p>
<pre class="code">...
// Set the geometries in the machining area.

DELIMfgGeometryDefinition_var geomOpe(_spMachiningArea);

if (geomOpe == NULL_var) return E_FAIL;

// Set the part geometry. Use the &quot;magic word&quot; Parts as in parameter.

geomOpe-&gt;AddGeometry(&quot;Parts&quot;, geomPart, prod);

// Set the check geometry. Use the &quot;magic word&quot; Checks as in parameter.

geomOpe-&gt;AddGeometry(&quot;Checks&quot;, geomPart, prod);

// Set the limiting contour. Use the &quot;magic word&quot; GuidingElements as in parameter.

int NbContours = contours.Size();
hr = S_OK;
for (int ic=1;ic&lt;=NbContours &amp;&amp; SUCCEEDED(hr);ic++)
{
  CATIABase_var haReference = contours[ic];
  hr = geomOpe-&gt;AddGeometry(&quot;GuidingElements&quot;, haReference, prod);
}
...</pre>
<p>Use of the API DELIMfgGeometryDefinition to manage the geometries.</p>
<p>And finally sets the feature in the created operation.</p>
<pre class="code">...
// Set the feature of the activity.

DELIMfgActivity_var act(_spCreatedActivity);
act-&gt;SetFeature(_spMachiningArea);
...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step3"></a>Setting Strategy Parameters</h3>
<pre class="code">...
// Set some machining parameters in the created activity.

DELIMfgActivityParameters_var params(_spCreatedActivity);

if (params == NULL_var) return CATFalse;

// Machining mode.

CATBaseUnknown_var MachModeParam;
params-&gt;FindElement(CATUnicodeString(&quot;M3xMachiningMode&quot;), MachModeParam);
CATICkeParm_var MachModeParm(MachModeParam);
// One-way next mode.
if (MachModeParm != NULL_var) MachModeParm-&gt;Valuate(2);

// Machining tolerance.

params-&gt;SetValue(CATUnicodeString(&quot;MfgMachiningTolerance&quot;), 0.1);

// Max. distance between path.

params-&gt;SetValue(CATUnicodeString(&quot;M3xStepDistance&quot;), 3.0);
...</pre>
<p>You can set some strategy parameters using the API DELIMfgActivityParameters.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step4"></a>Setting the Tool</h3>
<pre class="code">...
DELIMfgActivity_var act(_spCreatedActivity);
if (act != NULL_var)
{
  act-&gt;SetTool(tool, TRUE);
}
...</pre>
<p>To have a valid operation, the tool is missing. Set it using the method SetTool.</p>
<p>To have more information on creating and managing tools, see [<a href="#References">2</a>].</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="InShort"></a>In Short</h2>
<p>This article provides an example on how to create a machining operation.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="References"></a>References</h2>
<table class="reference">
	<tr>
		<td>[1]</td>
		<td>
		<a href="../CAADocUseCases/CAADocRunSample.htm">
		Building and Launching a Use Case</a></td>
	</tr>
	<tr>
		<td>[2]</td>
		<td><a href="CAAMfgUcToolManagement.htm">Creating, Using and Managing Tools</a></td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="History"></a>History</h2>
<table class="history">
	<tr>
		<td>Version: <strong>1</strong> [Mar 2010]</td>
		<td>Document created</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
