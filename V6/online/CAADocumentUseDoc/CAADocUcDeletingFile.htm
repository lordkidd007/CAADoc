<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="en-us" http-equiv="Content-Language" />
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
<link href="../CAADocStyleSheets/caav5.css" rel="stylesheet" type="text/css"/>
<script src="../CAADocJavaScript/DSDocTocToc.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/DSDocHighlight.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/submit.js" type="text/javascript">/* */</script>
<title>Deleting File Attached to a Document</title>
</head>

<body onload="highlightSearchTerms();">

<table class="DocHeader">
	<tr>
		<td class="DocHeader1">
		<h1><a name="Top"></a>Deleting Files Attached to a Document</h1>
		</td>
	</tr>
	<tr>
		<td class="use" style="height: 16px">Use Case</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table class="abstract">
	<tr>
		<td>
		<h2>Abstract</h2>
		<p>This article demonstrates to an end user how to delete the File contained 
		inside a Document selected interactively in CATIA, using the CAA Exposition.</p>
		<p><strong>Note: Document Modeler is not RACE Compliant.</strong></p>
		<ul>
			<li><a href="#Learn">What You Will Learn With This Use Case</a></li>
			<li><a href="#UseCase">The CAADocDeletingFileCmd Use Case</a>
				<ul>
					<li><a href="#What">What Does CAADocDeletingFileCmd Do</a></li>
					<li><a href="#How">How to Launch CAADocDeletingFileCmd</a></li>
					<li><a href="#Where">Where to Find the CAADocDeletingFileCmd 
						Code</a></li>
				</ul>
			</li>
			<li><a href="#Step">Step-by-Step</a></li>
			<li><a href="#InShort">In Short</a></li>
			<li><a href="#References">References</a></li>
		</ul>
		</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Learn"></a>What You Will Learn With This Use Case</h2>
<p>The user learns the concepts listed below:</p>
<ul>
	<li>An aquisition agent, a <em>CATPLMNavPropertiesAcquisition</em> type, to 
		manage selection of a PLM entity in the immersive window (Search result 
		and Explorer window).</li>
	<li>The CAA Exposition which enables to delete the file contained inside a Document.</li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="UseCase"></a>The CAADocDeletingFileCmd Use Case</h2>
<p>CAADocDeletingFileCmd is a use case of the CAADocumentUseItf.edu framework that 
illustrates the PLMDocumentInterfaces framework capabilities.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="What"></a>What Does CAADocDeletingFileCmd Do</h3>
<p>The goal of CAADocDeletingFileCmd Use Case is to deploy the Openness provided 
by CAA, to delete the file contained inside a Document selected interactively in 
the VPM Navigator. We work on an input model as depicted in the Fig. that follows. 
The model will have to be explicitly created by the end-user.</p>
<table>
	<caption><a name="Fig1"></a>Fig. 1: Input Model</caption>
	<tr>
		<td>
		<img alt="Input Model" height="428" src="images/CAADocUc_OutputModel.jpg" width="566"/></td>
	</tr>
</table>
<p>The input model consists of a root product <strong>CAADocProdRoot---</strong>. 
The product is attached to:</p>
<ul>
	<li>Document <strong>Generic Document</strong>, of type &quot;<strong>Generic 
		Document</strong>&quot; (internal type <strong>Generic Document</strong>) 
		which contains <strong>Generic_Document.txt</strong> and <strong>Uploaded_Generic_Document.txt</strong>.</li>
	<li>Document <strong>CDM_Document</strong>, of type &quot;<strong>Document</strong>&quot; 
		(internal type <strong>Document</strong>) which contains <strong>CDM_Document.txt</strong>.</li>
</ul>
<p>The UC then lists the files contained inside the Document attached to this model. 
This is accomplished with the command &quot;<strong>Deleting File on selected Document</strong>&quot; 
inside the &quot;<strong>Working with Files attach to Document</strong>&quot; toolbar, 
in <strong>a PLM Navigator AddIn</strong> in <strong>CATIA.</strong> This
<strong>AddIn</strong> (<strong>Toolbar</strong>) exists in the VPM Navigator workbench 
as depicted in the Fig. that follows. The &quot;<strong>How to Launch</strong>&quot; 
section that follows details the steps involved to launch the VPM Navigator workbench 
and access this toolbar.</p>
<table>
	<caption><a name="Fig2"></a>Fig. 2: Deleting File Attached to a Document Toolbar</caption>
	<tr>
		<td>
		<img alt="Deleting File Attached to a Document Toolbar" height="294" src="images/CAADocDeletingFileCmd_image_2.jpg" width="233"/></td>
	</tr>
</table>
<p>The UC execution proceeds as follows:</p>
<ul>
	<li>User activates the &quot;<strong>Deleting File on selected document</strong>&quot; 
		command.</li>
	<li>The command prompts user to select a document, from the Product spec tree 
		in the Explorer (VPM Navigator) session. A document of type &quot;<strong>Generic 
		Document</strong>&quot; and &quot;<strong>Document</strong>&quot; are the 
		only two types recognized the exposed API.</li>
	<li>User selects the document, in the current case &quot;Generic Document&quot;, 
		of type &quot;<strong>Generic Document</strong>&quot;. Next a dialog box 
		the follows appears.
		<table>
			<caption><a name="Fig3"></a>Fig.3: Listing Files Dialog Box</caption>
			<tr>
				<td>
				<img alt="Listing Files Dialog Box" height="149" src="images/CAADocUc_ListingFilesDlgBox.jpg" width="289"/>
				</td>
			</tr>
		</table>
		<p>*The dialog box depicted above is only representative.</p>
		<p>The title of this dialog box is the name of the selected Document. The 
		dialog box lists the files contained inside that Document.</p>
		<p>Next the use case deletes the first document from the list. Basically 
		this use case focuses on the deleting of the document inside the document. 
		For demonstration purpose use case deletes first file from the list. Please 
		note that there is no need of explicit save after deletion, its short transition.</p>
	</li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="How"></a>How to Launch CAADocDeletingFileCmd</h3>
<p>To launch CAADocDeletingFileCmd:</p>
<ol>
	<li>Set the current folder to <code>InstallRootFolder\CAADoc\CAADocumentUseItf.edu</code>.</li>
	<li>Set up the build time environment and build the CAADocNavPropAcqAgentAddin.m<code></code> 
		and CAADocNavCommmands.m module.</li>
	<li>Edit the <code>CNext\code\dictionary\CAADocumentUseItf.edu.dico</code> dictionary 
		by uncommenting the #CAA# from the following lines:
		<pre class="code">#CAA# CAADocNavPropAcqAgentAddin  CATIImmNavAddin     libCAADocNavPropAcqAgentAddin
#CAA# CAADocNavPropAcqAgentAddin  CATIWorkbenchAddin  libCAADocNavPropAcqAgentAddin</pre>
	</li>
	<li>Install the dictionary and other resource files by executing <code>mkCreateRuntimeView</code></li>
	<li>Start CATIA by executing <code>mkrun</code>.</li>
	<li>Create the model as depicted in [<a href="#Fig1">Fig. 1</a>], save it and 
		load it in the VPM Navigator session.</li>
	<li>Display the toolbar named &quot;<strong>Working with Files attached to Document
		</strong>&quot; toolbar if necessary. It is depicted in the
		<a href="#Fig2">Fig. 2</a> above.</li>
	<li>Hereafter, the execution follows the steps listed in the &quot;<strong>What 
		does the UC do</strong>&quot; section above.</li>
</ol>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Where"></a>Where to Find the CAADocDeletingFileCmd Code</h3>
<p>The CAADocDeletingFileCmd use case is located in the CAADocNavCommmands.m module 
of the CAADocumentUseItf.edu framework:</p>
<p><code>InstallRootFolder\CAADoc\CAADocumentUseItf.edu\CAADocNavCommmands.m</code></p>
<p>For the Add-In, it includes the <em>CAADocNavPropAcqAgentAdn</em> class located 
in the CAADocNavPropAcqAgentAddin.m module of the CAADocumentUseItf.edu framework:</p>
<p><code>InstallRootFolder\CAADoc\CAADocumentUseItf.edu\CAADocNavPropAcqAgentAddin.m</code></p>
<p>where <code>InstallRootFolder</code> [<a href="#References">1</a>] is the folder 
where the API CD-ROM is installed.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Step"></a>Step-by-Step</h2>
<p>There are three steps in CAADocDeletingFileCmd:</p>
<ol>
	<li><a href="#Step1">Selecting a Document in the VPM Navigator Spec Tree </a>
	</li>
	<li><a href="#Step2">Retrieving the List of Files Contained inside a Document</a></li>
	<li><a href="#Step3">Deleting the First File Contained inside a Document</a></li>
</ol>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step1"></a>Selecting a Document in the VPM Navigator Spec Tree</h3>
<p>The UC being an interactive UC is primarily implemented as a StateCommand detailed 
in the UC [<a href="#References">2</a>]. The current step involves selecting a Document 
in the VPM Navigator spec tree. This is accomplished with two acquisition agents 
(<code>_paNavAcqAgentCDMDoc </code>or<code>_aNavAcqAgentGenDoc</code>), <em>CATPLMNavPropertiesAcquisition</em> 
type, which enables selection of a PLM entity in an immersive window (Search Result 
window and Explore window). These Acquisition agents allow to select objects of 
type Generic Document or Document (Document) only.</p>
<p>The acquisition agent also enables us to retrieve the Identificator of the selected 
PLM entity, as a <em>CATIAdpPLMIdentificator</em> type (<code>_piAdpIdOnSelectedDoc</code>). 
The Identificator inturn helps us retrieve the Knowledge Type of the selected PLM 
entity, and confirm if the Document type is either Generic Document or Document 
(Document), since the CAA Exposition to download the files attached to a document 
works only for these types.</p>
<p>The agent also enables us retrieve a <em>CATICkeObject</em> Interface to the 
Knowledge World, on our selected Document. The PLM Identificator and the Knowledge 
Interface on our selected Document is a key input to the next step, which retrieves 
the list of files contained inside a Document.</p>
<p>This step is further explained in the UC [<a href="#References">2</a>].</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step2"></a>Retrieving the List of Files Contained inside a Document</h3>
<p>The <code>ListingFilesOnDocAndDeletingFirstFile</code>() routine of the StateCommand 
class lists files attched with selected document. Listing files detailed in [<a href="#References">3</a>] 
use case. In this same method we delete First file listed.</p>
<p>The API recognizes documents of type &quot;<strong>Generic Document</strong>&quot; 
and &quot;<strong>Document</strong>&quot;. </p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step3"></a>Deleting the First File Contained inside a Document</h3>
<p>Next use case retrieves first file from the list and delete it.</p>
<pre class="code">    <strong>PLMIDocument</strong> *piDocument = NULL;
    hr = <strong>PLMDocumentServices::GetDocument</strong>(piAdpIdOnSelectedDoc, piDocument);
    ...			
    hr = piDocument-&gt;<strong>DeleteFile</strong>(oFileNames[1]) ;</pre>
<p>We load the document in the session using <code>GetDocument</code> method of
<em>PLMDocumentServices.</em></p>
<p>Next delete file inside the document by name here in this case we are providing 
first file name from the list. A call to <code>DeleteFile </code>on <em>PLMIDocument</em> 
deletes file by its name.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="InShort"></a>In Short</h2>
<p>This use case illustrates to an end user how to list the files contained inside 
a Document. It is an interactive UC, where the end-user selects a Document in the 
spec tree inside the VPM Navigator window. The list of files contained inside this 
document are then displayed in the dialog box.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="References"></a>References</h2>
<table class="reference">
	<tr>
		<td>[1]</td>
		<td>
		<a href="../CAADocUseCases/CAADocRunSample.htm">
		Building and Launching a Use Case</a></td>
	</tr>
	<tr>
		<td>[2]</td>
		<td><a href="CAADocUcDisplayingAtrributes.htm">Displaying Document Properties</a></td>
	</tr>
	<tr>
		<td>[3]</td>
		<td><a href="CAADocUcListingFiles.htm">Listing Files inside a Document</a></td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="History">History</a></h2>
<table class="history">
	<tr>
		<td>Version: 1 [Jun 2011]</td>
		<td>Document created</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
