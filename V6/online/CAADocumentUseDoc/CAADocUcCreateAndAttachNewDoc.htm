<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="en-us" http-equiv="Content-Language" />
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
<link href="../CAADocStyleSheets/caav5.css" rel="stylesheet" type="text/css"/>
<script src="../CAADocJavaScript/DSDocTocToc.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/DSDocHighlight.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/submit.js" type="text/javascript">/* */</script>
<title>Creating New Document And Attaching to Product</title>
</head>

<body onload="highlightSearchTerms();">

<table class="DocHeader">
	<tr>
		<td class="DocHeader1">
		<h1><a name="Top"></a>Creating New Document And Attaching to Product
		</h1>
		</td>
	</tr>
	<tr>
		<td class="use" style="height: 16px">Use Case</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table class="abstract">
	<tr>
		<td>
		<h2>Abstract</h2>
		<p>This article demonstrates to an end user how to create new document and 
		attaching it to a product selected interactively in Search window, using 
		the CAA Exposition.</p>
		<p><strong>Note: Document Modeler is not RACE Compliant.</strong></p>
		<ul>
			<li><a href="#Learn">What You Will Learn With This Use Case</a></li>
			<li><a href="#UseCase">The CAADocCreateAndAttachNewDocCmd Use Case</a>
				<ul>
					<li><a href="#What">What Does CAADocCreateAndAttachNewDocCmd 
						Do</a></li>
					<li><a href="#How">How to Launch CAADocCreateAndAttachNewDocCmd</a></li>
					<li><a href="#Where">Where to Find the CAADocCreateAndAttachNewDocCmd 
						Code</a></li>
				</ul>
			</li>
			<li><a href="#Step">Step-by-Step</a></li>
			<li><a href="#InShort">In Short</a></li>
			<li><a href="#References">References</a></li>
		</ul>
		</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Learn"></a>What You Will Learn With This Use Case</h2>
<p>The user learns the concepts listed below:</p>
<p>The CAA Exposition which enables to:</p>
<ul>
	<li>Creating new documents.</li>
	<li>Attaching documents to the Product.</li>
</ul>
<p>Along with this, the use case also demonstrates the following points:</p>
<ul>
	<li>A path element agent<em> CATPLMNavPropertiesAcquisition</em> type, to manage 
		selection of a product in the Search window.</li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="UseCase"></a>The CAADocCreateAndAttachNewDocCmd Use Case</h2>
<p>CAADocCreateAndAttachNewDocCmd is a use case of the CAADocumentUseItf.edu framework 
that illustrates the PLMDocumentInterfaces framework capabilities.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="What"></a>What Does CAADocCreateAndAttachNewDocCmd Do</h3>
<p>The goal of <code>CAADocCreateAndAttachNewDocCmd </code>Use Case is to deploy 
the Openness provided by CAA:</p>
<ul>
	<li>To retrieve the identificator if the selected product interactively in the 
		Search window.</li>
	<li>To create new document.</li>
	<li>Attached to product newly created document.</li>
</ul>
<p>We work on an input model as depicted in the <a href="#Fig1">Fig. 1</a> that 
follows. The model will have to be explicitly created by the end-user.</p>
<table>
	<caption><a name="Fig1"></a>Fig. 1: Input Model</caption>
	<tr>
		<td>
		<img alt="Input Model" height="115" src="images/CAADocCreateAndAttachNewDoc_Image2.jpg" width="383"/></td>
	</tr>
</table>
<p>The input model consists of a root product <strong>CAADocProdRoot--- </strong>
as visible in Search window.</p>
<p>The UC then lists the documents attached to the product and detaches the first 
document. This is accomplished with the command &quot;<strong>Listing Doc Attached 
To Product And Detaching First Doc</strong>&quot; inside the &quot;<strong>CAA Document 
Search addin toolbar</strong>&quot; toolbar, in <strong>a PLM Editor AddIn</strong> 
in <strong>CATIA.</strong> This <strong>AddIn</strong> (<strong>Toolbar</strong>) 
exists in the Search workbench as depicted in the <a href="#Fig2">Fig. 2</a> that 
follows. The &quot;<strong>How to Launch</strong>&quot; section that follows details 
the steps involved to launch the Search workbench and access this toolbar.</p>
<table>
	<caption><a name="Fig2"></a>Fig. 2: Working with Documents Attached to Product 
	Toolbar</caption>
	<tr>
		<td>
		<img alt="Working with Documents Attached to Product Toolbar" height="102" src="images/CAADocCreateAndAttachNewDoc_Image1.jpg" width="244"/></td>
	</tr>
</table>
<p>The UC execution proceeds as follows:</p>
<ul>
	<li>User activates the &quot;<strong>Listing Doc Attached To Product And Detaching 
		First Doc</strong>&quot; command.</li>
	<li>The command prompts user to select a Product, from the Product spec tree 
		in the Search window session.</li>
	<li>User selects the Product, in the current case &quot;CAADocProdRoot&quot;. 
		Next a dialog box the follows appears.</li>
</ul>
<table>
	<caption>Fig. 3: Input for the Creation of New Document to Attach on Selected 
	Product</caption>
	<tr>
		<td>
		<img alt="Input for the Creation of New Document to Attach on Selected Product" height="155" src="images/CAADocCreateAndAttachNewDoc_Image3.jpg" width="327"/></td>
	</tr>
</table>
<ul>
	<li>Next we fill the input:
		<ul>
			<li>File path for file that we want to associate with new document.</li>
			<li>Comments for Document.</li>
			<li>Document type that we want create (&quot;Document&quot; or &quot;Generic 
				Document&quot;).</li>
		</ul>
	</li>
</ul>
<ul>
	<li>Next we press &quot;Create And Attach Document&quot; button. Further to 
		this new document get created and attached to the selected product.</li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="How"></a>How to Launch CAADocCreateAndAttachNewDocCmd</h3>
<p>To launch CAADocCreateAndAttachNewDocCmd:</p>
<ol>
	<li>Set the current folder to <code>InstallRootFolder\CAADoc\CAADocumentUseItf.edu</code>.</li>
	<li>Set up the build time environment and build the <code>CAADocSearchAddin.m</code> 
		and <code>CAADocSearchCommands.m </code>module.</li>
	<li>Edit the <code>CNext\code\dictionary\CAADocumentUseItf.edu.dico</code> dictionary 
		by uncommenting the #CAA# from the following lines:
		<pre class="code">#CAA# CAADocSearchAdn  CATIPrsConfigurationAddin  libCAADocSearchAddin
#CAA# CAADocSearchAdn  CATIWorkbenchAddin         libCAADocSearchAddin</pre>
	</li>
	<li>Install the dictionary and other resource files by executing <code>mkCreateRuntimeView</code>.</li>
	<li>Start CATIA by executing <code>mkrun</code>.</li>
	<li>Create the model as depicted in [<a href="#Fig1">Fig. 1</a>], and save it 
		(Simple Product Reference).</li>
	<li>Query for saved product reference and see in Search window.</li>
	<li>Display the toolbar named &quot;<strong>CAA Document Search addin toolbar</strong>&quot; 
		toolbar if necessary. It is depicted in the <a href="#Fig2">Fig. 2.</a> 
		above.</li>
	<li>The execution follows the steps listed in the &quot;<strong>What does the 
		UC do</strong>&quot; section above.</li>
</ol>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Where"></a>Where to Find the CAADocCreateAndAttachNewDocCmd Code</h3>
<p>The CAADocCreateAndAttachNewDocCmd use case is located in the CAADocSearchCommands.m 
module of the CAADocumentUseItf.edu framework:</p>
<p><code>InstallRootFolder\CAADoc\CAADocumentUseItf.edu\CAADocSearchCommands.m</code></p>
<p>For the Add-In , it includes the <code>CAADocSearchAddin</code> class, located 
in the CAADocSearchAddin.m module of the CAADocumentUseItf.edu framework:</p>
<p><code>InstallRootFolder\CAADoc\CAADocumentUseItf.edu\CAADocSearchAddin.m</code></p>
<p>where <code>InstallRootFolder</code> [<a href="#References">1</a>] is the folder 
where the API CD-ROM is installed.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Step"></a>Step-by-Step</h2>
<p>There are two parts in CAADocCreateAndAttachNewDocCmd:</p>
<ol>
	<li><a href="#Step1">Loading and Retrieving a Product from the Search Window</a></li>
	<li><a href="#Step2">Creating a New Document and Attaching It to the Retrieved 
		Product</a></li>
</ol>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step1"></a>Loading and Retrieving a Product from the Search Window</h3>
<p>The UC being an interactive UC is primarily implemented as a StateCommand detailed 
in the UC [<a href="#References">2</a>]. Current UC explains the selection of Product 
in Search window. However UC [<a href="#References">2</a>] explains the selection 
of Document in VPM Navigator. The current step involves selecting a Product in the 
Search window. This is accomplished with path element agent (<code>_paNavAcqAgent</code>),
<em>CATPLMNavPropertiesAcquisition</em> type, which enables selection of a PLM Product 
in an Search window). This path element agent is intended to select PLM Product 
only.</p>
<p>The acquisition agent enables us to retrieve the selected object, as a <em>CATIAdpPLMIdentificator</em> 
type (<code>opiAdpIdOnSelectedProd</code>). The <code>opiAdpIdOnSelectedProd
</code>in turn helps us to load product reference in session and obtain <i>CATIPLMComponent,
</i>in order to<i> </i>attach newly created document in further steps.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step2"></a>Creating a New Document and Attaching It to the Retrieved 
Product</h3>
<p>The <code>Run()</code> routine of the State Command class is detailed below.</p>
<pre class="code">CATBoolean <strong>CAADocCreateAndAttachNewDocDlg::CreateAndAttachNewDocument</strong>(CATCommand* iSendingCommand, 
						CATNotification* iSentNotification, 
						CATCommandClientData iUsefulData)

{
    PLMIDocument * piDocument = NULL;
    hr = <strong>PLMDocumentServices</strong>::<strong>CreateDocument</strong>(spCATITypeOnType, 
					lstCATListValCATICkeParmEmptyList,
					lListFilePaths,`
					lListFileComments,
					piDocument);
   ...	
   CATOmbLifeCycleRootsBag Bag;
   Bag.InsertRoot(piDocument);
   ...	
   CATIPLMComponent *piPLMCompOnNewDoc = NULL;
   hr = piDocument-&gt;QueryInterface(IID_CATIPLMComponent, (void**) &amp;piPLMCompOnNewDoc);
   ...	
   CATIAdpPLMIdentificator * piAdpIdOnNewDocument = NULL;
   hr = piPLMCompOnNewDoc-&gt;GetAdpID(piAdpIdOnNewDocument);
   ...
   hr = <strong>PLMDocumentServices</strong>::<strong>AttachDocument</strong>(piPLMCompOnRoot, 
  				        piAdpIdOnNewDocument); 	
 ...</pre>
<p>The <code>CreateDocument</code> static API of the <em>PLMDocumentServices</em> 
class creates new document. Its input argument are:</p>
<ul>
	<li><code>spCATITypeOnType</code>, a <em>CATIType</em> type of document &quot;Document&quot; 
		or &quot;Generic Document&quot;.</li>
	<li><code>lstCATListValCATICkeParmEmptyList</code>, a <em>CATListValCATICkeParm_var
		</em>type, which will contain the list of document mandatory attributes.</li>
	<li><code>lListFilePaths</code>, a <em>CATListOfCATUnicodeString</em> type, 
		which will contain the list of document path.</li>
	<li><code>lListFileComments</code>, a <em>CATListOfCATUnicodeString </em>type, 
		which will contain the list of document comments.</li>
	<li><code>piDocument</code>, a <em>PLMIDocument </em>type, document object.</li>
</ul>
<p>The <code>AttachDocument</code> static API of the <em>PLMDocumentServices</em> 
class attaches the document to a input object. Its input argument are:</p>
<ul>
	<li><code>piPLMCompOnRoot</code>, a <em>CATIPLMComponent</em>* type representing 
		the PLM entity in session.</li>
	<li><code>piAdpIdOnNewDocument</code>, a <em>CATIAdpPLMIdentificator </em>type, 
		newly created document identifier.</li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="InShort"></a>In Short</h2>
<p>This use case illustrates to an end user how to create new documents to attach 
to the selected product. It is an interactive UC, where the end-user selects a Product 
inside the Search window. Then New document gets creates and further it attached 
to the selected product.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="References"></a>References</h2>
<table class="reference">
	<tr>
		<td>[1]</td>
		<td>
		<a href="../CAADocUseCases/CAADocRunSample.htm">
		Building and Launching a Use Case</a></td>
	</tr>
	<tr>
		<td>[2]</td>
		<td><a href="CAADocUcDisplayingAtrributes.htm">Displaying Document Properties</a></td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="History">History</a></h2>
<table class="history">
	<tr>
		<td>Version: 1 [Jul 2011]</td>
		<td>Document created</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
