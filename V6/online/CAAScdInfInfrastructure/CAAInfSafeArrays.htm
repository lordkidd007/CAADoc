<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
<meta http-equiv="Content-Language" content="en-us" />
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta name="devlang" content="idl" />
<link rel="stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css"/>
<script type="text/javascript" src="../CAADocJavaScript/DSDocTocToc.js">/* */</script>
<script type="text/javascript" src="../CAADocJavaScript/DSDocHighlight.js">/* */</script>
<script type="text/javascript" src="../CAADocJavaScript/submit.js">/* */</script>
<title>About SafeArrayVariant</title>
</head>

<body onload="highlightSearchTerms();">

<table class="DocHeader">
	<tbody>
	<tr>
		<td class="DocHeader1">
		<h1><a name="Top"></a>About SafeArrayVariant</h1>
		</td>
	</tr>
</tbody>
</table>
<p>Many methods which return a value do not return a single value, but an array
of values. For example, the <strong>GetOrigin</strong> property of the <strong>Viewpoint3D</strong> object
returns a 3D point as an array of three coordinates. This array is returned as
an output argument.</p>
<p>Such arguments are visible in the VB/VBA object browser as a <strong>variant</strong> 
but the reference documentation lists them as <strong>CATSafeArrayVariant</strong>.</p>
<p>You can retrieve in the <strong>MyVPOrigin</strong> variable the
origin of the 3D viewpoint of the active viewer in the active window as follows:</p>
<pre class="code">ReDim MyVPOrigin(2)
CATIA.ActiveWindow.ActiveViewer.Viewpoint3D.GetOrigin MyVPOrigin</pre>
<p>You should directly use the ReDim statement to assign a size to the array 
while declaring it as a variable size array, and then call the GetOrigin method.
Assigning a size of 2 allocates an array containing three values.</p>
<p>To access each coordinate, you need to go deeper:</p>
<ul>
  <li>The x coordinate is in <strong>MyVPOrigin(0)</strong></li>
  <li>The y coordinate is in <strong>MyVPOrigin(1)</strong></li>
  <li>The z coordinate is in <strong>MyVPOrigin(2)</strong></li>
</ul>
<p>Contrary to collections, a CATSafeArrayVariant&#39;s index begins at 0. To set a new
triplet of values, you can write:</p>
<pre class="code">MyVPOrigin = Array(150, 200, 50)
CATIA.ActiveWindow.ActiveViewer.Viewpoint3D.PutOrigin MyVPOrigin</pre>
<p>or</p>
<pre class="code">CATIA.ActiveWindow.ActiveViewer.Viewpoint3D.PutOrigin Array(150, 200, 50)</pre>
<p>But to modify the y coordinate only, write:</p>
<pre class="code">MyVPOrigin(1) = 200
CATIA.ActiveWindow.ActiveViewer.Viewpoint3D.PutOrigin MyVPOrigin</pre>
<p>When you don&#39;t know the size of an array, use the UBound function. It returns
the rank of the highest element in the array. For example the following example
returns 2 in Highestrank:</p>
<pre class="code">Highestrank = Ubound(MyVPOrigin)</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
