<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="en-us" http-equiv="Content-Language" />
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
<link href="../CAADocStyleSheets/caav5.css" rel="stylesheet" type="text/css"/>
<script src="../CAADocJavaScript/DSDocTocToc.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/DSDocHighlight.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/submit.js" type="text/javascript">/* */</script>
<title>Creating an Add-in of the Generative Shape Design App</title>
</head>

<body onload="highlightSearchTerms();">

<table class="DocHeader">
	<tr>
		<td class="DocHeader1">
		<h1><a name="Top"></a>Creating an Add-in of the Generative Shape Design App</h1>
		</td>
	</tr>
	<tr>
		<td class="use">Use Case</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table class="abstract">
	<tr>
		<td>
		<h2>Abstract</h2>
		<p>This use case completes the Generative Shape Design app by adding a new 
		section of the action bar 
		containing the Combined Curve commands.</p>
		<ul>
			<li><a href="#Learn">What You Will Learn With This Use Case</a></li>
			<li><a href="#UseCase">The CAAMmrCombinedCurveAddIn Use Case</a>
				<ul>
					<li><a href="#What">What Does CAAMmrCombinedCurveAddIn Do</a></li>
					<li><a href="#How">How to Launch CAAMmrCombinedCurveAddIn</a></li>
					<li><a href="#Where">Where to Find the CAAMmrCombinedCurveAddIn 
						Code</a></li>
				</ul>
			</li>
			<li><a href="#Step">Step-by-Step</a></li>
			<li><a href="#InShort">In Short</a></li>
			<li><a href="#References">References</a></li>
		</ul>
		</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Learn"></a>What You Will Learn With This Use Case</h2>
<p>This use case creates a new section of the action bar for the Generative Shape Design 
app containing the Combined Curve commands .</p>
<p>Thanks to this Use Case, the newborn Combined Curve Mechanical Feature is fully integrated with other Shape Design Features, in a 
section of the action bar named &quot;CAA MechMod Extend UC&quot;.</p>
<p><img alt="" src="images/CAAMmrCombCrvToolbar.jpg" width="411" height="180"/></p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="UseCase"></a>The CAAMmrCombinedCurveAddIn Use Case</h2>
<p>CAAMmrCombinedCurveAddIn is a use case of the CAAMechanicalModelerExtend.edu 
framework that illustrates the Mechanical Modeler&nbsp; capabilities.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="What"></a>What Does the CAAMmrCombinedCurveAddIn Use Case Do</h3>
<p>This use case creates an add-in implementing the <em>CATIShapeDesignWorkshopAddin</em> 
interface. This interface is precisely defined to add commands to the 
Generative Shape Design app.</p>
<p>Another use case describes in detail how to create an add-in [<a href="#References">1</a>].</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="How"></a>How to Launch CAAMmrCombinedCurveAddIn</h3>
<p>See the section entitled &quot;How to Launch the Combined Curve Use Case&quot; 
in the &quot;<a href="CAAMmrUcCombinedCurveSamplesOverview.htm">Creating a New Geometrical 
Feature: the Combined Curve</a>&quot; use case for a detailed description of how 
this use case should be launched.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Where"></a>Where to Find the CAAMmrCombinedCurveAddIn Code</h3>
<p>The CAAMmrCombinedCurveAddIn use case is made of a several classes located in 
the CAAMmrCombinedCurveAddIn.m module of the CAAMechanicalModelerExtend.edu framework:</p>
<p><code>InstallRootFolder\CAADoc\CAAMechanicalModelerExtend.edu\CAAMmrCombinedCurveAddIn.m\</code></p>
<p>where <code>InstallRootFolder</code> [<a href="#References">3</a>] is the folder 
where the API CD-ROM is installed.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Step"></a>Step-by-Step</h2>
<p>To create the add-in, you should first create a separate module directory to 
store the add-in code. This is CAAMmrCombinedCurveAddIn.m for this use case.</p>
<p>In this module, you have to:</p>
<ul>
	<li><a href="#Step1">Creating the Add-in Description Class</a></li>
	<li><a href="#Step2">Creating the Command Headers</a></li>
	<li><a href="#Step3">Creating the Toolbar and Arranging the Command</a></li>
	<li><a href="#Step4">Providing the Resources</a></li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step1"></a>Creating the Add-in Description Class</h3>
<p>The add-in extends the <em>CAAMmrCombinedCurveAddin</em> late type to implement 
the interface <em>CATIShapeDesignWorkshopAddin</em>.</p>
<pre class="code">CATImplementClass(CAAEMmrCombinedCurveAdn,
                  DataExtension,
                  CATBaseUnknown,
                  <strong>CAAMmrCombinedCurveAddin</strong>);

#include &lt;TIE_CATIShapeDesignWorkshopAddin.h&gt; // needed to tie the implementation to its interface
TIE_CATIShapeDesignWorkshopAddin(CAAEMmrCombinedCurveAdn);</pre>
<p>Do not forget to update your dictionary. <em>CAAMmrCombinedCurveAddin</em> is 
extended to implement <em>CATIShapeDesignWorkshopAddin</em>.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step2"></a>Creating the Command Header</h3>
<p>Here we create the command header. Each command available in your add-in must 
have a command header.</p>
<p>To create the Command Header, use the <code>CreateCommands</code> method[<a href="#References">1</a>]:</p>
<pre class="code">void CAAEMmrCombinedCurveAdn::<strong>CreateCommands</strong>()
{
  CATAfrCommandHeader::CATCreateCommandHeader("<strong>CAAMmrCombinedCurveHdr</strong>",   
                                              "CAAMmrCombinedCurveUI",                        
                                              "CAAMmrCombCrvPanelStCmd",                    
                                              (void *)NULL,                                  
                                              "CAAEMmrCombinedCurveAdnHeader",		          
                                              CATFrmAvailable);
  ...
}
</pre>
<p>A call to <code>CATAfrCommandHeader::CATCreateCommandHeader</code> creates command 
header, arguments are as follows.</p>
<ul>
	<li>&quot;<strong>CAAMmrCombinedCurveHdr</strong>&quot; is the identifier you 
		assign to the Command Header.</li>
	<li>&quot;<strong>CAAMmrCombinedCurveUI</strong>&quot; is the shared library 
		or DLL containing the Combined Curve Command's code.</li>
	<li>&quot;<strong>CAAMmrCombCrvPanelStCmd</strong>&quot; is the name of the 
		Combine Curve Edition Command.</li>
	<li>The last argument is the possible pointer to the object to pass to the command 
		when executing it.</li>
	<li><strong>CAAEMmrCombinedCurveAdnHeader</strong> the resource files name. 
		e.g. CAAEMmrCombinedCurveAdnHeader.CATNls and CAAEMmrCombinedCurveAdnHeader.CATRsc.</li>
	<li><strong>CATFrmAvailable</strong> defines the availability of the command.</li>
</ul>
<p>The <em>CAAMmrCombCrvPanelStCmd</em> class enables to create or edit an Combined 
Curve feature. You can refer to the &quot;Editing Combined Curves&quot; use case 
[<a href="#References">2</a>] for details about this command class.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step3"></a>Creating the Section and Arranging the Command</h3>
<p>Finally, we'll create a section of the action bar and arrange the command. This is the job of 
the <code><strong>CreateToolbars</strong></code> method.</p>
<pre class="code">CATCmdContainer* CAAEMmrCombinedCurveAdn::<strong>CreateToolbars</strong>()
{
  NewAccess(CATCmdContainer, pCAACCSection,CAACCSection);
  
  NewAccess(CATCmdContainer, pCombinedCurveTlb, CAAMmrCombinedCurveTlb);
  AddAccessChild(pCAACCSection, pCombinedCurveTlb);
  
  NewAccess(CATCmdStarter, pCombinedCurve, CAAMmrCombinedCurveStr);
  SetAccessCommand(pCombinedCurve, "CAAMmrCombinedCurveHdr");
  SetAccessChild(pCombinedCurveTlb, pCombinedCurve);
  
  return <strong>pCAACCSection</strong>;
}</pre>
<ul>
	<li>The &quot;CAA MechMod Extend UC&quot; section is created as an instance of the <em>CATCmdContainer</em> 
		class using the <code>NewAccess</code> macro. <code>pCAACCSection</code> 
		is the variable used to handle the section container 
		instance pointer, and <code>CAACCSection</code> is the identifier used 
		to refer to it in the add-in resource files.<br />
		
	<li>A command cannot be declared directly under a section, therfore we need 
	to declare an intermediary level, which is a logical grouping of commands 
	within a section. This Combined Curve group is created as an instance of the <em>CATCmdContainer</em> 
		class using the <code>NewAccess</code> macro. pCombinedCurveTlb is the 
	variable used to handle this Combined Curve group container instance 
	pointer, which is set as childl of the &quot;CAA MechMod Extend UC&quot; section.&nbsp;&nbsp; <br />

		
	<li>Three macros are required for each command.
		<ol>
			<li>First, the command starter is created as a <em>CATCmdStarter</em> 
				instance using the <code>NewAccess</code> macro. <code>pCombinedCurve</code> 
				is the variable used to handle a pointer to that instance, and
				<code>CAAMmrCombinedCurveStr</code> is its identifier.</li>
			<li>Then the Combined Curve command header is associated with this command 
				starter using the <code>SetAccessCommand</code> macro.</li>
			<li>Finally the Combined Curve command starter is set as the child of 
				the Combined Curve group.</li>
			<li>Beware that the method returns the highest level of container, here it's the section 
			container, pCAACCSection.</li>

		</ol>
	</li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step4"></a>Providing the Resources</h3>
<p>You should provide the resources for the section and commands.</p>
<ul>
	<li><strong>CAAEMmrCombinedCurveAdnHeader.CATRsc</strong> contains information 
		about the icon to display.
		<pre class="code">CAAEMmrCombinedCurveAdnHeader.CombinedCurve.Icon.Normal  = &quot;CAAMmr_I_CombinedCurve&quot;;</pre>
		<table>
			<tr>
				<td>
				<img alt="" src="images/CAAMmr_I_CombinedCurve.jpg" width="34" height="39"/></td>
				<td>You provide the &quot;normal&quot; icon. It must be located 
				in the resources/graphic directory. The pressed and focused are 
				automatically generated.</td>
			</tr>
		</table>
	</li>
	<li><strong>CAAEMmrCombinedCurveAdnHeader.CATNls</strong> contains text message 
		in English if located in the CNext\Resources\msgcatalog directory.
		<pre class="code">CAAEMmrCombinedCurveAdnHeader.CombinedCurve.Title     = <strong>&quot;CombinedCurve&quot;</strong>;
CAAEMmrCombinedCurveAdnHeader.CombinedCurve.ShortHelp = <strong>&quot;CAAMmrCombinedCurve&quot;</strong>;
CAAEMmrCombinedCurveAdnHeader.CombinedCurve.Help      = <strong>&quot;Creates a Combined Curve&quot;</strong>;
CAAEMmrCombinedCurveAdnHeader.CombinedCurve.LongHelp  = <strong>&quot;Combined Curve using two curves and two directions</strong>&quot;;
CAAEMmrCombinedCurveAdnHeader.CombinedCurve.Category  = <strong>&quot;Insert&quot;;</strong></pre>
		<p>If you want to provide help for this new command in several languages, 
		just copy (and translate!) this file in CNext\Resources\msgcatalog\German 
		for German, CNext\Resources\msgcatalog\Japanese for Japanese, CNext\Resources\msgcatalog\French 
		for French, etc.</p>
	</li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="InShort"></a>In Short</h2>
<p>Thanks to the add-in technology, this last use case of the Combined Curve 
sample makes it possible to create a Combined Curve by clicking on an icon of the 
Generative Shape Design app. Combined Curves are now perfectly integrated in Mechanical 
Design applications.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="References"></a>References</h2>
<table class="reference">
	<tr>
		<td>[1]</td>
		<td>
		<a href="../CAAAfrApplicationFrame/CAAAfrUcSampleAddin.htm">
		Creating an Add-in</a></td>
	</tr>
	<tr>
		<td>[2]</td>
		<td><a href="CAAMmrUcCombinedCurveCATIEdit.htm">Editing Combined Curves</a></td>
	</tr>
	<tr>
		<td>[3]</td>
		<td>
		<a href="../CAADocUseCases/CAADocRunSample.htm">
		Building and Launching a Use Case</a></td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="History"></a>History</h2>
<table class="history">
	<tr>
		<td>Version: <strong>1</strong> [Mar 2000]</td>
		<td>Document created</td>
	</tr>
	<tr>
		<td>Version: <strong>2</strong> [Jan 2003]</td>
		<td>Document updated</td>
	</tr>
	<tr>
		<td>Version: <strong>3</strong> [Mai 2014]</td>
		<td>Document updated for 3DEXPERIENCE platform migration</td>
 </tr>

</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
