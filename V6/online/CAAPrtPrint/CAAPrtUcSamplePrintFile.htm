<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="en-us" http-equiv="Content-Language" />
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
<link href="../CAADocStyleSheets/caav5.css" rel="stylesheet" type="text/css"/>
<script src="../CAADocJavaScript/DSDocTocToc.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/DSDocHighlight.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/submit.js" type="text/javascript">/* */</script>
<title>Printing Files</title>
</head>

<body onload="highlightSearchTerms();">

<table class="DocHeader">
	<tr>
		<td class="DocHeader1">
		<h1><a name="Top"></a>Printing Files</h1>
		</td>
	</tr>
	<tr>
		<td class="use">Use Case</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table class="abstract">
	<tr>
		<td>
		<h2>Abstract</h2>
		<p>This article shows how to print a given object on a printer.</p>
		<ul>
			<li><a href="#Learn">What You Will Learn With This Use Case</a></li>
			<li><a href="#UseCase">The CAAPrtPrintFile Use Case</a>
				<ul>
					<li><a href="#What">What Does CAAPrtPrintFile Do</a></li>
					<li><a href="#How">How to Launch CAAPrtPrintFile</a></li>
					<li><a href="#Where">Where to Find the CAAPrtPrintFile Code</a></li>
				</ul>
			</li>
			<li><a href="#Step">Step-by-Step</a></li>
			<li><a href="#InShort">In Short</a></li>
			<li><a href="#References">References</a></li>
		</ul>
		</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Learn"></a>What You Will Learn With This Use Case</h2>
<p>This use case is intended to show how to print a given object on a printer.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="UseCase"></a>The CAAPrtPrintFile Use Case</h2>
<p>CAAPrtPrintFile is a use case of the CAAPrint.edu framework that illustrates 
the Print framework capabilities.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="What"></a>What Does CAAPrtPrintFile Do</h3>
<p>CAAPrtPrintFile is a batch program that reads a JPEG file from the command line 
and prints it on the chosen printer.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="How"></a>How to Launch CAAPrtPrintFile Use</h3>
<p>To launch CAAPrtPrintFile Use, you will need to set up the build time environment, 
then compile CAAPrtPrintFile Use along with its prerequisites, set up the run time 
environment, and then execute the use case [<a href="#References">1</a>].</p>
<p>You can launch CAAPrtPrintFile using a JPEG file as argument. The use case lists 
the available printers and then type the number associated to the chosen printer, 
the input JPEG file is printed on the chosen printer.</p>
<pre class="code">E:&gt;<strong>CAAPrtPrintFile</strong>  InstallRootFolder\CAADoc\CAAPrint.edu\CNext\resources\graphic\images\CAAPrtPrintFile.jpg</pre>
<p>where:</p>
<ul>
	<li><code>InstallRootFolder</code> [<a href="#References">1</a>] is the folder 
		where the API CD-ROM is installed.</li>
	<li><code>CAAPrtPrintFile.jpg</code> is the sample JPEG file supplied. You can 
		use other JPEG files you may have at hand.</li>
</ul>
<table>
	<caption>The CAAPrtPrintFile.jpg File</caption>
	<tr>
		<td>
		<img alt="CAAPrtPrintFile.jpg File" height="800" src="images/CAAPrtSamplePrintFile.jpg" width="400"/></td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Where"></a>Where to Find the CAAPrtPrintFile Use Code</h3>
<p>The CAAPrtPrintFile use case is made of a several classes located in the CAAPrtPrintFile.m 
module of the CAAPrint.edu framework:</p>
<p><code>InstallRootFolder\CAADoc\CAAPrint.edu\CAAPrtPrintFile.m\</code></p>
<p>where <code>InstallRootFolder</code> [<a href="#References">1</a>] is the folder 
where the API CD-ROM is installed.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Step"></a>Step-by-Step</h2>
<p>To print a JPEG file on aprinter, there are seven main steps:</p>
<table>
	<colgroup span="3" valign="top">
	</colgroup>
	<tr>
		<th>#</th>
		<th>Step</th>
		<th>Where</th>
	</tr>
	<tr>
		<td>1</td>
		<td><a href="#Step1">Displays the List of Printers</a></td>
		<td>main</td>
	</tr>
	<tr>
		<td>2</td>
		<td><a href="#Step2">Asks the End User for a Printer Choice</a></td>
		<td>main</td>
	</tr>
	<tr>
		<td>3</td>
		<td><a href="#Step3">Creates a Print File Image from the Input File</a></td>
		<td>main</td>
	</tr>
	<tr>
		<td>4</td>
		<td><a href="#Step4">Creates a Printer Device</a></td>
		<td>main</td>
	</tr>
	<tr>
		<td>5</td>
		<td><a href="#Step5">Defines Print Parameters</a></td>
		<td>main</td>
	</tr>
	<tr>
		<td>6</td>
		<td><a href="#Step6">Prints the Image</a></td>
		<td>main</td>
	</tr>
	<tr>
		<td>7</td>
		<td><a href="#Step7">Cleans the application</a></td>
		<td>main</td>
	</tr>
</table>
<p>The preliminary task that consist in retrieving the input file name from the 
command line is not described. The input file name is retrieved from the command 
line in the <code>InputName</code> variable, such as TestFile.jpg.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step1"></a>Displaying the List of Printers</h3>
<p>As soon as the input file is retrieved, the list of available printers is displayed.</p>
<pre class="code">#include &quot;CATPrintFileImage.h&quot;   <em>// To create an image from the input file</em>
#include &quot;CATPrintParameters.h&quot;  <em>// To define print parameters</em>
#include &quot;CATPrinterDevice.h&quot;    <em>// To define a print device</em>
#include &quot;CATPrinterManager.h&quot;   <em>// To retrieve the printer list</em>
#include &quot;CATPrinter.h&quot;          <em>// To print</em>
...

int main(int argc, char* argv[])
{
  int ReturnCode = 0;
  ... <em>// Retrieving the input file name is not described here</em>
     
  <strong>CATPrinterManager::Begin();</strong>

  // Retrieves and displays the list of printers
  cout &lt;&lt; &quot;Available printers: &quot; &lt;&lt; endl &lt;&lt; endl;

  for (int i=0; i&lt;<strong>CATPrinterManager::GetPrinterCount()</strong>; i++)
  {
    CATPrinter printer = <strong>CATPrinterManager::GetPrinterFromIndex(i)</strong>;
    int old_width = cout.width(3);
    cout.setf( ios::right );
    cout &lt;&lt; i+1;
    cout.setf( ios::left );
    //cout.width(old_width);
    cout &lt;&lt; &quot; : &quot; &lt;&lt; (const char*) <strong>printer.GetDescription()</strong> &lt;&lt; endl;
  }
  ...</pre>
<p>This printer manager is initialized using the static <code>Begin</code> method. 
Then for each available printer, the printer description is retrieved using the
<code>GetDescription</code> method of the CATPrinter class, and displayed, associated 
with its number. The static <code>GetPrinterCount</code> method returns the number 
of available printers.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step2"></a>Asking the End User for a Printer Choice</h3>
<p>The end user should now select a printer.</p>
<pre class="code">...
  CATPrinter printer = <strong>CATPrinterManager::GetPrinterFromIndex</strong>(printerIndex);
  <strong>CATPrinterManager::End();</strong>
...</pre>
<p>The printer is selected using its index. This index is used to retrieve the printer. 
As soon as this is done, the printer manager becomes useless and can freed using 
the static <code>End</code> method.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step3"></a>Creating a Print File Image from the Input File</h3>
<p>The print file image can now be built from the input file.</p>
<p>A print parameter object should be defined to be associated with the print file 
image to convert.</p>
<pre class="code">...
  CATPrintFileImage* image = new <strong>CATPrintFileImage</strong>(InputName, &quot;JPEG&quot;);
...</pre>
<p>This print file image is an instance of the CATPrintFileImage class instantiated 
from the input file. The input file format is passed as the second argument, here 
JPEG. The print file image created holds the input file in memory and the JPEG interpreter 
to enable the file interpretation as soon as this will be asked.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step4"></a>Creating a Printer Device</h3>
<p>The printer device should be next instantiated.</p>
<pre class="code">...
  CATPrinterDevice device( &amp;printer );
...</pre>
<p>The printer device is created using the selected printer as input. It is made 
of a generator for the printer format, and of of a stream into which the created 
file will be written.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step5"></a>Defining Print Parameters</h3>
<p>A print parameter object should be defined to be associated with the print file 
image to print.</p>
<pre class="code">...
  CATPrintParameters parameters;

  parameters.SetRotation( CATPRINTCCW_90 );     <em> // Rotate the image</em> 
  parameters.SetMapToPaper(1);                   <em>// Resize image to match paper forma</em>t
  parameters.SetMargins(20.0, 20.0, 10.0, 10.0); <em>// Set margins</em>
...</pre>
<p>The print parameters are taken into account to create the printed output. The 
following parameters are set:</p>
<ul>
	<li>The image is rotated by 90 degrees.</li>
	<li>The image is resized to match the paper size.</li>
	<li>The margins are set to 20 mm for left and right margins, and to 10 mm for 
		top and bottom margins.</li>
</ul>
<p>Other print parameters take their default values.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step6"></a>Printing the Image</h3>
<p>The file conversoin can now take place.</p>
<pre class="code">...
  image-&gt;<strong>Print</strong>( &amp;device, parameters );
...</pre>
<p>The <code>Print</code> method converts the print file image from JPEG to the 
printer format, usually PostScript, and prints the file using the parameters set.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step7"></a>Cleaning the Application</h3>
<pre class="code">...
  delete image;

  return ReturnCode;
...</pre>
<p>Simply don't forget to delete allocated objects, and return the appropriate return 
code.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="InShort"></a>In Short</h2>
<p>This use case shows the objects involved when printing a file, here encoded using 
JPEG, on a printer. These objects are the pinter manager, the printer, print file 
image, the printer device, and the set of parameters that are needed to print.</p>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="References"></a>References</h2>
<table class="reference">
	<tr>
		<td>[1]</td>
		<td>
		<a href="../CAADocUseCases/CAADocRunSample.htm">
		Building and Launching a Use Case</a></td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="History"></a>History</h2>
<table class="history">
	<tr>
		<td>Version: <strong>1</strong> [Jan 2000]</td>
		<td>Document created</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
