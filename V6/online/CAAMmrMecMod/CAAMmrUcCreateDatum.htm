<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="en-us" http-equiv="Content-Language" />
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
<link href="../CAADocStyleSheets/caav5.css" rel="stylesheet" type="text/css"/>
<script src="../CAADocJavaScript/DSDocTocToc.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/DSDocHighlight.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/submit.js" type="text/javascript">/* */</script>
<title>Managing Create Datum Mode</title>
</head>

<body onload="highlightSearchTerms();">

<table class="DocHeader">
	<tr>
		<td class="DocHeader1">
		<h1><a name="Top"></a>Managing Create Datum Mode</h1>
		</td>
	</tr>
	<tr>
		<td class="use">Use Case</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table class="abstract">
	<tr>
		<td>
		<h2>Abstract</h2>
		<p>This article discusses the <strong>CAAMmrCreateDatumMode</strong> use 
		case. This use case explains how to use the <em>CATIMmiPartInfrastructurePreferencesAtt</em> 
		interface to control the datum mode when creating a mechanical feature. 
		Datum mode is explained in the technical article &quot;The Geometrical Features&quot; 
		[<a href="#References">1</a>].</p>
		<ul>
			<li><a href="#Learn">What You Will Learn With This Use Case</a></li>
			<li><a href="#UseCase">The CAAMmrCreateDatumMode Use Case</a>
				<ul>
					<li><a href="#What">What Does CAAMmrCreateDatumMode Do</a></li>
					<li><a href="#How">How to Launch CAAMmrCreateDatumMode</a></li>
					<li><a href="#Where">Where to Find the CAAMmrCreateDatumMode 
						Code</a></li>
				</ul>
			</li>
			<li><a href="#Step">Step-by-Step</a></li>
			<li><a href="#InShort">In Short</a></li>
			<li><a href="#References">References</a></li>
		</ul>
		</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Learn"></a>What You Will Learn With This Use Case</h2>
<p>This use case is an interactive command: <code>CAAMmrDatumWindowCmd</code>. It 
is intended to show you how to use the <em><strong>CATIMmiPartInfrastructurePreferencesAtt</strong></em> 
interface to manage the CreateDatum mode:</p>
<ul>
	<li>To change or Retrieve the current mode.</li>
	<li>To be informed when the current mode is modified by another command.</li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="UseCase"></a>The CAAMmrCreateDatumMode Use Case</h2>
<p>CAAMmrCreateDatumMode is a use case of the CAAMechanicalModeler.edu framework 
that illustrates CATMecModUseItf framework capabilities.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="What"></a>What Does CAAMmrCreateDatumMode Do</h3>
<p>The use case is functionally similar to the CreateDatum Setting command, that 
you can retrieve in the &quot;App Options&quot; panel of Generative Shape Design app.
<img alt="" src="images/I_IsolatedCAA.jpg" width="32" height="30"/>.</p>
<p>The scenario to reach the command is the following:</p>
<ul>
	<li>Launch 3DEXPERIENCE and login</li>
	<li>Launch <kbd>Generative Shape Design</kbd> app </li>
	<li>Activate <kbd>CAA MechMod UC</kbd> section in action bar </li>
	<li>Launch <kbd>UseCreateDatumMode</kbd> Command [<a name="Fig1"></a>Fig.1].
		<p>
		<img alt="" src="images/CAAMmrCreateDatumModeCmd.png" width="35" height="37"/></p>
	</li>
	<li>The following dialog box is opened:
		<table>
			<caption><a name="Fig2"></a>Fig.2 CAAMmrCreateDatumMode Dialog Box</caption>
			<tr>
				<td><img alt="" height="126" src="images/CAAMmrCreateDatumModeDlg.png" width="486"/></td>
			</tr>
		</table>
		<ul>
			<li><strong>First line</strong>: On the top right, you have the current 
				value of the datum mode.</li>
			<li><strong>Second line</strong>: a combo to select the new mode, and 
				a push button (<strong>Apply</strong>) to modify the current mode. 
				Push Apply button modifies the current value just above.</li>
		</ul>
	</li>
	<li>Close the dialog box to end the command.</li>
</ul>
<p>Now some scenarios to understand the meaning of each type of datum mode.</p>
<ul>
	<li>Make sure the &quot;App Options&quot; panel is displayed - check that the &quot;Create Datum&quot; 
	button is unpushed:
	<img alt="" src="images/I_IsolatedCAA.jpg" width="32" height="30"/></li>
	<li>Create three points.</li>
	<li>Launch <kbd>UseCreateDatumMode</kbd> Command, a dialog box is opened.
	<li>Choose the &quot;<strong>NoDatumCreation</strong>&quot; mode.
		<p>The &quot;Create Datum&quot; button is still unpushed:
		<img alt="" src="images/I_IsolatedCAA.jpg" width="32" height="30"/></p>
	</li>
	<li>Create a line - the line is an associative feature : modify the position 
		of one point, the line is updated.
		<p>After the line creation, the &quot;Create Datum&quot; button is still unpushed:
		<img alt="" src="images/I_IsolatedCAA.jpg" width="32" height="30"/></p>
	</li>
	<li>Choose the &quot;<strong>DatumCreationTemporary</strong>&quot; mode, and 
		Push the Apply button
		<p>The icon of CreateDatum Setting is now in pushed position
		<img alt="" src="images/CAAMmrCreateDatumModeIcon.png" width="30" height="31"/>.</p>
	</li>
	<li>Create a line - the line is no longer an associative feature: modify the 
		position of one point, the line is not updated.
		<p>After the line creation, the &quot;Create Datum&quot; button is now unpushed 
		again
		<img alt="" src="images/I_IsolatedCAA.jpg" width="32" height="30"/> and 
		the Current state in the dialog is <strong>NoDatumCreation</strong>.</p>
	</li>
	<li>Choose the &quot;<strong>DatumCreationPermanent</strong>&quot; mode, and 
		Push the Apply button
		<p>The &quot;Create Datum&quot; button is now pushed
		<img alt="" height="33" src="images/CAAMmrCreateDatumModeIcon.png" width="29"/></p>
	</li>
	<li>Create a line - the line isn't an associative feature : modify the position 
		of one point, the line is not updated.
		<p>After the line creation, the &quot;Create Datum&quot; button is still pushed:
		<img alt="" height="33" src="images/CAAMmrCreateDatumModeIcon.png" width="29"/>
		and the Current state in the dialog is still <strong>DatumCreationPermanent</strong>.</p>
	</li>
	<li>Push the &quot;Create Datum&quot; Setting button, the icon is now
	<img alt="" src="images/I_IsolatedCAA.jpg" width="32" height="30"/>.
		<p>In the dialog box, the name of the current mode is <strong>NoDatumCreation</strong>.</p>
	</li>
	<li>Push the &quot;Create Datum&quot; Setting button, the icon is now
		<img alt="" height="33" src="images/CAAMmrCreateDatumModeIcon.png" width="29"/>.
		<p>In the dialog box, the name of the current mode is <strong>DatumCreationTemporary</strong>.</p>
	</li>
</ul>
<p>This scenario shows that the datum mode is kept by a setting (<strong>data model</strong>). 
When the value of this setting is modified, an event is sent, and whoever has set 
a callback on the event is informed of the modification.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="How"></a>How to Launch CAAMmrCreateDatumMode</h3>
<p>To launch CAAMmrCreateDatumMode, you will need to set up the build time environment, 
then compile CAAMmrCreateDatumMode along with its prerequisites, set up the run 
time environment, and then execute the use case.</p>
<p>See the <a href="#What">What Does CAAMmrCreateDatumMode Do</a> Section for the 
scenario.</p>
<p><a name="Addin"></a><strong>Addin Access</strong></p>
<p>Before launching CATIA, you must modify <code>CAAMechanicalModeler.edu.dico</code>.</p>
<p>Remove #CAA# in front of the following lines:</p>
<pre class="code">...
#CAA# CAAMmrSettingsAddIn      CATIWorkbenchAddin              libCAAMmrSettingsAddIn
#CAA# CAAMmrSettingsAddIn      CATIShapeDesignWorkshopAddin    libCAAMmrSettingsAddIn
...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Where"></a>Where to Find the CAAMmrCreateDatumMode Code</h3>
<p>The CAAMmrCreateDatumMode use case is made of several classes located in two 
modules:</p>
<ul>
	<li>CAAMmrUseCreateDatumMode.m module of the CAAMechanicalModeler.edu framework.
		<p>It contains the CAAMmrCreateDatumMode Dialog box [<a href="#Fig2">Fig.2</a>] 
		definition: <code>CAAMmrDatumWindowCmd.cpp</code>:</p>
	</li>
	<li>CAAMmrSettingsAddIn.m module of the CAAMechanicalModeler.edu framework
		<p>It contains the add-in of the Generative Shape Design app. This 
		add-in contains the definition of the &quot;Use Create Datum Mode&quot; 
		[<a href="#Fig1">Fig.1</a>] toolbar.</p>
		<p>This part is not described in the article. Refer to the reference article
		<em>Creating an Add-in</em> [<a href="#References">2</a>].</p>
	</li>
</ul>
<p>These two modules are located inside:</p>
<p><code>InstallRootFolder\CAADoc\CAAMechanicalModeler.edu</code></p>
<p>where <code>InstallRootFolder</code> [<a href="#References">3</a>] is the folder 
where the API CD-ROM is installed.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Step"></a>Step-by-Step</h2>
<p>There are five logical steps in CAAMmrCreateDatumMode use case:</p>
<ol>
	<li><a href="#Step1">Retrieving the Component Managing the Datum Mode</a></li>
	<li><a href="#Step2">Adding Callback for Datum Mode Modification</a></li>
	<li><a href="#Step3">Refreshing the Dialog Box</a></li>
	<li><a href="#Step4">Modifying the Current Datum Mode</a></li>
	<li><a href="#Step5">Removing Callback</a></li>
</ol>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step1"></a>Retrieving the Component Managing the Datum Mode</h3>
<pre class="code">...
HRESULT rc = S_OK;
rc = ::CATInstantiateComponent (&quot;<strong>CATMmuPartInfrastructurePreferencesCtrl</strong>&quot;,
                                IID_CATIMmiPartInfrastructurePreferencesAtt,
                                (void**) &amp;_piCATIMmiCreateDatumSettingAtt);  
...</pre>
<p><code>_piCATIMmiCreateDatumSettingAtt</code> is a data member of the <strong>
CAAMmrCreateDatumMode</strong> dialog box. It is a <em>CATIMmiPartInfrastructurePreferencesAtt</em> 
interface pointer on the <code>CATMmuPartInfrastructurePreferencesCtrl</code> component.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step2"></a>Adding Callback for Datum Mode Modification</h3>
<pre class="code">...
CATCallbackEvent eventName=&quot;&quot;;
<strong>_piCATIMmiCreateDatumSettingAtt</strong>-&gt;<strong>GetDatumModeEvent</strong>(eventName);

::<strong>AddCallback</strong>(this,
              _piCATIMmiCreateDatumSettingAtt,<strong>eventName</strong>,
              (CATSubscriberMethod)&amp;CAAMmrDatumWindowCmd::<strong>ReceiveDatumModify</strong>, 
               NULL);
...</pre>
<p>Thanks to the <code>GetDatumModeEvent</code> method, you retrieve the name of 
the event which will be sent by the <code>CATMmuPartInfrastructurePreferencesCtrl</code> 
component when someone modifies the datum mode. The <code>ReceiveDatumModify</code> 
is a method of the dialog box that refreshes the dialog box.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step3"></a>Refreshing the Dialog Box</h3>
<p>This method is called by two methods of the dialog box:</p>
<ul>
	<li>The constructor (initialization).</li>
	<li><code>The ReceiveDatumModify</code> method (due to a callback).</li>
</ul>
<p>This method (InitWindow) retrieves the current datum mode, and modifies the right 
top editor [<a href="#Fig2">Fig.2</a>].</p>
<pre class="code">...
  CATIMmiPartInfrastructurePreferencesAtt::PreferenceMode TheMode ; 
  rc = _piCATIMmiCreateDatumSettingAtt-&gt;<strong>GetDatumMode</strong>(TheMode);
...</pre>
<p>The editor is modified according to the value of the <code>GetDatumMode</code> 
method results.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step4"></a>Modifying the Current Datum Mode</h3>
<p>In the constructor, not detailed here, we have set a callback to be informed 
when the end user pushes the Apply button. This callback is a method (<code>Apply</code> 
method) whose principle is the following:</p>
<ul>
	<li>Retrieve the combo value:
		<pre class="code">...
   int LineSelected = _pDatumChoice-&gt;<strong>GetSelect</strong>() ;
  _pDatumChoice-&gt;GetLine(usParam[1],LineSelected);
...</pre>
	</li>
	<li>Modify the Datum value:
		<pre class="code">...
  CATIMmiPartInfrastructurePreferencesAtt::PreferenceMode TheMode ;
...
  rc = _piCATIMmiCreateDatumSettingAtt-&gt;<strong>SetDatumMode</strong>(TheMode);
...</pre>
		<p><code>TheMode</code> is valuated according to the value returned by the 
		combo (<code>LineSelected</code>).</p>
	</li>
</ul>
<p>Note that the internal method <code>InitWindow</code> is not directly called 
by the <code>Apply</code> method. Since the <code>SetDatumMode</code> method is 
called, the <code>CATMmuPartInfrastructurePreferencesCtrl</code> component sends 
a Modify event, and the <code>ReceiveDatumModify</code> method is called. See
<a href="#Step2">Adding Callback for Datum Mode Modification</a>.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step5"></a>Removing Callback</h3>
<pre class="code">...
  ::<strong>RemoveSubscriberCallbacks</strong>(this,_piCATIMmiCreateDatumSettingAtt);
...</pre>
<p>In the dialog box destructor method.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="InShort"></a>In Short</h2>
<p>The <em>CATIMmiPartInfrastructurePreferencesAtt</em> interface enables you to 
retrieve the current datum mode and to modify it.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="References"></a>References</h2>
<table class="reference">
	<tr>
		<td>[1]</td>
		<td><a href="CAAMmrTaContentsSpecCont2.htm">The Geometrical Features</a></td>
	</tr>
	<tr>
		<td>[2]</td>
		<td>
		<a href="../CAAAfrApplicationFrame/CAAAfrUcSampleAddin.htm">
		Creating an Add-in</a></td>
	</tr>
	<tr>
		<td>[3]</td>
		<td>
		<a href="../CAADocUseCases/CAADocRunSample.htm">
		Building and Launching a Use Case</a></td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="History"></a>History</h2>
<table class="history">
	<tr>
		<td>Version: <strong>1</strong> [Aug 2006]</td>
		<td>Document created</td>
	</tr>
	<tr>
		<td>Version: <strong>2</strong> [Apr 2010]</td>
		<td>Document updated for V6 novelties</td>
	</tr>
	<tr>
		<td>Version: <strong>3</strong> [Mai 2014]</td>
		<td>Document updated for 3DEXPERIENCE platform migration</td>
	</tr>

</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
