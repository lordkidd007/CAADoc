<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="en-us" http-equiv="Content-Language" />
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
<link href="../CAADocStyleSheets/caav5.css" rel="stylesheet" type="text/css"/>
<script src="../CAADocJavaScript/DSDocTocToc.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/DSDocHighlight.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/submit.js" type="text/javascript">/* */</script>
<title>Creating a Sketch on an Axis System Plane</title>
</head>

<body onload="highlightSearchTerms();">

<table class="DocHeader">
	<tr>
		<td class="DocHeader1">
		<h1><a name="Top"></a>Creating a Sketch on an Axis System Plane</h1>
		</td>
	</tr>
	<tr>
		<td class="use">Use Case</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table class="abstract">
	<tr>
		<td>
		<h2>Abstract</h2>
		<p>This article discusses the <strong>CAAMmrAxisSystemBRep</strong> use 
		case. This use case shows how to use a sub-element of an axis system.
		</p>
		<ul>
			<li><a href="#Learn">What You Will Learn With This Use Case</a></li>
			<li><a href="#UseCase">The CAAMmrAxisSystemBRep Use Case</a>
				<ul>
					<li><a href="#What">What Does CAAMmrAxisSystemBRep Do</a></li>
					<li><a href="#How">How to Launch CAAMmrAxisSystemBRep</a></li>
					<li><a href="#Where">Where to Find the CAAMmrAxisSystemBRep 
						Code</a></li>
				</ul>
			</li>
			<li><a href="#Step">Step-by-Step</a></li>
			<li><a href="#InShort">In Short</a></li>
			<li><a href="#References">References</a></li>
		</ul>
		</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Learn"></a>What You Will Learn With This Use Case</h2>
<p>An axis system is a feature whose geometry consists in a vertex (the origin), 
three edges (three axes) and three planes. These are sub-elements. This use case 
is intended to show you how to:</p>
<ul>
	<li>Retrieve the BRep Access object [<a href="#References">1</a>] associated 
		with one of these sub-elements ,</li>
	<li>Create the BRep feature [<a href="#References">1</a>] from this BRep Access 
		object,</li>
	<li>Create a Sketch based on the BRep feature.</li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="UseCase"></a>The CAAMmrAxisSystemBRep Use Case</h2>
<p><code>CAAMmrAxisSystemBRep</code> is a use case of the <code>CAAMechanicalModeler.edu</code> 
framework that illustrates CATMecModUseItf and CATMecModLiveUseItf frameworks capabilities.
</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="What"></a>What Does CAAMmrAxisSystemBRep Do</h3>
<p>CAAMmrAxisSystemBRep creates an axis system [<a href="#References">2</a>], retrieves 
its XY plane , featurizes it and creates a sketch based on this plane.</p>
<p>The characteristics of the axis system are the following:</p>
<table>
	<caption><a name="Fig1"></a>Fig.1: The Axis System Characteristics</caption>
	<tr>
		<td>
		<img alt="The Axis System Characteristics" height="455" src="images/CAAMmrAxisSystemBRep1.jpg" width="519"/></td>
	</tr>
</table>
<p>The sketch is based on the XY plane, it means in the xz plane of the absolute 
axis system.</p>
<table>
	<caption><a name="Fig2"></a>Fig.2: The Sketch Based on the XY Plane</caption>
	<tr>
		<td><img alt="The Sketch Based on the XY Plane" height="224" src="images/CAAMmrAxisSystemBRep2.jpg" width="357"/></td>
	</tr>
</table>
<p>The above pictures are screen prints of a Representation Reference created by 
the <code>CAAMmrAxisSystemBRep</code> use case. You can find it in a 3D XML file 
located in the following directory:</p>
<p><code>InstallRootFolder\CAADoc\CAAMechanicalModeler.edu\InputData\CAAMmrAxisSystemBRep.3dxml</code></p>
<p>where <code>InstallRootFolder</code> [<a href="#References">3</a>] is the 
folder where the API CD-ROM is installed.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="How"></a>How to Launch CAAMmrAxisSystemBRep</h3>
<p>To launch <code>CAAMmrAxisSystemBRep</code> , you will need to set up the build 
time environment, then compile <code>CAAMmrAxisSystemBRep</code> along with its 
prerequisites, set up the run time environment, and then execute the use case [<a href="#References">3</a>].
</p>
<p>To launch the use case execute the command:</p>
<p><code>mkrun -c &quot;CAAMmrAxisSystemBRep Repository Server User Password SecurityCtx&quot;</code></p>
<p>where:</p>
<table class="fill">
	<tr>
		<th>Repository</th>
		<td>
		<script type="text/javascript">insertRepository();</script>
		</td>
	</tr>
	<tr>
		<th>Server</th>
		<td>The server as <em>Host:port_number/RootURI</em></td>
	</tr>
	<tr>
		<th>User</th>
		<td>The user name</td>
	</tr>
	<tr>
		<th>Password</th>
		<td>The user password to authenticate the user</td>
	</tr>
	<tr>
		<th>SecurityCtx</th>
		<td>A string representing the security context (Role.Organization.Project). 
		Choose Role as Designer(as the use case modifies the PLM data)</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Where"></a>Where to Find the CAAMmrAxisSystemBRep Code</h3>
<p>The <code>CAAMmrAxisSystemBRep</code> use case is made of one module, <code>CAAMmrAxisSystemBRep.m</code>, 
found in the the <code>CAAMechanicalModeler.edu</code> framework and containing 
a single source program, <code>CAAMmrTestBRep.cpp</code>:</p>
<table>
	<tr>
		<td><code>InstallRootFolder\CAADoc\CAAMechanicalModeler.edu\CAAMmrAxisSystemBRep.m\</code></td>
	</tr>
</table>
<p>and one other file exported by the CAAPLMClientAdapter.edu framework:</p>
<p><code>CAAAdpCreateCloseSession.cpp</code> - to create and close a PLM session
</p>
<table>
	<tr>
		<td><code>InstallRootFolder\CAADoc\CAAPLMClientAdapter.edu\CAAAdpUtilities.m\</code></td>
	</tr>
</table>
<p>where <code>InstallRootFolder</code> [<a href="#References">3</a>] is the 
folder where the API CD-ROM is installed.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Step"></a>Step-by-Step</h2>
<p>There are seven logical steps in <code>CAAMmrAxisSystemBRep</code>:</p>
<ol>
	<li><a href="#Step1">Prolog</a></li>
	<li><a href="#Step2">Retrieving the Factory Interface Pointers</a></li>
	<li><a href="#Step3">Creating an Axis System</a></li>
	<li><a href="#Step4">Retrieving the BRep Plane</a></li>
	<li><a href="#Step5">Featurizing the BRep Plane</a></li>
	<li><a href="#Step6">Creating the Sketch</a></li>
	<li><a href="#Step7">Epilog</a></li>
</ol>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step1"></a>Prolog</h3>
<p><code>CAAMmrAxisSystemBRep</code> begins by creating a session and creating a 
new Representation Reference whose data stream is a 3D Shape. Next, it retrieves 
the specification container of this Part as a pointer to <em>CATIMmiPrtContainer</em>,
<code>pIPartContainer.</code> This is the usual sequence for creating a 3D Shape 
[<a href="#References">4</a>].</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step2"></a>Retrieving the Factory Interface Pointers</h3>
<p>There are two factories to retrieve: the axis system and sketch factories. The
<em>CATIMf3DAxisSystemFactory</em> and <em>CATISktUseSketchFactory</em> are both implemented 
by the specification container, <code>pIPartContainer</code> [<a href="#References">5</a>].</p>
<pre class="code">...
  <strong>CATIMf3DAxisSystemFactory</strong> * pIMf3DAxisSystemFactoryOnFeatCont = NULL ;
  rc = pIPartContainer-&gt;QueryInterface(IID_CATIMf3DAxisSystemFactory,
                                      (void **) &amp; pIMf3DAxisSystemFactoryOnFeatCont);</pre>
<pre>  <strong>CATISktUseSketchFactory</strong> * pISketchFactoryOnFeatCont = NULL ;
  rc = pIPartContainer-&gt;QueryInterface(IID_CATISketchFactory,
                                      (void **) &amp; pISketchFactoryOnFeatCont);
...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step3"></a>Creating an Axis System</h3>
<p>An axis system is created thanks to the <em>CATIMf3DAxisSystemFactory</em> interface.
<code>pIMf3DAxisSystemFactoryOnFeatCont</code> is the interface pointer on the specification 
container of the 3D Shape retrieved in the previous section. The article entitled &quot;Creating 
an Axis System&quot; [<a href="#References">2</a>] explains in details the axis 
system creation.</p>
<p>Here it is a simple axis system located in (100,0,0) in the absolute axis system 
and with three axis directions set by mathematical vectors. The first two axis directions,
<code>Xdir</code> and <code>Ydir</code>, are given, the third is the vectorial product 
of the two others. <code>NewAxisSystem</code> is consequently a right-handed axis 
system.</p>
<pre class="code">...
  CATMathPoint Origin (100.0,.0,.0);
  CATMathVector Xdir (1.0,0.0,.0);
  CATMathVector Ydir (0.0,0.0,1.0);

  <strong>CATIMf3DAxisSystem_var</strong> NewAxisSystem ;
  rc = pIMf3DAxisSystemFactoryOnFeatCont-&gt;<strong>CreateAxisSystem</strong>(Origin,Xdir,Ydir,NewAxisSystem);
 
...</pre>
<p>Once the axis system is created, an update is launched to build the geometry, 
using <em>DataCommonProtocolServices.</em></p>
<pre class="code">...
  <strong>CATIUseEntity</strong> *pUseEntityOnNewAxisSystem= NULL;
  rc = NewAxisSystem-&gt;QueryInterface(IID_CATIUseEntity , (void**) pUseEntityOnNewAxisSystem);
  if (SUCCEEDED(rc))
  {
    rc = <strong>DataCommonProtocolServices::Update</strong>(pUseEntityOnNewAxisSystem);
    pUseEntityOnNewAxisSystem-&gt;Release(); pUseEntityOnNewAxisSystem = NULL ;
  }  
...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step4"></a>Retrieving the BRep Plane</h3>
<p>Once the axis system has been updated and its geometry computed, it is possible 
to retrieve one of its sub-element.</p>
<pre class="code">...
  CATBaseUnknown_var PlaneBRep ;
  rc = NewAxisSystem-&gt;<strong>RetrievePlaneBRepAccess</strong>(CATAxisSystemZNumber,PlaneBRep);
...</pre>
<p>The <code>RetrievePlaneBRepAccess</code> method retrieves a plane of the axis 
system. The first argument of the method, a <em>CATAxisSystemXYZNumber</em> value, 
specifies which one. With <code>CATAxisSystemZNumber,</code> it is the XY plane, 
in other words the plane defined by the X and the Y axis directions.</p>
<p><code>PlaneBRep</code> is a temporary handler on the plane cell. It is an object 
of selection [<a href="#References">1</a>] usually named a BRep Access object.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step5"></a>Featurizing the BRep Plane</h3>
<p>To be used as specification, the BRep plane, <code>PlaneBRep</code>, should be 
featurized. The new feature, <code>MFPlane</code>, is called the BRep feature. The
<em>CATIMmiUseFeaturize</em> interface enables you to do this transformation, using 
the <code>Featurize</code> method.</p>
<pre class="code">...
  <strong>CATIMmiUseFeaturize</strong> * pIFeaturizeOnPlane = NULL ;
  rc = PlaneBRep-&gt;QueryInterface(IID_CATIMmiUseFeaturize,(void **) &amp;pIFeaturizeOnPlane);
  ...
  <strong>CATIMmiUseMfBRep</strong>_var MFPlane;
  pIFeaturizeOnPlane-&gt;<strong>Featurize</strong>(MFPlane);
...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step6"></a>Creating the Sketch</h3>
<p>The sketch is created thanks to the factory retrieved in quot;<a href="#Step2">Retrieving 
the Factory Interface Pointers</a>&quot;. <code>MFPlane</code> is the BRep 
feature support of the sketch.</p>
<pre class="code">...
CATIMmiMechanicalFeature_var NewSketch = pISketchFactoryOnFeatCont-&gt;<strong>CreateSketch</strong>(MFPlane);
...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Step7"></a>Epilog</h3>
<p>The last actions of the use case are the following: save and close the PLM session. 
This is described in the Creating a 3D Shape as New Representation use case [<a href="#References">4</a>].</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="InShort"></a>In Short</h2>
<p>This use case explains how to create a sketch based on an axis system's plane.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="References"></a>References</h2>
<table class="reference">
	<tr>
		<td>[1]</td>
		<td><a href="CAAMmrTaGenericNaming.htm">Generic Naming Overview</a></td>
	</tr>
	<tr>
		<td>[2]</td>
		<td><a href="CAAMmrUcAxisSystemCreation.htm">Creating Axis Systems</a></td>
	</tr>
	<tr>
		<td>[3]</td>
		<td>
		<a href="../CAADocUseCases/CAADocRunSample.htm">
		Building and Launching a Use Case</a></td>
	</tr>
	<tr>
		<td>[4]</td>
		<td><a href="CAAMmrUcCreateExplicitPart.htm">Creating a 3D Shape as New 
		Representation</a></td>
	</tr>
	<tr>
		<td>[5]</td>
		<td><a href="CAAMmrTa3DShape.htm">From the PLM Representation to the 3D 
		Shape</a></td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="History"></a>History</h2>
<table class="history">
	<tr>
		<td>Version: <strong>1</strong> [Apr 2003]</td>
		<td>Document created</td>
	</tr>
	<tr>
		<td>Version: <strong>2</strong> [Mar 2006]</td>
		<td>Document updated for PLM Component</td>
	</tr>
	<tr>
		<td>Version: <strong>3</strong> [Apr 2010]</td>
		<td>Document updated for V6 novelties</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
