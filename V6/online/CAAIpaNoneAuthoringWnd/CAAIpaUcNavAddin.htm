<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<script type="text/javascript" src="../CAADocJavaScript/DSDocHighlight.js"></script>
<script type="text/javascript" src="../CAADocJavaScript/submit.js"></script>
<title>Adding a Toolbar to the PLM Navigator Workbench</title>
</head>

<body onload="highlightSearchTerms();">

<table class="DocHeader">
	<tr>
		<td class="DocHeader1">
		<h1><a name="Top"></a>Adding a Toolbar to the PLM Navigator Workbench</h1>
		</td>
	</tr>
	<tr>
		<td class="use">Use Case</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<table class="abstract">
	<tr>
		<td>
		<h2>Abstract</h2>
		<p>This article presents the <code>CAAIpaNavAddin</code> use case which 
		illustrates how to create a toolbar that is active in the PLM Navigator 
		Workbench.</p>
		<ul>
			<li><a href="#What You Will Learn With This Use Case">What You Will 
			Learn With This Use Case</a></li>
			<li><a href="#The CAAIpaNavAddin Use Case">The CAAIpaNavAddin Use Case</a>
			<ul>
				<li><a href="#What Does CAAIpaNavAddin Do">What Does CAAIpaNavAddin 
				Do</a></li>
				<li><a href="#How to Launch CAAIpaNavAddin">How to Launch CAAIpaNavAddin</a></li>
				<li><a href="#Where to Find the CAAIpaNavAddin Code">Where to Find 
				the CAAIpaNavAddin Code</a></li>
			</ul>
			</li>
			<li><a href="#Step-by-Step">Step-by-Step</a></li>
			<li><a href="#InShort">In Short</a></li>
			<li><a href="#References">References</a></li>
		</ul>
		</td>
	</tr>
</table>
<!---------------------------------------------------------------------------->
<h2><a name="What You Will Learn With This Use Case"></a>What You Will Learn With 
This Use Case</h2>
<p>By implementing the <em>CATIImmNavAddin</em>, a toolbar with its commands can 
be made active in the PLM Navigator Workbench.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="The CAAIpaNavAddin Use Case"></a>The CAAIpaNavAddin Use Case</h2>
<p><code>CAAIpaNavAddin</code> is a use case of the <code>CAAImmVPMInterfaces.edu</code> 
framework that illustrates the <code>CATImmVPMInterfaces</code> framework capabilities.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="What Does CAAIpaNavAddin Do">What Does CAAIpaNavAddin Do</a></h3>
<p>The goal of CAAIpaNavAddin is to demonstrate how to implement the <em>CATIImmNavAddin</em> 
interface. It consists of the following parts:</p>
<ul>
	<li>Code to create the toolbar and the layout of the commands </li>
	<li>Code to be executed when the command is selected </li>
	<li>Resource definition for the visual aspects of the interface</li>
</ul>
<p><img alt="0" src="images/CAAIpaNavAddin00.png"></p>
<p>Our toolbar appears on top of the CATIA Messenger frame and contains a single 
command represented by the
<img alt="Icon" src="images/CAAIpaNavAddin_I.gif" width="22" height="22"> icon.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="How to Launch CAAIpaNavAddin">How to Launch CAAIpaNavAddin</a></h3>
<p>To launch CAAIpaNavAddin:</p>
<ol>
	<li>Set the current directory to <code>InstallRootFolder\CAADoc\CAAImmVPMInterfaces.edu</code></li>
	<li>Set up the build time environment and build the <code>CAAIpaNavAddin.m</code> 
	module (see reference <a href="#[1]">[1]</a>) </li>
	<li>Edit the <code>CNext\code\dictionary\CAAImmVPMInterfaces.edu.dico</code> 
	dictionary by uncommenting the #CAA# from the following lines:
	<pre class="code"># CAAIpaNavAddin use case
#CAA# CAAIpaNavAddinLT  CATIImmNavAddin     libCAAIpaNavAddin
#CAA# CAAIpaNavAddinLT  CATIWorkbenchAddin  libCAAIpaNavAddin</pre>
	</li>
	<li>Install the dictionary and other resource files by executing <code>mkCreateRuntimeView</code></li>
	<li>Start 3DEXPERIENCE by executing mkrun -c 3DEXPERIENCE</li>
	<li>Connect to ENOVIA (or any other connector)</li>
	<li>Search for an existing Product from the PLM Toolbar, for example typing 
	&quot;prd: *&quot;.</li>
	<li>Select an item in the result list and Explore it</li>
	<li>Display the toolbar named &quot;CAA Navigator toolbar&quot; if necessary (menu View 
	/ Toolbars / CAA PLM Navigator addin toolbar)
	<p><img alt="" src="images/CAAIpaNavAddin_02.png"></p>
	</li>
	<li>Click on the command and a dialog box will appear:
	<p><img alt="" src="images/CAAIpaNavAddin01.png"></p>
	</li>
</ol>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Where to Find the CAAIpaNavAddin Code">Where to Find the CAAIpaNavAddin 
Code</a></h3>
<p>CAAIpaNavAddin code is located in the <code><em>InstallRootFolder</em>\CAADoc\CAAImmVPMInterfaces.edu\CAAIpaNavAddin.m\src</code> 
folder.</p>
<p>where <code>InstallRootFolder</code> [<a href="#References">1</a>] is the folder 
where the API CD-ROM is installed.</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="Step-by-Step"></a>Step-by-Step</h2>
<p>There are two parts in <em>CAAIpaNavAddin</em>:</p>
<ol>
	<li><a href="#Toolbar Creation and Layout">Toolbar Creation and Layout</a></li>
	<li><a href="#User Interface">User Interface</a></li>
</ol>
<p>We will now detail each of those sections:</p>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="Toolbar Creation and Layout"></a>Toolbar Creation and Layout</h3>
<p>The implementation of <em>CATIImmNavAddin</em> is provided by our <code>CAAIpaNavAddin</code> 
class. Its purpose is to create the toolbar and to do the layout the commands on 
it. Only two methods need to be defined: <a href="#CreateToolbars"><code>CreateToolbars</code></a> 
and <a href="#CreateCommands"><code>CreateCommands</code></a>.</p>
<pre class="code">...
class CAAIpaNavAddin: public CATBaseUnknown 
{

CATDeclareClass;

public:

        // Standard constructors and destructors for an implementation class
        // -----------------------------------------------------------------
        CAAIpaNavAddin();
        virtual ~CAAIpaNavAddin();

        /**
         * @see ApplicationFrame.CATIWorkbenchAddin#CreateToolbars
         */
        CATCmdContainer * CreateToolbars();

        /**
         * @see ApplicationFrame.CATIWorkbenchAddin#CreateCommands
         */
        void CreateCommands();

private:
        // The copy constructor and the equal operator must not be implemented
        // -------------------------------------------------------------------
        CAAIpaNavAddin(CAAIpaNavAddin &amp;);
        CAAIpaNavAddin&amp; operator=(CAAIpaNavAddin&amp;);

};
...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h4><a name="CreateToolbars"></a>Create Toolbars</h4>
<p>The purpose of the <em><code>CreateToolbars</code></em> method is to create all 
the command headers of our toolbar. In this case a toolbar named <em><code>CAAIpaNavAddinToolbar</code></em> 
(pointer toolbar name <em>pToolbarContainer</em>) with a command named <em>
<code>CAAIpaNavAddinCmdHdr</code></em> is created.</p>
<pre class="code">...
CATCmdContainer * CAAIpaNavAddin::CreateToolbars ()<a name="CreateToolbars"></a>
{
        CAAIpaNavAddinTRACE(&quot;&gt;&gt; CAAIpaNavAddin::CreateToolbars()&quot;);

        // Declaration of toolbar for Addin
        NewAccess(CATCmdContainer, pToolbarContainer,
                  CAAIpaNavAddinToolbar);
        NewAccess(CATCmdStarter, pCommandStarter,
                  CAAIpaNavAddinStarter);

        // Arranging the command within the toolbar
        SetAccessCommand(pCommandStarter, &quot;CAAIpaNavAddinCmdHdr&quot;);
        SetAccessChild(pToolbarContainer, pCommandStarter);

        int visibleFlag = 1;
        AddToolbarView (pToolbarContainer, visibleFlag, Top);

        CAAIpaNavAddinTRACE(&quot;&lt;&lt; CAAIpaNavAddin::CreateToolbars()&quot;);
        return pToolbarContainer;
}

...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h4><a name="CreateCommands"></a>Create Commands</h4>
<p>The purpose of the <em><code>CreateCommands</code></em> method is to create all 
the command headers of our toolbar. Our command header class <em><code>CAAIpaNavAddinHeader</code></em>, 
is defined. Here a command named <em><code>CAAIpaNavAddinCmdHdr</code></em> is created. 
It is located in the <em><code>CAAIpaNavAddin</code></em> shared library and its 
class is <em><code>CAAIpaNavAddinCmd</code></em>.</p>
<pre class="code">...
#include &quot;CATCommandHeader.h&quot;
CATImplementClass(CAAIpaNavAddin,
                  CodeExtension,
                  CATBaseUnknown,
                  CAAIpaNavAddinLT);
...
void CAAIpaNavAddin::CreateCommands ()
{
    ... 
    CATAfrCommandHeader::CATCreateCommandHeader
     			(&quot;CAAIpaNavAddinCmdHdr&quot;,	
                            &quot;CAAIpaNavAddin&quot;,	
			 &quot;CAAIpaNavAddinCmd&quot;,	
			 (void *)NULL,
			 &quot;CAAIpaNavAddinHeader&quot;,  
			 CATFrmAvailable);    
   ...    
}
...</pre>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h3><a name="User Interface"></a>User Interface</h3>
<p>There are two visible objects: the toolbar and its command.</p>
<p>The title of the toolbar named <code>CAAIpaNavAddinToolbar</code> is defined 
by the <code>CAAIpaNavAddinLT.CATNls</code> which can be found in <code><em>InstallRootFolder</em>\CAADoc\CAAImmVPMInterfaces.edu\CNext\resources\msgcatalog</code> 
directory.</p>
<pre class="code">CAAIpaNavAddinToolbar.Title = &quot;CAA PLM Navigator addin toolbar&quot;;</pre>
<p>The resources of the <code>CAAIpaNavAddinCmdHdr</code> are defined by three files:</p>
<ol>
	<li><code>CAAIpaNavAddinHeader.CATNls</code> (located in the <code><em>InstallRootFolder</em>\CAADoc\CAAImmVPMInterfaces.edu\CNext\resources\msgcatalog</code> 
	folder):
	<pre class="code">CAAIpaNavAddinHeader.CAAIpaNavAddinCmdHdr.Title = &quot;Navigator addin command&quot;;
CAAIpaNavAddinHeader.CAAIpaNavAddinCmdHdr.Help = &quot;Navigator addin commandhelp text&quot;;
CAAIpaNavAddinHeader.CAAIpaNavAddinCmdHdr.ShortHelp = &quot;Navigator addin command info&quot;;</pre>
	<p>These texts correspond to the screen tip, the documentation line and the 
	command prompt input.</p>
	</li>
	<li><code>CAAIpaNavAddinHeader.CATRsc</code> (located in the <code><em>InstallRootFolder</em>\CAADoc\CAAImmVPMInterfaces.edu\CNext\resources\msgcatalog</code> 
	foler) defines the bitmap name for the command icon:
	<pre class="code">CAAIpaNavAddinHeader.CAAIpaNavAddinCmdHdr.Icon.Normal=&quot;CAAIpaNavAddin_I&quot;;</pre>
	</li>
	<li><code>CAAIpaNavAddin_I.gif</code> (located in the <code><em>InstallRootFolder</em>\CAADoc\CAAImmVPMInterfaces.edu\CNext\resources\graphic\icons\normal</code> 
	foler) contains the bitmap the command icon:
	<img alt="" src="images/CAAIpaNavAddin_I.gif" width="22" height="22"> </li>
</ol>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="InShort"></a>In Short</h2>
<p>This use case has demonstrated how to create a toolbar with a command:</p>
<ul>
	<li>Implement the <em>CATIImmNavAddin</em> interface to create a toolbar and 
	layout the commands.</li>
	<li>Derive from CATCommand to implement the command action.</li>
	<li>Define resource files for the user interface.</li>
</ul>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="References"></a>References</h2>
<table class="reference">
	<tr>
		<td><a name="[1]">[1]</a></td>
		<td>
		<a href="../CAADocUseCases/CAADocRunSample.htm">
		Building and Launching a Use Case</a></td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<h2><a name="History"></a>History</h2>
<table class="history">
	<tr>
		<td>Version: 1.0 [Jan 2007]</td>
		<td>Document created</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop();</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
